Imports C1.C1PrintDocument
Imports C1.Win.C1FlexGrid
Imports System.Data
Imports System.Data.SqlClient
Imports System.IO

Public Class frmBoldCode
    Inherits System.Windows.Forms.Form

    'todo:
    '- Create method for each dimension e.g. ValidateDim2FundExpense
    '- INcorporate regions in dimensions

#Region "  Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()

        'This call is required by the Windows Form Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call

        Dim authobj As AF_Master.Authuser
        Try
            Me.ConnectionString = authobj.ConnectionString
            Me.FiscalYear = authobj.FiscalYear
            Me.SchoolName = authobj.SchoolName
            Me.SchoolNumber = authobj.SchoolNumber
            Me.SchoolAddress1 = authobj.SchoolAddress1
            Me.SchoolAddress2 = authobj.SchoolAddress2
            Dim city, state, zip As String
            city = authobj.SchoolCity
            state = authobj.SchoolState
            zip = authobj.SchoolZipCode
            Me.SchoolCityStateZip = city & ", " & state & " " & zip
        Catch ex As Exception
            Throw
        End Try

        Try
            Call GetDistrictInformation()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents Prev1 As C1.Win.C1PrintPreview.C1PrintPreview
    Friend WithEvents c1pBtnFileOpen1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnFileSave1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnFilePrint1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnPageSetup1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnReflow1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnStop1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnDocInfo1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnSeparator1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnShowNavigationBar1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnSeparator2 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnMouseHand1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnMouseZoom1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnMouseZoomOut1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnMouseSelect1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnFindText1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnSeparator3 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnGoFirst1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnGoPrev1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnGoNext1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnGoLast1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnSeparator4 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnHistoryPrev1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnHistoryNext1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnSeparator5 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnZoomOut1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnZoomIn1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnSeparator6 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnViewActualSize1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnViewFullPage1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnViewPageWidth1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnViewTwoPages1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnViewFourPages1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnSeparator7 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents c1pBtnHelp1 As C1.Win.C1PrintPreview.PreviewToolBarButton
    Friend WithEvents Doc1 As C1.C1PrintDocument.C1PrintDocument
    Friend WithEvents GridDetail As C1.Win.C1FlexGrid.C1FlexGrid
    Friend WithEvents GridDim4 As C1.Win.C1FlexGrid.C1FlexGrid
    Friend WithEvents GridDim5 As C1.Win.C1FlexGrid.C1FlexGrid
    Friend WithEvents GridTotals As C1.Win.C1FlexGrid.C1FlexGrid
    Friend WithEvents btnCreateBoldCodeRevenue As System.Windows.Forms.Button
    Friend WithEvents SaveFileDialog1 As System.Windows.Forms.SaveFileDialog
    Friend WithEvents ToolTip1 As System.Windows.Forms.ToolTip
    Friend WithEvents GridDim6 As C1.Win.C1FlexGrid.C1FlexGrid
    Friend WithEvents GridDim7 As C1.Win.C1FlexGrid.C1FlexGrid
    Friend WithEvents GridDim8 As C1.Win.C1FlexGrid.C1FlexGrid
    Friend WithEvents GridDim3 As C1.Win.C1FlexGrid.C1FlexGrid
    Friend WithEvents btnCreateBoldCodeExpenditure As System.Windows.Forms.Button
    Friend WithEvents Label1 As System.Windows.Forms.Label
    Friend WithEvents Label2 As System.Windows.Forms.Label
    Friend WithEvents PanelBoldSuccess As System.Windows.Forms.Panel
    Friend WithEvents PanelBoldFail As System.Windows.Forms.Panel
    Friend WithEvents btnAdministrator As System.Windows.Forms.Button
    Friend WithEvents Label3 As System.Windows.Forms.Label
    Friend WithEvents Label4 As System.Windows.Forms.Label
    Friend WithEvents griddim9 As C1.Win.C1FlexGrid.C1FlexGrid
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        Me.components = New System.ComponentModel.Container
        Dim resources As System.Resources.ResourceManager = New System.Resources.ResourceManager(GetType(frmBoldCode))
        Me.Prev1 = New C1.Win.C1PrintPreview.C1PrintPreview
        Me.Doc1 = New C1.C1PrintDocument.C1PrintDocument
        Me.c1pBtnFileOpen1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnFileSave1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnFilePrint1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnPageSetup1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnReflow1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnStop1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnDocInfo1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnSeparator1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnShowNavigationBar1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnSeparator2 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnMouseHand1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnMouseZoom1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnMouseZoomOut1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnMouseSelect1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnFindText1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnSeparator3 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnGoFirst1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnGoPrev1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnGoNext1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnGoLast1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnSeparator4 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnHistoryPrev1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnHistoryNext1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnSeparator5 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnZoomOut1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnZoomIn1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnSeparator6 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnViewActualSize1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnViewFullPage1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnViewPageWidth1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnViewTwoPages1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnViewFourPages1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnSeparator7 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.c1pBtnHelp1 = New C1.Win.C1PrintPreview.PreviewToolBarButton
        Me.GridDetail = New C1.Win.C1FlexGrid.C1FlexGrid
        Me.GridDim4 = New C1.Win.C1FlexGrid.C1FlexGrid
        Me.GridDim5 = New C1.Win.C1FlexGrid.C1FlexGrid
        Me.GridTotals = New C1.Win.C1FlexGrid.C1FlexGrid
        Me.btnCreateBoldCodeRevenue = New System.Windows.Forms.Button
        Me.SaveFileDialog1 = New System.Windows.Forms.SaveFileDialog
        Me.btnCreateBoldCodeExpenditure = New System.Windows.Forms.Button
        Me.ToolTip1 = New System.Windows.Forms.ToolTip(Me.components)
        Me.GridDim6 = New C1.Win.C1FlexGrid.C1FlexGrid
        Me.GridDim7 = New C1.Win.C1FlexGrid.C1FlexGrid
        Me.GridDim8 = New C1.Win.C1FlexGrid.C1FlexGrid
        Me.GridDim3 = New C1.Win.C1FlexGrid.C1FlexGrid
        Me.PanelBoldSuccess = New System.Windows.Forms.Panel
        Me.Label2 = New System.Windows.Forms.Label
        Me.Label1 = New System.Windows.Forms.Label
        Me.btnAdministrator = New System.Windows.Forms.Button
        Me.PanelBoldFail = New System.Windows.Forms.Panel
        Me.Label3 = New System.Windows.Forms.Label
        Me.Label4 = New System.Windows.Forms.Label
        Me.griddim9 = New C1.Win.C1FlexGrid.C1FlexGrid
        CType(Me.Prev1, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.GridDetail, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.GridDim4, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.GridDim5, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.GridTotals, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.GridDim6, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.GridDim7, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.GridDim8, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.GridDim3, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.PanelBoldSuccess.SuspendLayout()
        Me.PanelBoldFail.SuspendLayout()
        CType(Me.griddim9, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.SuspendLayout()
        '
        'Prev1
        '
        Me.Prev1.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.Prev1.C1DPageSettings = "color:True;landscape:False;margins:100,100,100,100;papersize:850,1100,TABlAHQAdAB" & _
        "lAHIA"
        Me.Prev1.Document = Me.Doc1
        Me.Prev1.Location = New System.Drawing.Point(0, 64)
        Me.Prev1.Name = "Prev1"
        Me.Prev1.NavigationBar.Cursor = System.Windows.Forms.Cursors.Default
        Me.Prev1.NavigationBar.Font = New System.Drawing.Font("Microsoft Sans Serif", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Prev1.NavigationBar.OutlineView.Cursor = System.Windows.Forms.Cursors.Default
        Me.Prev1.NavigationBar.OutlineView.Font = New System.Drawing.Font("Microsoft Sans Serif", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Prev1.NavigationBar.OutlineView.Indent = 19
        Me.Prev1.NavigationBar.OutlineView.ItemHeight = 16
        Me.Prev1.NavigationBar.OutlineView.TabIndex = 0
        Me.Prev1.NavigationBar.OutlineView.Visible = False
        Me.Prev1.NavigationBar.Padding = New System.Drawing.Point(6, 3)
        Me.Prev1.NavigationBar.TabIndex = 2
        Me.Prev1.NavigationBar.ThumbnailsView.AutoArrange = True
        Me.Prev1.NavigationBar.ThumbnailsView.Cursor = System.Windows.Forms.Cursors.Default
        Me.Prev1.NavigationBar.ThumbnailsView.Font = New System.Drawing.Font("Microsoft Sans Serif", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Prev1.NavigationBar.ThumbnailsView.TabIndex = 0
        Me.Prev1.NavigationBar.ThumbnailsView.Visible = False
        Me.Prev1.NavigationBar.Visible = False
        Me.Prev1.NavigationBar.Width = 160
        Me.Prev1.Size = New System.Drawing.Size(864, 464)
        Me.Prev1.Splitter.Cursor = System.Windows.Forms.Cursors.VSplit
        Me.Prev1.Splitter.Width = 3
        Me.Prev1.StatusBar.Cursor = System.Windows.Forms.Cursors.Default
        Me.Prev1.StatusBar.Font = New System.Drawing.Font("Microsoft Sans Serif", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Prev1.StatusBar.TabIndex = 4
        Me.Prev1.TabIndex = 0
        Me.Prev1.ToolBar.Buttons.AddRange(New System.Windows.Forms.ToolBarButton() {Me.c1pBtnFileOpen1, Me.c1pBtnFileSave1, Me.c1pBtnFilePrint1, Me.c1pBtnPageSetup1, Me.c1pBtnReflow1, Me.c1pBtnStop1, Me.c1pBtnDocInfo1, Me.c1pBtnSeparator1, Me.c1pBtnShowNavigationBar1, Me.c1pBtnSeparator2, Me.c1pBtnMouseHand1, Me.c1pBtnMouseZoom1, Me.c1pBtnMouseZoomOut1, Me.c1pBtnMouseSelect1, Me.c1pBtnFindText1, Me.c1pBtnSeparator3, Me.c1pBtnGoFirst1, Me.c1pBtnGoPrev1, Me.c1pBtnGoNext1, Me.c1pBtnGoLast1, Me.c1pBtnSeparator4, Me.c1pBtnHistoryPrev1, Me.c1pBtnHistoryNext1, Me.c1pBtnSeparator5, Me.c1pBtnZoomOut1, Me.c1pBtnZoomIn1, Me.c1pBtnSeparator6, Me.c1pBtnViewActualSize1, Me.c1pBtnViewFullPage1, Me.c1pBtnViewPageWidth1, Me.c1pBtnViewTwoPages1, Me.c1pBtnViewFourPages1, Me.c1pBtnSeparator7, Me.c1pBtnHelp1})
        Me.Prev1.ToolBar.Cursor = System.Windows.Forms.Cursors.Default
        Me.Prev1.ToolBar.Font = New System.Drawing.Font("Microsoft Sans Serif", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        '
        'Doc1
        '
        Me.Doc1.C1DPageSettings = "color:True;landscape:False;margins:100,100,100,100;papersize:850,1100,TABlAHQAdAB" & _
        "lAHIA"
        Me.Doc1.ColumnSpacingStr = "0.5in"
        Me.Doc1.ColumnSpacingUnit.DefaultType = True
        Me.Doc1.ColumnSpacingUnit.UnitValue = "0.5in"
        Me.Doc1.DefaultUnit = C1.C1PrintDocument.UnitTypeEnum.Inch
        Me.Doc1.DocumentName = ""
        '
        'c1pBtnFileOpen1
        '
        Me.c1pBtnFileOpen1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.FileOpen
        Me.c1pBtnFileOpen1.ImageIndex = 0
        Me.c1pBtnFileOpen1.ToolTipText = "File Open"
        '
        'c1pBtnFileSave1
        '
        Me.c1pBtnFileSave1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.FileSave
        Me.c1pBtnFileSave1.ImageIndex = 1
        Me.c1pBtnFileSave1.ToolTipText = "File Save"
        '
        'c1pBtnFilePrint1
        '
        Me.c1pBtnFilePrint1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.FilePrint
        Me.c1pBtnFilePrint1.ImageIndex = 2
        Me.c1pBtnFilePrint1.ToolTipText = "Print"
        '
        'c1pBtnPageSetup1
        '
        Me.c1pBtnPageSetup1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.PageSetup
        Me.c1pBtnPageSetup1.ImageIndex = 3
        Me.c1pBtnPageSetup1.ToolTipText = "Page Setup"
        '
        'c1pBtnReflow1
        '
        Me.c1pBtnReflow1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.Reflow
        Me.c1pBtnReflow1.ImageIndex = 4
        Me.c1pBtnReflow1.ToolTipText = "Reflow"
        '
        'c1pBtnStop1
        '
        Me.c1pBtnStop1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.Stop
        Me.c1pBtnStop1.ImageIndex = 5
        Me.c1pBtnStop1.ToolTipText = "Stop"
        Me.c1pBtnStop1.Visible = False
        '
        'c1pBtnDocInfo1
        '
        Me.c1pBtnDocInfo1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.DocInfo
        Me.c1pBtnDocInfo1.ImageIndex = 26
        Me.c1pBtnDocInfo1.ToolTipText = "Document information"
        '
        'c1pBtnSeparator1
        '
        Me.c1pBtnSeparator1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.None
        Me.c1pBtnSeparator1.Style = System.Windows.Forms.ToolBarButtonStyle.Separator
        '
        'c1pBtnShowNavigationBar1
        '
        Me.c1pBtnShowNavigationBar1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.ShowNavigationBar
        Me.c1pBtnShowNavigationBar1.ImageIndex = 6
        Me.c1pBtnShowNavigationBar1.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton
        Me.c1pBtnShowNavigationBar1.ToolTipText = "Show Navigation Bar"
        '
        'c1pBtnSeparator2
        '
        Me.c1pBtnSeparator2.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.None
        Me.c1pBtnSeparator2.Style = System.Windows.Forms.ToolBarButtonStyle.Separator
        '
        'c1pBtnMouseHand1
        '
        Me.c1pBtnMouseHand1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.MouseHand
        Me.c1pBtnMouseHand1.ImageIndex = 7
        Me.c1pBtnMouseHand1.Pushed = True
        Me.c1pBtnMouseHand1.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton
        Me.c1pBtnMouseHand1.ToolTipText = "Hand Tool"
        '
        'c1pBtnMouseZoom1
        '
        Me.c1pBtnMouseZoom1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.MouseZoom
        Me.c1pBtnMouseZoom1.ImageIndex = 8
        Me.c1pBtnMouseZoom1.Style = System.Windows.Forms.ToolBarButtonStyle.DropDownButton
        Me.c1pBtnMouseZoom1.ToolTipText = "Zoom In Tool"
        '
        'c1pBtnMouseZoomOut1
        '
        Me.c1pBtnMouseZoomOut1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.MouseZoomOut
        Me.c1pBtnMouseZoomOut1.ImageIndex = 25
        Me.c1pBtnMouseZoomOut1.Style = System.Windows.Forms.ToolBarButtonStyle.DropDownButton
        Me.c1pBtnMouseZoomOut1.ToolTipText = "Zoom Out Tool"
        Me.c1pBtnMouseZoomOut1.Visible = False
        '
        'c1pBtnMouseSelect1
        '
        Me.c1pBtnMouseSelect1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.MouseSelect
        Me.c1pBtnMouseSelect1.ImageIndex = 9
        Me.c1pBtnMouseSelect1.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton
        Me.c1pBtnMouseSelect1.ToolTipText = "Select Text"
        '
        'c1pBtnFindText1
        '
        Me.c1pBtnFindText1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.FindText
        Me.c1pBtnFindText1.ImageIndex = 10
        Me.c1pBtnFindText1.ToolTipText = "Find Text"
        '
        'c1pBtnSeparator3
        '
        Me.c1pBtnSeparator3.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.None
        Me.c1pBtnSeparator3.Style = System.Windows.Forms.ToolBarButtonStyle.Separator
        '
        'c1pBtnGoFirst1
        '
        Me.c1pBtnGoFirst1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.GoFirst
        Me.c1pBtnGoFirst1.Enabled = False
        Me.c1pBtnGoFirst1.ImageIndex = 11
        Me.c1pBtnGoFirst1.ToolTipText = "First Page"
        '
        'c1pBtnGoPrev1
        '
        Me.c1pBtnGoPrev1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.GoPrev
        Me.c1pBtnGoPrev1.Enabled = False
        Me.c1pBtnGoPrev1.ImageIndex = 12
        Me.c1pBtnGoPrev1.ToolTipText = "Previous Page"
        '
        'c1pBtnGoNext1
        '
        Me.c1pBtnGoNext1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.GoNext
        Me.c1pBtnGoNext1.ImageIndex = 13
        Me.c1pBtnGoNext1.ToolTipText = "Next Page"
        '
        'c1pBtnGoLast1
        '
        Me.c1pBtnGoLast1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.GoLast
        Me.c1pBtnGoLast1.ImageIndex = 14
        Me.c1pBtnGoLast1.ToolTipText = "Last Page"
        '
        'c1pBtnSeparator4
        '
        Me.c1pBtnSeparator4.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.None
        Me.c1pBtnSeparator4.Style = System.Windows.Forms.ToolBarButtonStyle.Separator
        '
        'c1pBtnHistoryPrev1
        '
        Me.c1pBtnHistoryPrev1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.HistoryPrev
        Me.c1pBtnHistoryPrev1.Enabled = False
        Me.c1pBtnHistoryPrev1.ImageIndex = 15
        Me.c1pBtnHistoryPrev1.Style = System.Windows.Forms.ToolBarButtonStyle.DropDownButton
        Me.c1pBtnHistoryPrev1.ToolTipText = "Previous View"
        '
        'c1pBtnHistoryNext1
        '
        Me.c1pBtnHistoryNext1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.HistoryNext
        Me.c1pBtnHistoryNext1.Enabled = False
        Me.c1pBtnHistoryNext1.ImageIndex = 16
        Me.c1pBtnHistoryNext1.Style = System.Windows.Forms.ToolBarButtonStyle.DropDownButton
        Me.c1pBtnHistoryNext1.ToolTipText = "Next View"
        '
        'c1pBtnSeparator5
        '
        Me.c1pBtnSeparator5.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.None
        Me.c1pBtnSeparator5.Style = System.Windows.Forms.ToolBarButtonStyle.Separator
        Me.c1pBtnSeparator5.Visible = False
        '
        'c1pBtnZoomOut1
        '
        Me.c1pBtnZoomOut1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.ZoomOut
        Me.c1pBtnZoomOut1.ImageIndex = 17
        Me.c1pBtnZoomOut1.ToolTipText = "Zoom Out"
        Me.c1pBtnZoomOut1.Visible = False
        '
        'c1pBtnZoomIn1
        '
        Me.c1pBtnZoomIn1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.ZoomIn
        Me.c1pBtnZoomIn1.ImageIndex = 18
        Me.c1pBtnZoomIn1.ToolTipText = "Zoom In"
        Me.c1pBtnZoomIn1.Visible = False
        '
        'c1pBtnSeparator6
        '
        Me.c1pBtnSeparator6.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.None
        Me.c1pBtnSeparator6.Style = System.Windows.Forms.ToolBarButtonStyle.Separator
        Me.c1pBtnSeparator6.Visible = False
        '
        'c1pBtnViewActualSize1
        '
        Me.c1pBtnViewActualSize1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.ViewActualSize
        Me.c1pBtnViewActualSize1.ImageIndex = 19
        Me.c1pBtnViewActualSize1.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton
        Me.c1pBtnViewActualSize1.ToolTipText = "Actual Size"
        '
        'c1pBtnViewFullPage1
        '
        Me.c1pBtnViewFullPage1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.ViewFullPage
        Me.c1pBtnViewFullPage1.ImageIndex = 20
        Me.c1pBtnViewFullPage1.Pushed = True
        Me.c1pBtnViewFullPage1.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton
        Me.c1pBtnViewFullPage1.ToolTipText = "Full Page"
        '
        'c1pBtnViewPageWidth1
        '
        Me.c1pBtnViewPageWidth1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.ViewPageWidth
        Me.c1pBtnViewPageWidth1.ImageIndex = 21
        Me.c1pBtnViewPageWidth1.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton
        Me.c1pBtnViewPageWidth1.ToolTipText = "Page Width"
        '
        'c1pBtnViewTwoPages1
        '
        Me.c1pBtnViewTwoPages1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.ViewTwoPages
        Me.c1pBtnViewTwoPages1.ImageIndex = 22
        Me.c1pBtnViewTwoPages1.Style = System.Windows.Forms.ToolBarButtonStyle.ToggleButton
        Me.c1pBtnViewTwoPages1.ToolTipText = "Two Pages"
        '
        'c1pBtnViewFourPages1
        '
        Me.c1pBtnViewFourPages1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.ViewFourPages
        Me.c1pBtnViewFourPages1.ImageIndex = 23
        Me.c1pBtnViewFourPages1.Style = System.Windows.Forms.ToolBarButtonStyle.DropDownButton
        Me.c1pBtnViewFourPages1.ToolTipText = "Four Pages"
        '
        'c1pBtnSeparator7
        '
        Me.c1pBtnSeparator7.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.None
        Me.c1pBtnSeparator7.Style = System.Windows.Forms.ToolBarButtonStyle.Separator
        Me.c1pBtnSeparator7.Visible = False
        '
        'c1pBtnHelp1
        '
        Me.c1pBtnHelp1.Action = C1.Win.C1PrintPreview.ToolBarButtonActionEnum.Help
        Me.c1pBtnHelp1.ImageIndex = 24
        Me.c1pBtnHelp1.ToolTipText = "Help"
        Me.c1pBtnHelp1.Visible = False
        '
        'GridDetail
        '
        Me.GridDetail.AllowSorting = C1.Win.C1FlexGrid.AllowSortingEnum.None
        Me.GridDetail.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GridDetail.BackColor = System.Drawing.SystemColors.Window
        Me.GridDetail.ColumnInfo = "10,0,0,0,0,85,Columns:"
        Me.GridDetail.ForeColor = System.Drawing.SystemColors.WindowText
        Me.GridDetail.Location = New System.Drawing.Point(-16, 104)
        Me.GridDetail.Name = "GridDetail"
        Me.GridDetail.Rows.Fixed = 0
        Me.GridDetail.Size = New System.Drawing.Size(856, 416)
        Me.GridDetail.Styles = New C1.Win.C1FlexGrid.CellStyleCollection("Normal{Font:Arial, 8.25pt;}" & Microsoft.VisualBasic.ChrW(9) & "Fixed{BackColor:Control;ForeColor:ControlText;Border:" & _
        "Flat,1,ControlDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "Highlight{BackColor:Highlight;ForeColor:HighlightText;" & _
        "}" & Microsoft.VisualBasic.ChrW(9) & "Search{BackColor:Highlight;ForeColor:HighlightText;}" & Microsoft.VisualBasic.ChrW(9) & "Frozen{BackColor:Beige;}" & Microsoft.VisualBasic.ChrW(9) & _
        "EmptyArea{BackColor:AppWorkspace;Border:Flat,1,ControlDarkDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "GrandTotal" & _
        "{BackColor:Black;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal0{BackColor:ControlDarkDark;ForeColor" & _
        ":White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal1{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal2{BackCol" & _
        "or:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal3{BackColor:ControlDarkDark;ForeCol" & _
        "or:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal4{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal5{BackC" & _
        "olor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9))
        Me.GridDetail.TabIndex = 1
        Me.GridDetail.Visible = False
        '
        'GridDim4
        '
        Me.GridDim4.BackColor = System.Drawing.SystemColors.Window
        Me.GridDim4.ColumnInfo = "10,0,0,0,0,85,Columns:"
        Me.GridDim4.ForeColor = System.Drawing.SystemColors.WindowText
        Me.GridDim4.Location = New System.Drawing.Point(4000, 8)
        Me.GridDim4.Name = "GridDim4"
        Me.GridDim4.Rows.Fixed = 0
        Me.GridDim4.Size = New System.Drawing.Size(80, 32)
        Me.GridDim4.Styles = New C1.Win.C1FlexGrid.CellStyleCollection("Normal{Font:Arial, 8.25pt;}" & Microsoft.VisualBasic.ChrW(9) & "Fixed{BackColor:Control;ForeColor:ControlText;Border:" & _
        "Flat,1,ControlDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "Highlight{BackColor:Highlight;ForeColor:HighlightText;" & _
        "}" & Microsoft.VisualBasic.ChrW(9) & "Search{BackColor:Highlight;ForeColor:HighlightText;}" & Microsoft.VisualBasic.ChrW(9) & "Frozen{BackColor:Beige;}" & Microsoft.VisualBasic.ChrW(9) & _
        "EmptyArea{BackColor:AppWorkspace;Border:Flat,1,ControlDarkDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "GrandTotal" & _
        "{BackColor:Black;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal0{BackColor:ControlDarkDark;ForeColor" & _
        ":White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal1{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal2{BackCol" & _
        "or:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal3{BackColor:ControlDarkDark;ForeCol" & _
        "or:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal4{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal5{BackC" & _
        "olor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9))
        Me.GridDim4.TabIndex = 2
        Me.GridDim4.Visible = False
        '
        'GridDim5
        '
        Me.GridDim5.BackColor = System.Drawing.SystemColors.Window
        Me.GridDim5.ColumnInfo = "10,0,0,0,0,85,Columns:"
        Me.GridDim5.ForeColor = System.Drawing.SystemColors.WindowText
        Me.GridDim5.Location = New System.Drawing.Point(4000, 8)
        Me.GridDim5.Name = "GridDim5"
        Me.GridDim5.Rows.Fixed = 0
        Me.GridDim5.Size = New System.Drawing.Size(80, 32)
        Me.GridDim5.Styles = New C1.Win.C1FlexGrid.CellStyleCollection("Normal{Font:Arial, 8.25pt;}" & Microsoft.VisualBasic.ChrW(9) & "Fixed{BackColor:Control;ForeColor:ControlText;Border:" & _
        "Flat,1,ControlDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "Highlight{BackColor:Highlight;ForeColor:HighlightText;" & _
        "}" & Microsoft.VisualBasic.ChrW(9) & "Search{BackColor:Highlight;ForeColor:HighlightText;}" & Microsoft.VisualBasic.ChrW(9) & "Frozen{BackColor:Beige;}" & Microsoft.VisualBasic.ChrW(9) & _
        "EmptyArea{BackColor:AppWorkspace;Border:Flat,1,ControlDarkDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "GrandTotal" & _
        "{BackColor:Black;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal0{BackColor:ControlDarkDark;ForeColor" & _
        ":White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal1{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal2{BackCol" & _
        "or:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal3{BackColor:ControlDarkDark;ForeCol" & _
        "or:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal4{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal5{BackC" & _
        "olor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9))
        Me.GridDim5.TabIndex = 3
        Me.GridDim5.Visible = False
        '
        'GridTotals
        '
        Me.GridTotals.BackColor = System.Drawing.SystemColors.Window
        Me.GridTotals.ColumnInfo = "10,0,0,0,0,85,Columns:"
        Me.GridTotals.ForeColor = System.Drawing.SystemColors.WindowText
        Me.GridTotals.Location = New System.Drawing.Point(25, 104)
        Me.GridTotals.Name = "GridTotals"
        Me.GridTotals.Rows.Fixed = 0
        Me.GridTotals.Size = New System.Drawing.Size(511, 224)
        Me.GridTotals.Styles = New C1.Win.C1FlexGrid.CellStyleCollection("Normal{Font:Arial, 8.25pt;}" & Microsoft.VisualBasic.ChrW(9) & "Fixed{BackColor:Control;ForeColor:ControlText;Border:" & _
        "Flat,1,ControlDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "Highlight{BackColor:Highlight;ForeColor:HighlightText;" & _
        "}" & Microsoft.VisualBasic.ChrW(9) & "Search{BackColor:Highlight;ForeColor:HighlightText;}" & Microsoft.VisualBasic.ChrW(9) & "Frozen{BackColor:Beige;}" & Microsoft.VisualBasic.ChrW(9) & _
        "EmptyArea{BackColor:AppWorkspace;Border:Flat,1,ControlDarkDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "GrandTotal" & _
        "{BackColor:Black;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal0{BackColor:ControlDarkDark;ForeColor" & _
        ":White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal1{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal2{BackCol" & _
        "or:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal3{BackColor:ControlDarkDark;ForeCol" & _
        "or:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal4{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal5{BackC" & _
        "olor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9))
        Me.GridTotals.TabIndex = 8
        Me.GridTotals.Visible = False
        '
        'btnCreateBoldCodeRevenue
        '
        Me.btnCreateBoldCodeRevenue.BackColor = System.Drawing.Color.White
        Me.btnCreateBoldCodeRevenue.Font = New System.Drawing.Font("Arial", 8.25!, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.btnCreateBoldCodeRevenue.ImageAlign = System.Drawing.ContentAlignment.BottomLeft
        Me.btnCreateBoldCodeRevenue.Location = New System.Drawing.Point(680, 16)
        Me.btnCreateBoldCodeRevenue.Name = "btnCreateBoldCodeRevenue"
        Me.btnCreateBoldCodeRevenue.Size = New System.Drawing.Size(144, 40)
        Me.btnCreateBoldCodeRevenue.TabIndex = 9
        Me.btnCreateBoldCodeRevenue.Text = "Create bold code file"
        Me.ToolTip1.SetToolTip(Me.btnCreateBoldCodeRevenue, "Create bold code file")
        Me.btnCreateBoldCodeRevenue.Visible = False
        '
        'btnCreateBoldCodeExpenditure
        '
        Me.btnCreateBoldCodeExpenditure.BackColor = System.Drawing.Color.White
        Me.btnCreateBoldCodeExpenditure.Font = New System.Drawing.Font("Arial", 8.25!, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.btnCreateBoldCodeExpenditure.ImageAlign = System.Drawing.ContentAlignment.BottomLeft
        Me.btnCreateBoldCodeExpenditure.Location = New System.Drawing.Point(680, 16)
        Me.btnCreateBoldCodeExpenditure.Name = "btnCreateBoldCodeExpenditure"
        Me.btnCreateBoldCodeExpenditure.Size = New System.Drawing.Size(144, 40)
        Me.btnCreateBoldCodeExpenditure.TabIndex = 11
        Me.btnCreateBoldCodeExpenditure.Text = "Create bold code file"
        Me.ToolTip1.SetToolTip(Me.btnCreateBoldCodeExpenditure, " Create a bold code expenditure file. ")
        Me.btnCreateBoldCodeExpenditure.Visible = False
        '
        'GridDim6
        '
        Me.GridDim6.BackColor = System.Drawing.SystemColors.Window
        Me.GridDim6.ColumnInfo = "10,0,0,0,0,85,Columns:"
        Me.GridDim6.ForeColor = System.Drawing.SystemColors.WindowText
        Me.GridDim6.Location = New System.Drawing.Point(4000, 8)
        Me.GridDim6.Name = "GridDim6"
        Me.GridDim6.Rows.Fixed = 0
        Me.GridDim6.Size = New System.Drawing.Size(80, 32)
        Me.GridDim6.Styles = New C1.Win.C1FlexGrid.CellStyleCollection("Normal{Font:Arial, 8.25pt;}" & Microsoft.VisualBasic.ChrW(9) & "Fixed{BackColor:Control;ForeColor:ControlText;Border:" & _
        "Flat,1,ControlDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "Highlight{BackColor:Highlight;ForeColor:HighlightText;" & _
        "}" & Microsoft.VisualBasic.ChrW(9) & "Search{BackColor:Highlight;ForeColor:HighlightText;}" & Microsoft.VisualBasic.ChrW(9) & "Frozen{BackColor:Beige;}" & Microsoft.VisualBasic.ChrW(9) & _
        "EmptyArea{BackColor:AppWorkspace;Border:Flat,1,ControlDarkDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "GrandTotal" & _
        "{BackColor:Black;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal0{BackColor:ControlDarkDark;ForeColor" & _
        ":White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal1{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal2{BackCol" & _
        "or:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal3{BackColor:ControlDarkDark;ForeCol" & _
        "or:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal4{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal5{BackC" & _
        "olor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9))
        Me.GridDim6.TabIndex = 12
        Me.GridDim6.Visible = False
        '
        'GridDim7
        '
        Me.GridDim7.BackColor = System.Drawing.SystemColors.Window
        Me.GridDim7.ColumnInfo = "10,0,0,0,0,85,Columns:"
        Me.GridDim7.ForeColor = System.Drawing.SystemColors.WindowText
        Me.GridDim7.Location = New System.Drawing.Point(4000, 8)
        Me.GridDim7.Name = "GridDim7"
        Me.GridDim7.Rows.Fixed = 0
        Me.GridDim7.Size = New System.Drawing.Size(80, 32)
        Me.GridDim7.Styles = New C1.Win.C1FlexGrid.CellStyleCollection("Normal{Font:Arial, 8.25pt;}" & Microsoft.VisualBasic.ChrW(9) & "Fixed{BackColor:Control;ForeColor:ControlText;Border:" & _
        "Flat,1,ControlDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "Highlight{BackColor:Highlight;ForeColor:HighlightText;" & _
        "}" & Microsoft.VisualBasic.ChrW(9) & "Search{BackColor:Highlight;ForeColor:HighlightText;}" & Microsoft.VisualBasic.ChrW(9) & "Frozen{BackColor:Beige;}" & Microsoft.VisualBasic.ChrW(9) & _
        "EmptyArea{BackColor:AppWorkspace;Border:Flat,1,ControlDarkDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "GrandTotal" & _
        "{BackColor:Black;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal0{BackColor:ControlDarkDark;ForeColor" & _
        ":White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal1{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal2{BackCol" & _
        "or:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal3{BackColor:ControlDarkDark;ForeCol" & _
        "or:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal4{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal5{BackC" & _
        "olor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9))
        Me.GridDim7.TabIndex = 13
        Me.GridDim7.Visible = False
        '
        'GridDim8
        '
        Me.GridDim8.BackColor = System.Drawing.SystemColors.Window
        Me.GridDim8.ColumnInfo = "10,0,0,0,0,85,Columns:"
        Me.GridDim8.ForeColor = System.Drawing.SystemColors.WindowText
        Me.GridDim8.Location = New System.Drawing.Point(4000, 82)
        Me.GridDim8.Name = "GridDim8"
        Me.GridDim8.Rows.Fixed = 0
        Me.GridDim8.Size = New System.Drawing.Size(80, 32)
        Me.GridDim8.Styles = New C1.Win.C1FlexGrid.CellStyleCollection("Normal{Font:Arial, 8.25pt;}" & Microsoft.VisualBasic.ChrW(9) & "Fixed{BackColor:Control;ForeColor:ControlText;Border:" & _
        "Flat,1,ControlDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "Highlight{BackColor:Highlight;ForeColor:HighlightText;" & _
        "}" & Microsoft.VisualBasic.ChrW(9) & "Search{BackColor:Highlight;ForeColor:HighlightText;}" & Microsoft.VisualBasic.ChrW(9) & "Frozen{BackColor:Beige;}" & Microsoft.VisualBasic.ChrW(9) & _
        "EmptyArea{BackColor:AppWorkspace;Border:Flat,1,ControlDarkDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "GrandTotal" & _
        "{BackColor:Black;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal0{BackColor:ControlDarkDark;ForeColor" & _
        ":White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal1{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal2{BackCol" & _
        "or:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal3{BackColor:ControlDarkDark;ForeCol" & _
        "or:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal4{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal5{BackC" & _
        "olor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9))
        Me.GridDim8.TabIndex = 14
        Me.GridDim8.Visible = False
        '
        'GridDim3
        '
        Me.GridDim3.BackColor = System.Drawing.SystemColors.Window
        Me.GridDim3.ColumnInfo = "10,0,0,0,0,85,Columns:"
        Me.GridDim3.ForeColor = System.Drawing.SystemColors.WindowText
        Me.GridDim3.Location = New System.Drawing.Point(4000, 8)
        Me.GridDim3.Name = "GridDim3"
        Me.GridDim3.Rows.Fixed = 0
        Me.GridDim3.Size = New System.Drawing.Size(80, 32)
        Me.GridDim3.Styles = New C1.Win.C1FlexGrid.CellStyleCollection("Normal{Font:Arial, 8.25pt;}" & Microsoft.VisualBasic.ChrW(9) & "Fixed{BackColor:Control;ForeColor:ControlText;Border:" & _
        "Flat,1,ControlDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "Highlight{BackColor:Highlight;ForeColor:HighlightText;" & _
        "}" & Microsoft.VisualBasic.ChrW(9) & "Search{BackColor:Highlight;ForeColor:HighlightText;}" & Microsoft.VisualBasic.ChrW(9) & "Frozen{BackColor:Beige;}" & Microsoft.VisualBasic.ChrW(9) & _
        "EmptyArea{BackColor:AppWorkspace;Border:Flat,1,ControlDarkDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "GrandTotal" & _
        "{BackColor:Black;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal0{BackColor:ControlDarkDark;ForeColor" & _
        ":White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal1{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal2{BackCol" & _
        "or:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal3{BackColor:ControlDarkDark;ForeCol" & _
        "or:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal4{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal5{BackC" & _
        "olor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9))
        Me.GridDim3.TabIndex = 15
        Me.GridDim3.Visible = False
        '
        'PanelBoldSuccess
        '
        Me.PanelBoldSuccess.BackColor = System.Drawing.Color.SpringGreen
        Me.PanelBoldSuccess.Controls.Add(Me.Label2)
        Me.PanelBoldSuccess.Controls.Add(Me.Label1)
        Me.PanelBoldSuccess.Location = New System.Drawing.Point(-16, -16)
        Me.PanelBoldSuccess.Name = "PanelBoldSuccess"
        Me.PanelBoldSuccess.Size = New System.Drawing.Size(688, 104)
        Me.PanelBoldSuccess.TabIndex = 16
        '
        'Label2
        '
        Me.Label2.BackColor = System.Drawing.Color.SpringGreen
        Me.Label2.Font = New System.Drawing.Font("Verdana", 9.75!, CType((System.Drawing.FontStyle.Bold Or System.Drawing.FontStyle.Italic), System.Drawing.FontStyle), System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Label2.ForeColor = System.Drawing.Color.Black
        Me.Label2.Location = New System.Drawing.Point(32, 56)
        Me.Label2.Name = "Label2"
        Me.Label2.Size = New System.Drawing.Size(544, 16)
        Me.Label2.TabIndex = 14
        Me.Label2.Text = "Do not change the name of the bold code file!"
        '
        'Label1
        '
        Me.Label1.BackColor = System.Drawing.Color.SpringGreen
        Me.Label1.Font = New System.Drawing.Font("Verdana", 8.25!, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Label1.ForeColor = System.Drawing.Color.Black
        Me.Label1.Location = New System.Drawing.Point(32, 24)
        Me.Label1.Name = "Label1"
        Me.Label1.Size = New System.Drawing.Size(544, 24)
        Me.Label1.TabIndex = 13
        Me.Label1.Text = "The bold code contains no errors.  Click the button to the right to create your b" & _
        "old code file."
        '
        'btnAdministrator
        '
        Me.btnAdministrator.BackColor = System.Drawing.Color.White
        Me.btnAdministrator.Image = CType(resources.GetObject("btnAdministrator.Image"), System.Drawing.Image)
        Me.btnAdministrator.Location = New System.Drawing.Point(832, 16)
        Me.btnAdministrator.Name = "btnAdministrator"
        Me.btnAdministrator.Size = New System.Drawing.Size(40, 40)
        Me.btnAdministrator.TabIndex = 15
        '
        'PanelBoldFail
        '
        Me.PanelBoldFail.BackColor = System.Drawing.Color.Crimson
        Me.PanelBoldFail.Controls.Add(Me.Label3)
        Me.PanelBoldFail.Controls.Add(Me.Label4)
        Me.PanelBoldFail.Location = New System.Drawing.Point(-16, -16)
        Me.PanelBoldFail.Name = "PanelBoldFail"
        Me.PanelBoldFail.Size = New System.Drawing.Size(688, 104)
        Me.PanelBoldFail.TabIndex = 17
        Me.PanelBoldFail.Visible = False
        '
        'Label3
        '
        Me.Label3.BackColor = System.Drawing.Color.Crimson
        Me.Label3.Font = New System.Drawing.Font("Verdana", 9.75!, CType((System.Drawing.FontStyle.Bold Or System.Drawing.FontStyle.Italic), System.Drawing.FontStyle), System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Label3.ForeColor = System.Drawing.Color.White
        Me.Label3.Location = New System.Drawing.Point(32, 48)
        Me.Label3.Name = "Label3"
        Me.Label3.Size = New System.Drawing.Size(544, 16)
        Me.Label3.TabIndex = 16
        Me.Label3.Text = "No file can be created until corrections have been made!"
        '
        'Label4
        '
        Me.Label4.BackColor = System.Drawing.Color.Crimson
        Me.Label4.Font = New System.Drawing.Font("Verdana", 8.25!, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Label4.ForeColor = System.Drawing.Color.White
        Me.Label4.Location = New System.Drawing.Point(32, 24)
        Me.Label4.Name = "Label4"
        Me.Label4.Size = New System.Drawing.Size(544, 24)
        Me.Label4.TabIndex = 15
        Me.Label4.Text = "The bold code contains errors.  "
        '
        'griddim9
        '
        Me.griddim9.BackColor = System.Drawing.SystemColors.Window
        Me.griddim9.ColumnInfo = "10,0,0,0,0,85,Columns:"
        Me.griddim9.ForeColor = System.Drawing.SystemColors.WindowText
        Me.griddim9.Location = New System.Drawing.Point(4000, 250)
        Me.griddim9.Name = "griddim9"
        Me.griddim9.Rows.Fixed = 0
        Me.griddim9.Size = New System.Drawing.Size(80, 32)
        Me.griddim9.Styles = New C1.Win.C1FlexGrid.CellStyleCollection("Normal{Font:Arial, 8.25pt;}" & Microsoft.VisualBasic.ChrW(9) & "Fixed{BackColor:Control;ForeColor:ControlText;Border:" & _
        "Flat,1,ControlDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "Highlight{BackColor:Highlight;ForeColor:HighlightText;" & _
        "}" & Microsoft.VisualBasic.ChrW(9) & "Search{BackColor:Highlight;ForeColor:HighlightText;}" & Microsoft.VisualBasic.ChrW(9) & "Frozen{BackColor:Beige;}" & Microsoft.VisualBasic.ChrW(9) & _
        "EmptyArea{BackColor:AppWorkspace;Border:Flat,1,ControlDarkDark,Both;}" & Microsoft.VisualBasic.ChrW(9) & "GrandTotal" & _
        "{BackColor:Black;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal0{BackColor:ControlDarkDark;ForeColor" & _
        ":White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal1{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal2{BackCol" & _
        "or:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal3{BackColor:ControlDarkDark;ForeCol" & _
        "or:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal4{BackColor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9) & "Subtotal5{BackC" & _
        "olor:ControlDarkDark;ForeColor:White;}" & Microsoft.VisualBasic.ChrW(9))
        Me.griddim9.TabIndex = 18
        Me.griddim9.Visible = False
        '
        'frmBoldCode
        '
        Me.AutoScaleBaseSize = New System.Drawing.Size(5, 13)
        Me.ClientSize = New System.Drawing.Size(864, 533)
        Me.Controls.Add(Me.btnCreateBoldCodeRevenue)
        Me.Controls.Add(Me.griddim9)
        Me.Controls.Add(Me.GridDim3)
        Me.Controls.Add(Me.GridDim7)
        Me.Controls.Add(Me.GridDim6)
        Me.Controls.Add(Me.GridDim5)
        Me.Controls.Add(Me.GridDim4)
        Me.Controls.Add(Me.GridDetail)
        Me.Controls.Add(Me.GridTotals)
        Me.Controls.Add(Me.GridDim8)
        Me.Controls.Add(Me.Prev1)
        Me.Controls.Add(Me.PanelBoldFail)
        Me.Controls.Add(Me.btnAdministrator)
        Me.Controls.Add(Me.PanelBoldSuccess)
        Me.Controls.Add(Me.btnCreateBoldCodeExpenditure)
        Me.Font = New System.Drawing.Font("Arial", 8.25!, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, CType(0, Byte))
        Me.Icon = CType(resources.GetObject("$this.Icon"), System.Drawing.Icon)
        Me.MinimumSize = New System.Drawing.Size(300, 200)
        Me.Name = "frmBoldCode"
        Me.SizeGripStyle = System.Windows.Forms.SizeGripStyle.Hide
        Me.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen
        Me.Text = "  Activity Fund.Net Bold Code Reporting"
        Me.WindowState = System.Windows.Forms.FormWindowState.Maximized
        CType(Me.Prev1, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.GridDetail, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.GridDim4, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.GridDim5, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.GridTotals, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.GridDim6, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.GridDim7, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.GridDim8, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.GridDim3, System.ComponentModel.ISupportInitialize).EndInit()
        Me.PanelBoldSuccess.ResumeLayout(False)
        Me.PanelBoldFail.ResumeLayout(False)
        CType(Me.griddim9, System.ComponentModel.ISupportInitialize).EndInit()
        Me.ResumeLayout(False)

    End Sub

#End Region

#Region "  Button Events "

    Private Sub btnAdministrator_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAdministrator.Click
        Dim obj As New AF_Master.frmUnlockCode
        Try
            Dim response As DialogResult
            response = obj.ShowDialog()
            If response = DialogResult.OK Then
                'check for authorization;
                If obj.IsAuthorised Then
                    Me.PanelBoldFail.Visible = False
                    Me.PanelBoldSuccess.Visible = False
                    If Me.DocumentName = "BoldCodeExpenditure" Then
                        Me.btnCreateBoldCodeExpenditure.Enabled = True
                        Me.btnCreateBoldCodeExpenditure.Text = "Create bold code file"
                    End If
                    If Me.DocumentName = "BoldCodeRevenue" Then
                        Me.btnCreateBoldCodeRevenue.Enabled = True
                        Me.btnCreateBoldCodeRevenue.Text = "Create bold code file"
                    End If
                End If
            End If
        Catch ex As Exception

        End Try
    End Sub

    Private Sub btnCreateBoldCodeExpenditure_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCreateBoldCodeExpenditure.Click
        Try
            Dim response As DialogResult
            With Me.SaveFileDialog1
                .Filter = "Dat files (*.dat)|*.dat|All files (*.*)|*.*"
                .FileName = "expendACT.dat"
                '.FileName = "expend.dat"
                response = .ShowDialog()
                If response <> DialogResult.OK Then Exit Sub
                'set the file path;
                Me.BoldCodeFilePath = .FileName
                'verify the name if the user changed it;
                If Not Me.BoldCodeFilePath.EndsWith("expendACT.dat") Then
                    response = MessageBox.Show("Are you sure you would like to change the name?", MSGTITLE, MessageBoxButtons.YesNoCancel, MessageBoxIcon.Warning, MessageBoxDefaultButton.Button2)
                    If response <> DialogResult.Yes Then Exit Sub
                End If
            End With
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Exclamation, MSGTITLE)
            Exit Sub
        End Try

        Try
            Dim result As Boolean
            result = WriteBoldCodeExpenditureFile()
            If result Then
                MsgBox("Bold code file has been successfully created.", MsgBoxStyle.Information, MSGTITLE)
            Else
                MsgBox("An unexpected error occurred while creating the bold code file.", MsgBoxStyle.Exclamation, MSGTITLE)
            End If
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Critical, MSGTITLE)
        End Try
    End Sub

    Private Sub btnCreateBoldCodeRevenue_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCreateBoldCodeRevenue.Click
        Try
            Dim response As DialogResult
            With Me.SaveFileDialog1
                .Filter = "Dat files (*.dat)|*.dat|All files (*.*)|*.*"
                .FileName = "revenueACT.dat"
                '.FileName = "revenue.dat"
                response = .ShowDialog()
                If response <> DialogResult.OK Then Exit Sub
                'set the file path
                Me.BoldCodeFilePath = .FileName
                'verify the name if the user changed it;
                If Not Me.BoldCodeFilePath.EndsWith("revenueACT.dat") Then
                    response = MessageBox.Show("Are you sure you would like to change the name?", MSGTITLE, MessageBoxButtons.YesNoCancel, MessageBoxIcon.Warning, MessageBoxDefaultButton.Button2)
                    If response <> DialogResult.Yes Then Exit Sub
                End If
            End With
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Exclamation, MSGTITLE)
            Exit Sub
        End Try

        Try
            Dim result As Boolean
            result = WriteBoldCodeRevenueFile()
            If result Then
                MsgBox("Bold code file has been successfully created.", MsgBoxStyle.Information, MSGTITLE)
            Else
                MsgBox("An unexpected error occurred while creating the bold code file.", MsgBoxStyle.Exclamation, MSGTITLE)
            End If
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Critical, MSGTITLE)
        End Try
    End Sub

#End Region

#Region "  C1Doc Events "

    Private Sub Doc1_NewPageStarted(ByVal sender As C1.C1PrintDocument.C1PrintDocument, ByVal e As C1.C1PrintDocument.NewPageStartedEventArgs) Handles Doc1.NewPageStarted
        PrintHeader()
    End Sub

#End Region

#Region "  Class Members "

    'styles
    Private arialleft8 As C1DocStyle
    Private arialright8 As C1DocStyle
    Private arialleft10 As C1DocStyle
    Private arialleft10bold As C1DocStyle
    Private arialright10 As C1DocStyle
    Private arialright10bold As C1DocStyle
    Private footerstyle As C1DocStyle
    Private specstyle As C1DocStyle
    Private timesleft16 As C1DocStyle
    Private verdanaleft8 As C1DocStyle
    Private verdanaright8 As C1DocStyle
    Private verdanaleft8bold As C1DocStyle
    Private verdanaright8bold As C1DocStyle
    Private verdanaleft10 As C1DocStyle
    Private verdanaright10 As C1DocStyle
    Private verdanaleft10bold As C1DocStyle
    Private verdanaright10bold As C1DocStyle
    'header values
    Private CellMiddleBottom As String = ""
    Private CellMiddleMiddle As String = ""
    Private CellMiddleTop As String = ""
    Private CellRightBottom As String = ""
    Private CellRightMiddle As String = ""
    Private CellRightTop As String = ""
    'property vars
    Private _balanceforwardamount As Double
    Private _balanceforwardcount As Int32
    Private _bankaccountnumber As String
    Private _boldcodefilepath As String
    Private _connectionstring As String
    Private _countyid As String
    Private _districtid As String
    Private _documentname As String
    Private _fiscalyear As Int32
    Private _fiscalyearselected As Int32
    Private _haserrors As Boolean = False
    Private MSGTITLE As String = "Activity Fund Reports"
    Private _reportname As String
    Private _schoolname As String
    Private _schoolnumber As String
    Private _schooladdress1 As String
    Private _schooladdress2 As String
    Private _schoolcitystatezip As String
    Private cn As SqlConnection

    Public _editchk As Boolean
    Public _expendcode As String
    Public _Revenuecode As String
    Public _ExpenseCodeFlag As Boolean

#End Region

#Region "  Delegates & Events "

    Public Event RecordsProcessed(ByVal ecurrentrecord As Int32, ByVal erecordcount As Int32)

    Private Sub EventRecordProcessed(ByVal ecurrentrecord As Int32, ByVal erecordcount As Int32)
        'statusbar update on mainmenu...
        Dim i As Int32
        If i Mod 5 = 0 Then
            RaiseEvent RecordsProcessed(ecurrentrecord, erecordcount)
            Application.DoEvents()
        End If
    End Sub

#End Region

#Region "  Document Settings & Styles "

    Private Sub DefineDocumentSettings(ByVal edocumentname As String)
        With Me.Doc1
            Select Case edocumentname
                Case "BoldCodeExpenditure", "BoldCodeExpenditureErrors", "BoldCodeRevenue", "BoldCodeRevenueErrors", "Classification"
                    .DefaultUnit = UnitTypeEnum.Mm
                    .DefaultUnitOfFrames = UnitTypeEnum.Mm
                    .PageSettings.Landscape = False
                    .PageSettings.Margins.Left = 50
                    .PageSettings.Margins.Top = 10
                    .PageSettings.Margins.Right = 50
                    .PageSettings.Margins.Bottom = 20
                    .PageFooter.Height = 10
                    '.PageFooter.RenderText.Style.Font = New Font("Verdana", 8, FontStyle.Regular)
                    '.PageFooter.RenderText.Text = "Page [@@PageNo@@] of [@@PageCount@@]"
                Case Else
            End Select
        End With

        DefineFooterStyle()

    End Sub

    Private Sub DefineFooterStyle()
        'style for the footer
        With footerstyle
            .Font = New Font("Verdana", 8, FontStyle.Regular)
            .TextColor = Color.Gray
        End With
    End Sub

    Private Sub DefineStyles()
        With Me.arialleft8
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Arial", 8, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Left
        End With
        With Me.arialright8
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Arial", 8, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Right
        End With
        With Me.arialleft10
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Arial", 10, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Left
        End With
        With Me.arialleft10bold
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Arial", 10, FontStyle.Bold)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Left
        End With
        With Me.arialright10
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Arial", 10, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Right
        End With
        With Me.timesleft16
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Times", 16, FontStyle.Bold)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Left
            .TextColor = Color.Salmon
        End With
        With Me.verdanaleft8
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 8, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
        End With
        With Me.verdanaleft8bold
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 8, FontStyle.Bold)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
        End With
        With Me.verdanaright8
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 8, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Right
        End With
        With Me.verdanaright8bold
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 8, FontStyle.Bold)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Right
        End With
        With Me.verdanaleft10
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 10, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
        End With
        With Me.verdanaleft10bold
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 10, FontStyle.Bold)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
        End With
        With Me.verdanaright10
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 10, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Right
        End With
        With Me.verdanaright10bold
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 10, FontStyle.Bold)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Right
        End With
    End Sub

#End Region

#Region "  Methods 2006 Edit Checks "

    '    Private Function Expenditure2005_Phase1_EditCheck() As Boolean
    '        'phase 1 rolls the detail codes to the bold.  if a code will not
    '        'roll, error values (error flag, error message) are inserted
    '        'into the row for later access.

    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        '     0           1         2        3        4        5   
    '        '   bank       fisyr    docnumber   amt    count   expendcode
    '        '     6           7         8        9       10
    '        '   descr     remarks   created    ttype -- NOT USED --
    '        '    11          12        13       14       15   
    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

    '        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
    '        Dim expendcode, boldcode, boldcodefmt As String
    '        Dim errordescr, errorphase, errorval, prevcode As String
    '        Dim tamt As Double
    '        Dim tcount, currow, rowindex As Int32

    '        Dim tempx As String

    '        For currow = 0 To Me.GridDetail.Rows.Count - 1
    '            errordescr = ""
    '            errorphase = "0"
    '            errorval = ""

    '            Try
    '                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
    '                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
    '                dim1 = expendcode.Substring(0, 1)
    '                dim2 = expendcode.Substring(1, 2)
    '                dim3 = expendcode.Substring(3, 3)
    '                dim4 = expendcode.Substring(6, 4)
    '                dim5 = expendcode.Substring(10, 3)
    '                dim6 = expendcode.Substring(13, 3)
    '                dim7 = expendcode.Substring(16, 4)
    '                dim8 = expendcode.Substring(20, 3)
    '                dim9 = expendcode.Substring(23, 3)
    '            Catch ex As Exception
    '                Throw
    '            End Try

    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'year has no validation
    '            '''''''''''''''''''''''''''''''''''''''''''''

    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the fund
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Select Case dim2
    '                Case "60"
    '                    'good
    '                Case Else
    '                    'error
    '                    errorval = dim2
    '                    errordescr = "Error: Fund 60 required."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the project
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim3 As String = ValidateDim3(dim3)
    '            Select Case testdim3
    '                Case "-1"
    '                    'error
    '                    errorval = dim3
    '                    errordescr = "Error: Project not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim3 = testdim3 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the function
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim4 As String = ValidateDim4(dim4)
    '            Select Case testdim4
    '                Case "-1"
    '                    'error
    '                    errorval = dim4
    '                    errordescr = "Error: Function not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim4 = testdim4 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the object
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim5 As String = ValidateEDim5(dim5)
    '            Select Case testdim5
    '                Case "-1"
    '                    'error
    '                    errorval = dim5
    '                    errordescr = "Error: Object not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim5 = testdim5 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the program
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim temp6 As Int32 = CInt(dim6)
    '            If (temp6 >= 800) And (temp6 <= 899) Then
    '                dim6 = "800"
    '            End If
    '            Dim testdim6 As String = ValidateDim6(dim6)
    '            Select Case testdim6
    '                Case "-1"
    '                    'error
    '                    errorval = dim6
    '                    errordescr = "Error: Program not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim6 = testdim6 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the subject
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim7 As String = ValidateDim7(dim7)
    '            Select Case testdim7
    '                Case "-1"
    '                    'error
    '                    errorval = dim7
    '                    errordescr = "Error: Subject not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim7 = testdim7 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the jobclass
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim8 As String = ValidateDim8(dim8)
    '            Select Case testdim8
    '                Case "-1"
    '                    'error
    '                    errorval = dim8
    '                    errordescr = "Error: Job class not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim8 = testdim8 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the site
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Select Case dim9
    '                Case "050"

    '                Case Else
    '                    'roll to 050
    '                    dim9 = "050"
    '            End Select

    'Errorcatch:

    '            If errorphase <> "0" Then Me.HasErrors = True
    '            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
    '            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
    '            With Me.GridDetail
    '                .SetData(currow, 11, errorphase)        'phase
    '                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
    '                .SetData(currow, 13, boldcode)          'boldcode
    '                .SetData(currow, 14, errorval)          'badval 
    '                .SetData(currow, 15, errordescr)        'error descr
    '            End With
    '        Next
    '    End Function

    '    Private Function Expenditure2005_Phase2_EditCheck() As Boolean
    '        'phase 2 performs the edit checks for the dimensions used. at this
    '        'point, the codes have already been rolled to the bold.  Note: the 
    '        'phaseerror will be accessed to determine if this item should run 
    '        'thru the edit checks.  If an item failed in phase 1, then it will
    '        'be skipped in this phase.
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        '     0           1         2        3        4        5   
    '        '   bank       fisyr    docnumber   amt    count   revenuecode
    '        '     6           7         8        9       10
    '        '   descr     remarks   created    ttype -- NOT USED --
    '        '    11          12        13       14       15   
    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
    '        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9 As Int32
    '        Dim expendcode, boldcode, boldcodefmt As String
    '        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
    '        Dim currow, rowindex As Int32
    '        Dim valid As Boolean

    '        Try
    '            For currow = 0 To Me.GridDetail.Rows.Count - 1
    '                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
    '                If phaseerror <> "0" Then GoTo Skiprecord

    '                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
    '                dim1 = expendcode.Substring(0, 1)
    '                dim2 = expendcode.Substring(1, 2)
    '                dim3 = expendcode.Substring(3, 3)
    '                dim4 = expendcode.Substring(6, 4)
    '                dim5 = expendcode.Substring(10, 3)
    '                dim6 = expendcode.Substring(13, 3)
    '                dim7 = expendcode.Substring(16, 4)
    '                dim8 = expendcode.Substring(20, 3)
    '                dim9 = expendcode.Substring(23, 3)
    '                'convert to ints
    '                idim1 = CInt(dim1)
    '                idim2 = CInt(dim2)
    '                idim3 = CInt(dim3)
    '                idim4 = CInt(dim4)
    '                idim5 = CInt(dim5)
    '                idim6 = CInt(dim6)
    '                idim7 = CInt(dim7)
    '                idim8 = CInt(dim8)
    '                idim9 = CInt(dim9)

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the fund
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim2
    '                    Case 60
    '                    Case Else
    '                        valid = False
    '                        errorval = dim2
    '                        errorphase = "2"
    '                        errordescr = "Error: Fund 60 required."
    '                        GoTo Errorhandle
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the project
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim3
    '                    Case 385        'project to function validation
    '                        valid = False
    '                        If idim4 >= 3100 And idim4 <= 3199 Then valid = False
    '                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
    '                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
    '                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
    '                        If idim4 >= 5700 And idim4 <= 5799 Then valid = True
    '                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
    '                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
    '                        If idim4 >= 8900 And idim4 <= 8999 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for project 385."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 800        'fund 60 only
    '                        valid = True
    '                    Case Else       'all other projects fail
    '                        valid = False
    '                        errorval = dim3
    '                        errorphase = "2"
    '                        errordescr = "Error: Project invalid for fund 60."
    '                        GoTo Errorhandle
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the function
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim4
    '                    Case 3200
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 660 Then valid = True
    '                        If idim5 = 670 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 3200."
    '                            GoTo Errorhandle
    '                        End If

    '                    Case 5200 To 5299
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 930 Then valid = True
    '                        If idim5 = 940 Then valid = True
    '                        If idim5 = 950 Then valid = True
    '                        If idim5 = 960 Then valid = True
    '                        If idim5 = 981 Then valid = True
    '                        If idim5 = 982 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5200."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 5300 To 5399
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 290 Then valid = True
    '                        If idim5 = 960 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5300."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 5400 To 5499
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 5500 To 5599
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 5600 To 5699
    '                        If idim5 <> 930 Then
    '                            valid = False
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5600."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 5700 To 5799
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 990 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5700."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 5800 To 5899
    '                        If idim5 <> 970 Then
    '                            valid = False
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5800."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 7400 To 7499
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 7500 To 7599
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 7600 To 7699
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 7700 To 7799
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 7800 To 7899
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 8100
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 890 Then valid = True
    '                        If idim5 = 930 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 8100."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 8900
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 890 Then valid = True
    '                        If idim5 = 930 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 8900."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the object
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim5
    '                    Case 100 To 199             'payroll objects???
    '                        If idim8 = 0 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Object requires a valid job class."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 290                    'payroll objects???
    '                        If idim4 <> 5300 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 410
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 = 2620 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 450
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
    '                        If idim4 >= 3140 Or idim4 <= 3149 Then valid = False
    '                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 511, 512, 513, 515, 516
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 = 2720 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If idim4 = 5500 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 522
    '                        If idim4 <> 2319 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 523
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 = 2620 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If idim4 = 5500 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 524
    '                        If idim4 <> 2720 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 540
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 = 2314 Then valid = True
    '                        If idim4 = 2560 Then valid = True
    '                        If idim4 = 2571 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If idim4 = 3300 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 561, 562, 566
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Object invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 570
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Object invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 643, 644, 645
    '                        valid = False
    '                        If idim4 = 1000 Then valid = True
    '                        If idim4 = 5500 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 660, 670
    '                        If idim4 <> 3200 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 710
    '                        valid = False
    '                        If idim4 = 4200 Then valid = True
    '                        If idim4 = 4300 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 720
    '                        valid = False
    '                        If idim4 = 4600 Then valid = True
    '                        If idim4 = 4700 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 831, 920
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Object invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 832
    '                        valid = False
    '                        If idim4 = 2511 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If idim4 = 5100 Then valid = True
    '                        If idim4 = 5700 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If

    '                    Case 870
    '                        If idim4 <> 2518 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 880
    '                        If idim4 <= 7200 Or idim4 >= 7299 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 930
    '                        valid = False
    '                        If idim4 = 5200 Then valid = True
    '                        If idim4 = 5600 Then valid = True
    '                        If idim4 = 7400 Then valid = True
    '                        If idim4 = 8100 Then valid = True
    '                        If idim4 = 8900 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 940, 950
    '                        If idim4 <> 5200 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 960
    '                        valid = False
    '                        If idim4 = 5200 Then valid = True
    '                        If idim4 = 5300 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 970
    '                        valid = False
    '                        If idim4 = 5400 Then valid = True
    '                        If idim4 = 5500 Then valid = True
    '                        If idim4 = 5800 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 981, 982
    '                        If idim4 <> 5200 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 990
    '                        If idim4 <> 5700 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the program
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim6
    '                    Case 0
    '                        valid = False
    '                        errorval = dim6
    '                        errorphase = "2"
    '                        errordescr = "Error: Program invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the subject
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim7
    '                    Case 0
    '                        If idim4 = 1000 And idim7 = 0 Then valid = False
    '                        errorval = dim7
    '                        errorphase = "2"
    '                        errordescr = "Error: Subject is required for function 1000."
    '                        GoTo Errorhandle
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the jobclass
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim8
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the site 
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim9
    '                    Case 50
    '                        valid = True
    '                    Case Else
    '                        'it should already be rolled to 050 so error if not true
    '                        errorval = dim9
    '                        errorphase = "2"
    '                        errordescr = "Error: Site invalid for fund 60."
    '                        GoTo Errorhandle
    '                End Select

    'Errorhandle:
    '                If valid = False Then
    '                    Me.HasErrors = True
    '                    With Me.GridDetail
    '                        .SetData(currow, 11, errorphase)
    '                        .SetData(currow, 14, errorval)
    '                        .SetData(currow, 15, errordescr)
    '                    End With
    '                End If
    '                'clear the vars
    '                errorphase = "0"
    '                errorval = ""
    '                errordescr = ""
    'Skiprecord:
    '            Next
    '        Catch ex As Exception
    '            Throw
    '        End Try

    '    End Function

    '    '    Private Function Revenue2005_Phase1_EditCheck() As Boolean
    '    '        'phase 1 rolls the detail codes to the bold.  if a code will not
    '    '        'roll, error values (error flag, error message) are inserted
    '    '        'into the row for later access.

    '    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '    '        '     0           1         2        3        4        5   
    '    '        '   bank       fisyr    docnumber   amt    count   revenuecode
    '    '        '     6           7         8        9       10
    '    '        '   descr     remarks   created    ttype -- NOT USED --
    '    '        '    11          12        13       14       15   
    '    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

    '    '        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
    '    '        Dim revenuecode, boldcode, boldcodefmt As String
    '    '        Dim errordescr, errorphase, errorval, prevcode As String
    '    '        Dim tamt As Double
    '    '        Dim tcount, currow, rowindex As Int32

    '    '        For currow = 0 To Me.GridDetail.Rows.Count - 1
    '    '            errordescr = ""
    '    '            errorphase = "0"
    '    '            errorval = ""
    '    '            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
    '    '            dim1 = revenuecode.Substring(0, 1)
    '    '            dim2 = revenuecode.Substring(1, 2)
    '    '            dim3 = revenuecode.Substring(3, 3)
    '    '            dim4 = revenuecode.Substring(6, 4)
    '    '            dim5 = revenuecode.Substring(10, 3)
    '    '            dim6 = revenuecode.Substring(13, 3)

    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'year has no validation
    '    '            '''''''''''''''''''''''''''''''''''''''''''''

    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the fund
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Select Case dim2
    '    '                Case "60"
    '    '                    'good
    '    '                Case Else
    '    '                    'error
    '    '                    errorval = dim2
    '    '                    errordescr = "Error: Fund 60 required."
    '    '                    errorphase = "1"
    '    '                    GoTo Errorcatch
    '    '            End Select
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the project
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Dim testdim3 As String = ValidateDim3(dim3)
    '    '            Select Case testdim3
    '    '                Case "-1"
    '    '                    'error
    '    '                    errorval = dim3
    '    '                    errordescr = "Error: Project not bold and cannot roll backwards."
    '    '                    errorphase = "1"
    '    '                    GoTo Errorcatch
    '    '                Case Else
    '    '                    'good
    '    '                    dim3 = testdim3 'get the rolled code
    '    '            End Select
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the source
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Dim testdim4 As String = ValidateDim4(dim4)
    '    '            Select Case testdim4
    '    '                Case "-1"
    '    '                    'error
    '    '                    errorval = dim4
    '    '                    errordescr = "Error: Source not bold and cannot roll backwards."
    '    '                    errorphase = "1"
    '    '                    GoTo Errorcatch
    '    '                Case Else
    '    '                    'good
    '    '                    dim4 = testdim4 'get the rolled code
    '    '            End Select
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the program
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Dim temp5 As Int32 = CInt(dim5)
    '    '            If (temp5 >= 800) And (temp5 <= 899) Then
    '    '                dim5 = "800"
    '    '            End If
    '    '            Dim testdim5 As String = ValidateRDim5(dim5)
    '    '            Select Case testdim5
    '    '                Case "-1"
    '    '                    'error
    '    '                    errorval = dim5
    '    '                    errordescr = "Error: Program not bold and cannot roll backwards."
    '    '                    errorphase = "1"
    '    '                    GoTo Errorcatch
    '    '                Case Else
    '    '                    'good
    '    '                    dim5 = testdim5 'get the rolled code
    '    '            End Select
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the site
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Select Case dim6
    '    '                Case "050"

    '    '                Case Else
    '    '                    'roll to 050
    '    '                    dim6 = "050"
    '    '            End Select

    '    'Errorcatch:
    '    '            If errorphase <> "0" Then Me.HasErrors = True
    '    '            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
    '    '            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
    '    '            With Me.GridDetail
    '    '                .SetData(currow, 11, errorphase)        'phase
    '    '                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
    '    '                .SetData(currow, 13, boldcode)          'boldcode
    '    '                .SetData(currow, 14, errorval)          'badval 
    '    '                .SetData(currow, 15, errordescr)        'error descr
    '    '            End With
    '    '        Next
    '    '    End Function

    '    '    Private Function Revenue2005_Phase2_EditCheck() As Boolean
    '    '        'phase 2 performs the edit checks for the dimensions used. at this
    '    '        'point, the codes have already been rolled to the bold.  Note: the 
    '    '        'phaseerror will be accessed to determine if this item should run 
    '    '        'thru the edit checks.  If an item failed in phase 1, then it will
    '    '        'be skipped in this phase.
    '    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '    '        '     0           1         2        3        4        5   
    '    '        '   bank       fisyr    docnumber   amt    count   revenuecode
    '    '        '     6           7         8        9       10
    '    '        '   descr     remarks   created    ttype -- NOT USED --
    '    '        '    11          12        13       14       15   
    '    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '    '        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
    '    '        Dim idim1, idim2, idim3, idim4, idim5, idim6 As Int32
    '    '        Dim revenuecode, boldcode, boldcodefmt As String
    '    '        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
    '    '        Dim currow, rowindex As Int32
    '    '        Dim valid As Boolean

    '    '        Try

    '    '            For currow = 0 To Me.GridDetail.Rows.Count - 1
    '    '                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
    '    '                If phaseerror <> "0" Then GoTo Skiprecord
    '    '                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
    '    '                dim1 = revenuecode.Substring(0, 1)
    '    '                dim2 = revenuecode.Substring(1, 2)
    '    '                dim3 = revenuecode.Substring(3, 3)
    '    '                dim4 = revenuecode.Substring(6, 4)
    '    '                dim5 = revenuecode.Substring(10, 3)
    '    '                dim6 = revenuecode.Substring(13, 3)
    '    '                'convert to ints
    '    '                idim1 = CInt(dim1)
    '    '                idim2 = CInt(dim2)
    '    '                idim3 = CInt(dim3)
    '    '                idim4 = CInt(dim4)
    '    '                idim5 = CInt(dim5)
    '    '                idim6 = CInt(dim6)
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the fund
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'fund 60 requires a program code
    '    '                If idim5 < 800 Then
    '    '                    valid = False
    '    '                    errorval = dim5
    '    '                    errorphase = "2"
    '    '                    errordescr = "Error: Program invalid for fund 60."
    '    '                    GoTo Errorhandle
    '    '                End If

    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the project
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                Select Case idim3
    '    '                    Case 385        'source validation
    '    '                        valid = False
    '    '                        If idim4 = 1310 Then valid = True
    '    '                        If idim4 = 1440 Then valid = True
    '    '                        If idim4 = 1510 Then valid = True
    '    '                        If idim4 = 1550 Then valid = True
    '    '                        If idim4 = 1590 Then valid = True
    '    '                        If idim4 = 1670 Then valid = True
    '    '                        If idim4 >= 1700 And idim4 <= 1799 Then valid = True
    '    '                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
    '    '                        If idim4 = 4710 Then valid = True
    '    '                        If idim4 = 4720 Then valid = True
    '    '                        If idim4 = 4730 Then valid = True
    '    '                        If idim4 >= 5100 And idim4 <= 5199 Then valid = True
    '    '                        If idim4 = 5300 Then valid = True
    '    '                        If idim4 = 5600 Then valid = True
    '    '                        If idim4 = 5700 Then valid = True
    '    '                        If idim4 >= 6000 And idim4 <= 6200 Then valid = True
    '    '                        If Not valid Then
    '    '                            errorval = dim4
    '    '                            errorphase = "2"
    '    '                            errordescr = "Source invalid for project 385."
    '    '                            GoTo Errorhandle
    '    '                        End If
    '    '                    Case 800        'fund 60 only
    '    '                        valid = True
    '    '                    Case Else       'all other projects fail
    '    '                        valid = False
    '    '                        errorval = dim3
    '    '                        errorphase = "2"
    '    '                        errordescr = "Project invalid for fund 60."
    '    '                        GoTo Errorhandle
    '    '                End Select

    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the source
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                Select Case idim4
    '    '                    Case 1100 To 1199
    '    '                        valid = False
    '    '                        errordescr = "Source invalid for fund 60."
    '    '                    Case 1200 To 1299
    '    '                        valid = True
    '    '                    Case 1300 To 1799
    '    '                        valid = True
    '    '                    Case 1800 To 1899
    '    '                        valid = True
    '    '                    Case 1900 To 1999
    '    '                        If idim3 = 800 Then
    '    '                            errordescr = ""
    '    '                            valid = True
    '    '                        Else
    '    '                            valid = False
    '    '                            errordescr = "Source invalid for project " & dim3 & "."
    '    '                        End If
    '    '                    Case 2000 To 4999
    '    '                        valid = False
    '    '                        errordescr = "Source invalid for fund 60."
    '    '                    Case 5111, 5112, 5120, 5130, 5150, 5160, 5190
    '    '                        valid = True
    '    '                    Case 5200, 5300, 5400, 5600, 5700, 5800
    '    '                        valid = True
    '    '                    Case 6110, 6121, 6122, 6130, 6140
    '    '                        valid = True
    '    '                    Case 6200
    '    '                        valid = True
    '    '                    Case Else
    '    '                        valid = False
    '    '                        errordescr = "Source invalid for fund 60."
    '    '                End Select
    '    '                If Not valid Then
    '    '                    errorval = dim4
    '    '                    errorphase = "2"
    '    '                    errordescr = "Error: " + errordescr
    '    '                    GoTo Errorhandle
    '    '                End If

    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the program
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                Select Case idim5
    '    '                    Case 800
    '    '                        valid = True
    '    '                    Case 900
    '    '                        valid = True
    '    '                    Case Else
    '    '                        valid = False
    '    '                        errorval = dim5
    '    '                        errorphase = "2"
    '    '                        errordescr = "Error: Program invalid for fund 60."
    '    '                        GoTo Errorhandle
    '    '                End Select

    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the site
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                Select Case idim6
    '    '                    Case 50
    '    '                        valid = True
    '    '                    Case Else
    '    '                        valid = False
    '    '                        errorval = dim6
    '    '                        errorphase = "2"
    '    '                        errordescr = "Error: Site invalid for fund 60."
    '    '                        GoTo Errorhandle
    '    '                End Select

    '    'Errorhandle:
    '    '                If valid = False Then
    '    '                    Me.HasErrors = True
    '    '                    With Me.GridDetail
    '    '                        .SetData(currow, 11, errorphase)
    '    '                        .SetData(currow, 14, errorval)
    '    '                        .SetData(currow, 15, errordescr)
    '    '                    End With
    '    '                End If
    '    '                'clear the vars
    '    '                errorphase = "0"
    '    '                errorval = ""
    '    '                errordescr = ""
    '    'Skiprecord:
    '    '            Next
    '    '        Catch ex As Exception
    '    '            Throw
    '    '        End Try

    '    '    End Function

#End Region

#Region "  Methods 2007 Edit Checks "

    '    Private Function Expenditure2007_Phase1_EditCheck() As Boolean
    '        'phase 1 rolls the detail codes to the bold.  if a code will not
    '        'roll, error values (error flag, error message) are inserted
    '        'into the row for later access.

    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        '     0           1         2        3        4        5   
    '        '   bank       fisyr    docnumber   amt    count   expendcode
    '        '     6           7         8        9       10
    '        '   descr     remarks   created    ttype -- NOT USED --
    '        '    11          12        13       14       15   
    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

    '        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
    '        Dim expendcode, boldcode, boldcodefmt As String
    '        Dim errordescr, errorphase, errorval, prevcode As String
    '        Dim tamt As Double
    '        Dim tcount, currow, rowindex As Int32

    '        Dim tempx As String

    '        For currow = 0 To Me.GridDetail.Rows.Count - 1
    '            errordescr = ""
    '            errorphase = "0"
    '            errorval = ""

    '            Try
    '                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
    '                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
    '                dim1 = expendcode.Substring(0, 1)
    '                dim2 = expendcode.Substring(1, 2)
    '                dim3 = expendcode.Substring(3, 3)
    '                dim4 = expendcode.Substring(6, 4)
    '                dim5 = expendcode.Substring(10, 3)
    '                dim6 = expendcode.Substring(13, 3)
    '                dim7 = expendcode.Substring(16, 4)
    '                dim8 = expendcode.Substring(20, 3)
    '                dim9 = expendcode.Substring(23, 3)
    '            Catch ex As Exception
    '                Throw
    '            End Try

    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'year has no validation
    '            '''''''''''''''''''''''''''''''''''''''''''''

    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the fund
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Select Case dim2
    '                Case "60"
    '                    'good
    '                Case Else
    '                    'error
    '                    errorval = dim2
    '                    errordescr = "Error: Fund 60 required."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the project
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim3 As String = ValidateDim3(dim3)
    '            Select Case testdim3
    '                Case "-1"
    '                    'error
    '                    errorval = dim3
    '                    errordescr = "Error: Project not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim3 = testdim3 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the function
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim4 As String = ValidateDim4(dim4)
    '            Select Case testdim4
    '                Case "-1"
    '                    'error
    '                    errorval = dim4
    '                    errordescr = "Error: Function not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim4 = testdim4 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the object
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim5 As String = ValidateEDim5(dim5)
    '            Select Case testdim5
    '                Case "-1"
    '                    'error
    '                    errorval = dim5
    '                    errordescr = "Error: Object not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim5 = testdim5 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the program
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim temp6 As Int32 = CInt(dim6)
    '            If (temp6 >= 800) And (temp6 <= 899) Then
    '                dim6 = "800"
    '            End If
    '            Dim testdim6 As String = ValidateDim6(dim6)
    '            Select Case testdim6
    '                Case "-1"
    '                    'error
    '                    errorval = dim6
    '                    errordescr = "Error: Program not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim6 = testdim6 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the subject
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim7 As String = ValidateDim7(dim7)
    '            Select Case testdim7
    '                Case "-1"
    '                    'error
    '                    errorval = dim7
    '                    errordescr = "Error: Subject not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim7 = testdim7 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the jobclass
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Dim testdim8 As String = ValidateDim8(dim8)
    '            Select Case testdim8
    '                Case "-1"
    '                    'error
    '                    errorval = dim8
    '                    errordescr = "Error: Job class not bold and cannot roll backwards."
    '                    errorphase = "1"
    '                    GoTo Errorcatch
    '                Case Else
    '                    'good
    '                    dim8 = testdim8 'get the rolled code
    '            End Select
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            'roll the site
    '            '''''''''''''''''''''''''''''''''''''''''''''
    '            Select Case dim9
    '                Case "050"

    '                Case Else
    '                    'roll to 050
    '                    dim9 = "050"
    '            End Select

    'Errorcatch:

    '            If errorphase <> "0" Then Me.HasErrors = True
    '            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
    '            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
    '            With Me.GridDetail
    '                .SetData(currow, 11, errorphase)        'phase
    '                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
    '                .SetData(currow, 13, boldcode)          'boldcode
    '                .SetData(currow, 14, errorval)          'badval 
    '                .SetData(currow, 15, errordescr)        'error descr
    '            End With
    '        Next
    '    End Function

    '    Private Function Expenditure2007_Phase2_EditCheck() As Boolean
    '        'phase 2 performs the edit checks for the dimensions used. at this
    '        'point, the codes have already been rolled to the bold.  Note: the 
    '        'phaseerror will be accessed to determine if this item should run 
    '        'thru the edit checks.  If an item failed in phase 1, then it will
    '        'be skipped in this phase.
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        '     0           1         2        3        4        5   
    '        '   bank       fisyr    docnumber   amt    count   revenuecode
    '        '     6           7         8        9       10
    '        '   descr     remarks   created    ttype -- NOT USED --
    '        '    11          12        13       14       15   
    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
    '        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9 As Int32
    '        Dim expendcode, boldcode, boldcodefmt As String
    '        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
    '        Dim currow, rowindex As Int32
    '        Dim valid As Boolean

    '        Try
    '            For currow = 0 To Me.GridDetail.Rows.Count - 1
    '                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
    '                If phaseerror <> "0" Then GoTo Skiprecord

    '                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
    '                dim1 = expendcode.Substring(0, 1)
    '                dim2 = expendcode.Substring(1, 2)
    '                dim3 = expendcode.Substring(3, 3)
    '                dim4 = expendcode.Substring(6, 4)
    '                dim5 = expendcode.Substring(10, 3)
    '                dim6 = expendcode.Substring(13, 3)
    '                dim7 = expendcode.Substring(16, 4)
    '                dim8 = expendcode.Substring(20, 3)
    '                dim9 = expendcode.Substring(23, 3)
    '                'convert to ints
    '                idim1 = CInt(dim1)
    '                idim2 = CInt(dim2)
    '                idim3 = CInt(dim3)
    '                idim4 = CInt(dim4)
    '                idim5 = CInt(dim5)
    '                idim6 = CInt(dim6)
    '                idim7 = CInt(dim7)
    '                idim8 = CInt(dim8)
    '                idim9 = CInt(dim9)

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the fund
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim2
    '                    Case 60
    '                    Case Else
    '                        valid = False
    '                        errorval = dim2
    '                        errorphase = "2"
    '                        errordescr = "Error: Fund 60 required."
    '                        GoTo Errorhandle
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the project
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim3
    '                    Case 385        'project to function validation
    '                        valid = False
    '                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
    '                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
    '                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
    '                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
    '                        If idim4 >= 5700 And idim4 <= 5799 Then valid = True
    '                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
    '                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
    '                        If idim4 >= 8900 And idim4 <= 8999 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for project 385."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 800        'fund 60 only
    '                        valid = True
    '                    Case Else       'all other projects fail
    '                        valid = False
    '                        errorval = dim3
    '                        errorphase = "2"
    '                        errordescr = "Error: Project invalid for fund 60."
    '                        GoTo Errorhandle
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the function
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim4
    '                    Case 3200
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 660 Then valid = True
    '                        If idim5 = 670 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 3200."
    '                            GoTo Errorhandle
    '                        End If

    '                    Case 5200 To 5299
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 930 Then valid = True
    '                        If idim5 = 940 Then valid = True
    '                        If idim5 = 950 Then valid = True
    '                        If idim5 = 960 Then valid = True
    '                        If idim5 = 981 Then valid = True
    '                        If idim5 = 982 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5200."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 5300 To 5399
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 290 Then valid = True
    '                        If idim5 = 960 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5300."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 5400 To 5499
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 5500 To 5599
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 5600 To 5699
    '                        If idim5 <> 930 Then
    '                            valid = False
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5600."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 5700 To 5799
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 831 Then valid = True
    '                        If idim5 = 832 Then valid = True
    '                        If idim5 = 990 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5700."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 5800 To 5899
    '                        If idim5 <> 970 Then
    '                            valid = False
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 5800."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 7400 To 7499
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 7500 To 7599
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 7600 To 7699
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 7700 To 7799
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 7800 To 7899
    '                        valid = False
    '                        errorphase = "2"
    '                        errordescr = "Error: Function invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 8100
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 890 Then valid = True
    '                        If idim5 = 930 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 8100."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 8900
    '                        valid = False
    '                        'validate the object with this function
    '                        If idim5 = 890 Then valid = True
    '                        If idim5 = 930 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Object invalid for function 8900."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the object
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim5
    '                    Case 100 To 199             'payroll objects???
    '                        If idim8 = 0 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Object requires a valid job class."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 200 To 299             'payroll objects???
    '                        If idim8 = 0 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Object requires a valid job class."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 290                    'payroll objects???
    '                        If idim4 <> 5300 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 410
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 = 2620 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 450
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
    '                        If idim4 >= 3140 Or idim4 <= 3149 Then valid = False
    '                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 511, 512, 513, 515, 516
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 = 2720 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If idim4 = 5500 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 522
    '                        If idim4 <> 2319 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 523
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 = 2620 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If idim4 = 5500 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 524
    '                        If idim4 <> 2720 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 540
    '                        valid = False
    '                        'validate the function with this object
    '                        If idim4 = 2314 Then valid = True
    '                        If idim4 = 2560 Then valid = True
    '                        If idim4 = 2571 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If idim4 = 3300 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 561, 562, 566
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Object invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 570
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Object invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 643, 644, 645
    '                        valid = False
    '                        If idim4 = 1000 Then valid = True
    '                        If idim4 = 5500 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 660, 670
    '                        If idim4 <> 3200 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 710
    '                        valid = False
    '                        If idim4 = 4200 Then valid = True
    '                        If idim4 = 4300 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 720
    '                        valid = False
    '                        If idim4 = 4600 Then valid = True
    '                        If idim4 = 4700 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 831, 920
    '                        valid = False
    '                        errorval = dim4
    '                        errorphase = "2"
    '                        errordescr = "Error: Object invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case 832
    '                        valid = False
    '                        If idim4 = 2511 Then valid = True
    '                        If idim4 = 3140 Then valid = False
    '                        If idim4 = 5100 Then valid = True
    '                        If idim4 = 5700 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If

    '                    Case 870
    '                        If idim4 <> 2518 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 880
    '                        If idim4 <= 7200 Or idim4 >= 7299 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 930
    '                        valid = False
    '                        If idim4 = 5200 Then valid = True
    '                        If idim4 = 5600 Then valid = True
    '                        If idim4 = 7400 Then valid = True
    '                        If idim4 = 8100 Then valid = True
    '                        If idim4 = 8900 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 950
    '                        If idim4 <> 5200 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 960
    '                        valid = False
    '                        If idim4 = 5200 Then valid = True
    '                        If idim4 = 5300 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 970
    '                        valid = False
    '                        If idim4 = 5400 Then valid = True
    '                        If idim4 = 5500 Then valid = True
    '                        If idim4 = 5800 Then valid = True
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 981, 982
    '                        If idim4 <> 5200 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case 990
    '                        If idim4 <> 5700 Then
    '                            valid = False
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Function invalid for this object."
    '                            GoTo Errorhandle
    '                        End If
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the program
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim6
    '                    Case 0
    '                        valid = False
    '                        errorval = dim6
    '                        errorphase = "2"
    '                        errordescr = "Error: Program invalid for fund 60."
    '                        GoTo Errorhandle
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the subject
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim7
    '                    Case 0
    '                        If idim4 = 1000 And idim7 = 0 Then valid = False
    '                        errorval = dim7
    '                        errorphase = "2"
    '                        errordescr = "Error: Subject is required for function 1000."
    '                        GoTo Errorhandle
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the jobclass
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim8
    '                    Case Else
    '                        valid = True
    '                End Select

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the site 
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim9
    '                    Case 50
    '                        valid = True
    '                    Case Else
    '                        'it should already be rolled to 050 so error if not true
    '                        errorval = dim9
    '                        errorphase = "2"
    '                        errordescr = "Error: Site invalid for fund 60."
    '                        GoTo Errorhandle
    '                End Select

    'Errorhandle:
    '                If valid = False Then
    '                    Me.HasErrors = True
    '                    With Me.GridDetail
    '                        .SetData(currow, 11, errorphase)
    '                        .SetData(currow, 14, errorval)
    '                        .SetData(currow, 15, errordescr)
    '                    End With
    '                End If
    '                'clear the vars
    '                errorphase = "0"
    '                errorval = ""
    '                errordescr = ""
    'Skiprecord:
    '            Next
    '        Catch ex As Exception
    '            Throw
    '        End Try

    '    End Function

    '    '    Private Function Revenue2007_Phase1_EditCheck() As Boolean
    '    '        'phase 1 rolls the detail codes to the bold.  if a code will not
    '    '        'roll, error values (error flag, error message) are inserted
    '    '        'into the row for later access.

    '    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '    '        '     0           1         2        3        4        5   
    '    '        '   bank       fisyr    docnumber   amt    count   revenuecode
    '    '        '     6           7         8        9       10
    '    '        '   descr     remarks   created    ttype -- NOT USED --
    '    '        '    11          12        13       14       15   
    '    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

    '    '        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
    '    '        Dim revenuecode, boldcode, boldcodefmt As String
    '    '        Dim errordescr, errorphase, errorval, prevcode As String
    '    '        Dim tamt As Double
    '    '        Dim tcount, currow, rowindex As Int32

    '    '        For currow = 0 To Me.GridDetail.Rows.Count - 1
    '    '            errordescr = ""
    '    '            errorphase = "0"
    '    '            errorval = ""
    '    '            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
    '    '            dim1 = revenuecode.Substring(0, 1)
    '    '            dim2 = revenuecode.Substring(1, 2)
    '    '            dim3 = revenuecode.Substring(3, 3)
    '    '            dim4 = revenuecode.Substring(6, 4)
    '    '            dim5 = revenuecode.Substring(10, 3)
    '    '            dim6 = revenuecode.Substring(13, 3)

    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'year has no validation
    '    '            '''''''''''''''''''''''''''''''''''''''''''''

    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the fund
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Select Case dim2
    '    '                Case "60"
    '    '                    'good
    '    '                Case Else
    '    '                    'error
    '    '                    errorval = dim2
    '    '                    errordescr = "Error: Fund 60 required."
    '    '                    errorphase = "1"
    '    '                    GoTo Errorcatch
    '    '            End Select
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the project
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Dim testdim3 As String = ValidateDim3(dim3)
    '    '            Select Case testdim3
    '    '                Case "-1"
    '    '                    'error
    '    '                    errorval = dim3
    '    '                    errordescr = "Error: Project not bold and cannot roll backwards."
    '    '                    errorphase = "1"
    '    '                    GoTo Errorcatch
    '    '                Case Else
    '    '                    'good
    '    '                    dim3 = testdim3 'get the rolled code
    '    '            End Select
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the source
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Dim testdim4 As String = ValidateDim4(dim4)
    '    '            Select Case testdim4
    '    '                Case "-1"
    '    '                    'error
    '    '                    errorval = dim4
    '    '                    errordescr = "Error: Source not bold and cannot roll backwards."
    '    '                    errorphase = "1"
    '    '                    GoTo Errorcatch
    '    '                Case Else
    '    '                    'good
    '    '                    dim4 = testdim4 'get the rolled code
    '    '            End Select
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the program
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Dim temp5 As Int32 = CInt(dim5)
    '    '            If (temp5 >= 800) And (temp5 <= 899) Then
    '    '                dim5 = "800"
    '    '            End If
    '    '            Dim testdim5 As String = ValidateRDim5(dim5)
    '    '            Select Case testdim5
    '    '                Case "-1"
    '    '                    'error
    '    '                    errorval = dim5
    '    '                    errordescr = "Error: Program not bold and cannot roll backwards."
    '    '                    errorphase = "1"
    '    '                    GoTo Errorcatch
    '    '                Case Else
    '    '                    'good
    '    '                    dim5 = testdim5 'get the rolled code
    '    '            End Select
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            'roll the site
    '    '            '''''''''''''''''''''''''''''''''''''''''''''
    '    '            Select Case dim6
    '    '                Case "050"

    '    '                Case Else
    '    '                    'roll to 050
    '    '                    dim6 = "050"
    '    '            End Select

    '    'Errorcatch:
    '    '            If errorphase <> "0" Then Me.HasErrors = True
    '    '            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
    '    '            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
    '    '            With Me.GridDetail
    '    '                .SetData(currow, 11, errorphase)        'phase
    '    '                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
    '    '                .SetData(currow, 13, boldcode)          'boldcode
    '    '                .SetData(currow, 14, errorval)          'badval 
    '    '                .SetData(currow, 15, errordescr)        'error descr
    '    '            End With
    '    '        Next
    '    '    End Function

    '    '    Private Function Revenue2007_Phase2_EditCheck() As Boolean
    '    '        'phase 2 performs the edit checks for the dimensions used. at this
    '    '        'point, the codes have already been rolled to the bold.  Note: the 
    '    '        'phaseerror will be accessed to determine if this item should run 
    '    '        'thru the edit checks.  If an item failed in phase 1, then it will
    '    '        'be skipped in this phase.
    '    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '    '        '     0           1         2        3        4        5   
    '    '        '   bank       fisyr    docnumber   amt    count   revenuecode
    '    '        '     6           7         8        9       10
    '    '        '   descr     remarks   created    ttype -- NOT USED --
    '    '        '    11          12        13       14       15   
    '    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '    '        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
    '    '        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
    '    '        Dim revenuecode, boldcode, boldcodefmt As String
    '    '        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
    '    '        Dim currow, rowindex As Int32
    '    '        Dim valid As Boolean

    '    '        Try

    '    '            For currow = 0 To Me.GridDetail.Rows.Count - 1
    '    '                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
    '    '                If phaseerror <> "0" Then GoTo Skiprecord
    '    '                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
    '    '                dim1 = revenuecode.Substring(0, 1)
    '    '                dim2 = revenuecode.Substring(1, 2)
    '    '                dim3 = revenuecode.Substring(3, 3)
    '    '                dim4 = revenuecode.Substring(6, 4)
    '    '                dim5 = revenuecode.Substring(10, 3)
    '    '                dim6 = revenuecode.Substring(13, 3)
    '    '                'convert to ints
    '    '                idim1 = CInt(dim1)
    '    '                idim2 = CInt(dim2)
    '    '                idim3 = CInt(dim3)
    '    '                idim4 = CInt(dim4)
    '    '                idim5 = CInt(dim5)
    '    '                idim6 = CInt(dim6)
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the fund
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'fund 60 requires a program code
    '    '                If idim5 < 800 Then
    '    '                    valid = False
    '    '                    errorval = dim5
    '    '                    errorphase = "2"
    '    '                    errordescr = "Error: Program invalid for fund 60."
    '    '                    GoTo Errorhandle
    '    '                End If

    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the project
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                Select Case idim3
    '    '                    Case 385        'source validation
    '    '                        valid = False
    '    '                        If idim4 = 1310 Then valid = True
    '    '                        If idim4 = 1440 Then valid = True
    '    '                        If idim4 = 1510 Then valid = True
    '    '                        If idim4 = 1550 Then valid = True
    '    '                        If idim4 = 1590 Then valid = True
    '    '                        If idim4 = 1670 Then valid = True
    '    '                        If idim4 >= 1700 And idim4 <= 1799 Then valid = True
    '    '                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
    '    '                        If idim4 = 4710 Then valid = True
    '    '                        If idim4 = 4720 Then valid = True
    '    '                        If idim4 = 4730 Then valid = True
    '    '                        If idim4 >= 5100 And idim4 <= 5199 Then valid = True
    '    '                        If idim4 = 5300 Then valid = False
    '    '                        If idim4 = 5600 Then valid = True
    '    '                        If idim4 = 5700 Then valid = True
    '    '                        If idim4 >= 6000 And idim4 <= 6200 Then valid = True
    '    '                        If Not valid Then
    '    '                            errorval = dim4
    '    '                            errorphase = "2"
    '    '                            errordescr = "Source invalid for project 385."
    '    '                            GoTo Errorhandle
    '    '                        End If
    '    '                    Case 800        'fund 60 only
    '    '                        valid = True
    '    '                    Case Else       'all other projects fail
    '    '                        valid = False
    '    '                        errorval = dim3
    '    '                        errorphase = "2"
    '    '                        errordescr = "Project invalid for fund 60."
    '    '                        GoTo Errorhandle
    '    '                End Select

    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the source
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                Select Case idim4
    '    '                    Case 1100 To 1199
    '    '                        valid = False
    '    '                        errordescr = "Source invalid for fund 60."
    '    '                    Case 1200 To 1299
    '    '                        valid = True
    '    '                    Case 1300 To 1799
    '    '                        valid = True
    '    '                    Case 1800 To 1899
    '    '                        valid = True
    '    '                    Case 1900 To 1999
    '    '                        If idim3 = 800 Then
    '    '                            errordescr = ""
    '    '                            valid = True
    '    '                        Else
    '    '                            valid = False
    '    '                            errordescr = "Source invalid for project " & dim3 & "."
    '    '                        End If
    '    '                    Case 2000 To 4999
    '    '                        valid = False
    '    '                        errordescr = "Source invalid for fund 60."
    '    '                    Case 5111, 5112, 5120, 5130, 5150, 5160, 5190
    '    '                        valid = True
    '    '                    Case 5200, 5400, 5600, 5700, 5800
    '    '                        valid = True
    '    '                    Case 5300
    '    '                        valid = False
    '    '                    Case 6110, 6121, 6122, 6130, 6140
    '    '                        valid = True
    '    '                    Case 6200
    '    '                        valid = True
    '    '                    Case Else
    '    '                        valid = False
    '    '                        errordescr = "Source invalid for fund 60."
    '    '                End Select
    '    '                If Not valid Then
    '    '                    errorval = dim4
    '    '                    errorphase = "2"
    '    '                    errordescr = "Error: " + errordescr
    '    '                    GoTo Errorhandle
    '    '                End If

    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the program
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                Select Case idim5
    '    '                    Case 800
    '    '                        valid = True
    '    '                    Case 900
    '    '                        valid = True
    '    '                    Case Else
    '    '                        valid = False
    '    '                        errorval = dim5
    '    '                        errorphase = "2"
    '    '                        errordescr = "Error: Program invalid for fund 60."
    '    '                        GoTo Errorhandle
    '    '                End Select

    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                'validate the site
    '    '                ''''''''''''''''''''''''''''''''''''''
    '    '                Select Case idim6
    '    '                    Case 50
    '    '                        valid = True
    '    '                    Case Else
    '    '                        valid = False
    '    '                        errorval = dim6
    '    '                        errorphase = "2"
    '    '                        errordescr = "Error: Site invalid for fund 60."
    '    '                        GoTo Errorhandle
    '    '                End Select

    '    'Errorhandle:
    '    '                If valid = False Then
    '    '                    Me.HasErrors = True
    '    '                    With Me.GridDetail
    '    '                        .SetData(currow, 11, errorphase)
    '    '                        .SetData(currow, 14, errorval)
    '    '                        .SetData(currow, 15, errordescr)
    '    '                    End With
    '    '                End If
    '    '                'clear the vars
    '    '                errorphase = "0"
    '    '                errorval = ""
    '    '                errordescr = ""
    '    'Skiprecord:
    '    '            Next
    '    '        Catch ex As Exception
    '    '            Throw
    '    '        End Try

    '    '    End Function

#End Region

#Region "  Methods 2008 Edit Checks "

    Private Function Expenditure2008_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim9
                Case "050"

                Case Else
                    'roll to 050
                    dim9 = "050"
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Expenditure2008_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9 As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5700 And idim4 <= 5799 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If idim5 = 731 And idim7 = 0 Then valid = False
                        If idim5 = 732 And idim7 = 0 Then valid = False
                        If idim5 = 733 And idim7 = 0 Then valid = False
                        If idim5 = 734 And idim7 = 0 Then valid = False
                        If idim5 = 735 And idim7 = 0 Then valid = False
                        If idim5 = 736 And idim7 = 0 Then valid = False
                        If idim5 = 739 And idim7 = 0 Then valid = False

                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If
                    Case 2135
                        valid = False
                        'validate the object with this function
                        If idim6 = 800 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 3100 To 3199
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 3200
                        valid = False
                        'validate the object with this function
                        If idim5 = 660 Then valid = True
                        If idim5 = 670 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 3200."
                            GoTo Errorhandle
                        End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 940 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If
                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If
                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 5600 To 5699
                        If idim5 <> 930 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If
                    Case 5700 To 5799
                        valid = False
                        'validate the object with this function
                        If idim5 = 990 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5700."
                            GoTo Errorhandle
                        End If
                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If
                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7000 To 7099
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7100 To 7199
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle
                    Case 7200 To 7299
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7300 To 7399
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7400 To 7499
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7500 To 7599
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7600 To 7699
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7700 To 7799
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7800 To 7899
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8100."
                            GoTo Errorhandle
                        End If
                    Case 8900
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 199             'payroll objects???
                        If idim8 = 0 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object requires a valid job class."
                            GoTo Errorhandle
                        End If
                    Case 200 To 299             'payroll objects???
                        If idim8 = 0 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object requires a valid job class."
                            GoTo Errorhandle
                        End If
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        'If idim4 = 2237 Then valid = True
                        If idim4 = 3180 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3140 Or idim4 <= 3149 Then valid = False
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        If idim4 <> 2319 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 561, 562, 566
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 643, 644, 645
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 710
                        valid = False
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 720
                        valid = False
                        If idim4 = 4600 Then valid = True
                        If idim4 = 4700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 831, 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 832
                        valid = False
                        If idim4 = 2511 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5100 Then valid = True
                        If idim4 = 5700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 870
                        If idim4 <> 2518 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If
                    Case 880
                        If idim4 <= 7200 Or idim4 >= 7299 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 930
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 = 5900 Then valid = True
                        If idim4 = 7400 Then valid = False
                        If idim4 = 8100 Then valid = True
                        If idim4 = 8900 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 970
                        valid = False
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 981, 982
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 990
                        If idim4 <> 5700 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim4 = 1000 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 900 invalid for func 1000."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        'If idim4 = 1000 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 1 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 112 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim9
                    Case 50
                        valid = True
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        errorval = dim9
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2008_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            Else
                dim5 = "900"
            End If

            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim6
                Case "050"

                Case Else
                    'roll to 050
                    dim6 = "050"
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2008_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                If idim5 < 800 Then
                    valid = False
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Program invalid for fund 60."
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 385        'source validation
                        valid = False
                        If idim4 = 1310 Then valid = True
                        If idim4 = 1440 Then valid = True
                        If idim4 = 1510 Then valid = True
                        If idim4 = 1550 Then valid = True
                        If idim4 = 1590 Then valid = True
                        If idim4 = 1670 Then valid = True
                        If idim4 >= 1700 And idim4 <= 1799 Then valid = True
                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                        If idim4 = 4710 Then valid = True
                        If idim4 = 4720 Then valid = True
                        If idim4 = 4730 Then valid = True
                        If idim4 >= 5100 And idim4 <= 5199 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 = 5700 Then valid = False
                        If idim4 >= 6000 And idim4 <= 6200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Source invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800        'fund 60 only
                        valid = True
                    Case Else       'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the source
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1100 To 1199
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 1200 To 1299
                        valid = True
                    Case 1300 To 1799
                        valid = True
                    Case 1800 To 1899
                        valid = True
                    Case 1900 To 1999
                        If idim3 = 800 Then
                            errordescr = ""
                            valid = True
                        Else
                            valid = False
                            errordescr = "Source invalid for project " & dim3 & "."
                        End If
                    Case 2000 To 4999
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5111, 5112, 5120, 5130, 5150, 5160, 5190
                        valid = True
                    Case 5200
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5300
                        valid = True
                    Case 5400, 5600, 5800
                        valid = True
                    Case 6110, 6130, 6140
                        valid = True
                    Case 6200
                        valid = True
                    Case Else
                        valid = False
                        errordescr = "Source invalid for fund 60."
                End Select
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: " + errordescr
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 800
                        valid = True
                    Case 900
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the site
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 50
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function
#End Region

#Region "  Methods 2009 Edit Checks "

    Private Function Expenditure2009_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim9
                Case "050"

                Case Else
                    'roll to 050
                    dim9 = "050"
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Expenditure2009_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9 As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5700 And idim4 <= 5799 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If idim5 = 731 And idim7 = 0 Then valid = False
                        If idim5 = 732 And idim7 = 0 Then valid = False
                        If idim5 = 733 And idim7 = 0 Then valid = False
                        If idim5 = 734 And idim7 = 0 Then valid = False
                        If idim5 = 735 And idim7 = 0 Then valid = False
                        If idim5 = 736 And idim7 = 0 Then valid = False
                        If idim5 = 739 And idim7 = 0 Then valid = False

                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If
                    Case 2135
                        valid = False
                        'validate the object with this function
                        If idim6 = 800 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 3100 To 3199
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 3200
                        valid = False
                        'validate the object with this function
                        If idim5 = 660 Then valid = True
                        If idim5 = 670 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 3200."
                            GoTo Errorhandle
                        End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 940 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If
                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If
                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 5600 To 5699
                        If idim5 <> 930 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If
                    Case 5700 To 5799
                        valid = False
                        'validate the object with this function
                        If idim5 = 990 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5700."
                            GoTo Errorhandle
                        End If
                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If
                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7000 To 7099
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7100 To 7199
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle
                    Case 7200 To 7299
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7300 To 7399
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7400 To 7499
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7500 To 7599
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7600 To 7699
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7700 To 7799
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 7800 To 7899
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8100."
                            GoTo Errorhandle
                        End If
                    Case 8900
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 199             'payroll objects???
                        If idim8 = 0 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object requires a valid job class."
                            GoTo Errorhandle
                        End If
                    Case 200 To 299             'payroll objects???
                        If idim8 = 0 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object requires a valid job class."
                            GoTo Errorhandle
                        End If
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        'If idim4 = 2237 Then valid = True
                        If idim4 = 3180 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3140 Or idim4 <= 3149 Then valid = False
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        If idim4 <> 2319 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 561, 562, 566
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 643, 644, 645
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 710
                        valid = False
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 720
                        valid = False
                        If idim4 = 4600 Then valid = True
                        If idim4 = 4700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 831, 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 832
                        valid = False
                        If idim4 = 2511 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5100 Then valid = True
                        If idim4 = 5700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 870
                        If idim4 <> 2518 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If
                    Case 880
                        If idim4 <= 7200 Or idim4 >= 7299 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 930
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 = 5900 Then valid = True
                        If idim4 = 7400 Then valid = False
                        If idim4 = 8100 Then valid = True
                        If idim4 = 8900 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 970
                        valid = False
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 981, 982
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 990
                        If idim4 <> 5700 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim4 = 1000 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 900 invalid for func 1000."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        'If idim4 = 1000 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 1 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 112 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim9
                    Case 50
                        valid = True
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        errorval = dim9
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2009_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            Else
                dim5 = "900"
            End If

            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim6
                Case "050"

                Case Else
                    'roll to 050
                    dim6 = "050"
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2009_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                If idim5 < 800 Then
                    valid = False
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Program invalid for fund 60."
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 385        'source validation
                        valid = False
                        If idim4 = 1310 Then valid = True
                        If idim4 = 1440 Then valid = True
                        If idim4 = 1510 Then valid = True
                        If idim4 = 1550 Then valid = True
                        If idim4 = 1590 Then valid = True
                        If idim4 = 1670 Then valid = True
                        If idim4 >= 1700 And idim4 <= 1799 Then valid = True
                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                        If idim4 = 4710 Then valid = True
                        If idim4 = 4720 Then valid = True
                        If idim4 = 4730 Then valid = True
                        If idim4 >= 5100 And idim4 <= 5199 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 = 5700 Then valid = False
                        If idim4 >= 6000 And idim4 <= 6200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Source invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800        'fund 60 only
                        valid = True
                    Case Else       'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the source
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1100 To 1199
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 1200 To 1299
                        valid = True
                    Case 1300 To 1799
                        valid = True
                    Case 1800 To 1899
                        valid = True
                    Case 1900 To 1999
                        If idim3 = 800 Then
                            errordescr = ""
                            valid = True
                        Else
                            valid = False
                            errordescr = "Source invalid for project " & dim3 & "."
                        End If
                    Case 2000 To 4999
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5111, 5112, 5120, 5130, 5150, 5160, 5190
                        valid = True
                    Case 5200
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5300
                        valid = True
                    Case 5400, 5600, 5800
                        valid = True
                    Case 6110, 6130, 6140
                        valid = True
                    Case 6200
                        valid = True
                    Case Else
                        valid = False
                        errordescr = "Source invalid for fund 60."
                End Select
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: " + errordescr
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 800
                        valid = True
                    Case 900
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the site
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 50
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

#End Region

#Region "  Methods 2010 Edit Checks "

    Private Function Expenditure2010_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Expenditure2010_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5700 And idim4 <= 5799 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If idim5 = 731 And idim7 = 0 Then valid = False
                        If idim5 = 732 And idim7 = 0 Then valid = False
                        If idim5 = 733 And idim7 = 0 Then valid = False
                        If idim5 = 734 And idim7 = 0 Then valid = False
                        If idim5 = 735 And idim7 = 0 Then valid = False
                        If idim5 = 736 And idim7 = 0 Then valid = False
                        If idim5 = 739 And idim7 = 0 Then valid = False

                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If

                    Case 1500
                        valid = False
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2120
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function
                        If idim6 = 800 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 2140
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: ."
                            GoTo Errorhandle
                        End If

                    Case 2152 To 2153
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: ."
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2220
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2410
                        valid = True
                        If idim6 = 100 Then valid = False
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 or program 100 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2490
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 3100 To 3199
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 3200
                        valid = False
                        'validate the object with this function
                        If idim5 = 660 Then valid = True
                        If idim5 = 670 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 3200."
                            GoTo Errorhandle
                        End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 970 Then valid = False
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If

                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If

                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5600 To 5699
                        If idim5 = 930 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If

                    Case 5700 To 5799
                        valid = False
                        'validate the object with this function
                        If idim5 = 990 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5700."
                            GoTo Errorhandle
                        End If

                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If

                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7000 To 7099
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7100 To 7199
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle

                    Case 7200 To 7299
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7300 To 7399
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle

                    Case 7400 To 7499
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7500 To 7599
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7600 To 7699
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7700 To 7799
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7800 To 7899
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8100."
                            GoTo Errorhandle
                        End If

                    Case 8900
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 199             'payroll objects???
                        If idim8 = 0 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object requires a valid job class."
                            GoTo Errorhandle
                        End If
                    Case 200 To 299             'payroll objects???
                        If idim8 = 0 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object requires a valid job class."
                            GoTo Errorhandle
                        End If
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3140 Or idim4 <= 3149 Then valid = False
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        If idim4 <> 2319 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 561, 562, 566
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 641, 643, 644, 645
                        valid = False
                        If idim4 <> 1000 And dim9 = "050" Then valid = True
                        If idim4 = 1000 And dim9 <> "050" Then valid = True
                        If idim4 = 2120 And dim9 <> "050" Then valid = True
                        If idim4 = 2220 And dim9 <> "050" Then valid = True
                        If dim9 <> "050" Then valid = True
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site invalid for this Function/Object."
                            GoTo Errorhandle
                        End If
                    Case 643, 644, 645
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 710
                        valid = False
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 720
                        valid = False
                        If idim4 = 4600 Then valid = True
                        If idim4 = 4700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 831, 832
                        valid = False
                        If idim4 = 2511 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5100 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 833
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 870
                        If idim4 <> 2518 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If
                    Case 880
                        If idim4 <= 7200 Or idim4 >= 7299 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 930
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 = 5900 Then valid = True
                        If idim4 = 7400 Then valid = False
                        If idim4 = 8100 Then valid = True
                        If idim4 = 8900 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 970
                        valid = False
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 981, 982
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 990
                        If idim4 <> 5700 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim4 = 1000 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 900 invalid for func 1000."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

                Select Case idim9
                    Case 50
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site not valid for School."
                            GoTo Errorhandle
                        End If
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2010_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            Else
                dim5 = "900"
            End If

            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If

            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2010_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                If idim5 < 800 Then
                    valid = False
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Program invalid for fund 60."
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 385        'source validation
                        valid = False
                        If idim4 = 1310 Then valid = True
                        If idim4 = 1320 Then valid = True
                        If idim4 = 1440 Then valid = True
                        If idim4 = 1510 Then valid = True
                        If idim4 = 1530 Then valid = True
                        If idim4 = 1550 Then valid = True
                        If idim4 = 1590 Then valid = True
                        If idim4 = 1670 Then valid = True
                        If idim4 = 1680 Then valid = False
                        If idim4 >= 1700 And idim4 <= 1799 Then valid = True
                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                        If idim4 = 4710 Then valid = True
                        If idim4 = 4720 Then valid = True
                        If idim4 = 4730 Then valid = True
                        If idim4 >= 5100 And idim4 <= 5199 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 >= 6000 And idim4 <= 6200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Source invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800        'fund 60 only
                        valid = True
                    Case Else       'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the source
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1100 To 1199
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 1200 To 1299
                        valid = True
                    Case 1300 To 1799
                        valid = True
                    Case 1800 To 1899
                        valid = True
                    Case 1900 To 1999
                        If idim3 = 800 Then
                            errordescr = ""
                            valid = True
                        Else
                            valid = False
                            errordescr = "Source invalid for project " & dim3 & "."
                        End If
                    Case 2000 To 4999
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5111, 5112, 5120, 5130, 5150, 5160, 5190
                        valid = True
                    Case 5200
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5300
                        valid = True
                    Case 5400, 5600, 5800
                        valid = True
                    Case 6110, 6130, 6140
                        valid = True
                    Case 6200
                        valid = True
                    Case Else
                        valid = False
                        errordescr = "Source invalid for fund 60."
                End Select
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: " + errordescr
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 800
                        valid = True
                    Case 900
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the site
                ''''''''''''''''''''''''''''''''''''''

                Dim mysite As String = Me.DistrictId
                Dim myopunit As Char
                myopunit = GetChar(mysite, 1)

                Select Case idim6
                    Case idim6
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

#End Region

#Region "  Methods 2011 Edit Checks "

    Private Function Expenditure2011_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Expenditure2011_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5700 And idim4 <= 5799 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If

                    Case 1500
                        valid = False
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2120
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function
                        If idim6 = 800 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 2140
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Programs 239 & 430 & 497."
                            GoTo Errorhandle
                        End If

                    Case 2152 To 2153
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2220
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2410
                        valid = True
                        If idim6 = 100 Then valid = False
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 or program 100 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2490
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 3100 To 3199
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 3200
                        valid = False
                        'validate the object with this function
                        If idim5 = 660 Then valid = True
                        If idim5 = 670 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 3200."
                            GoTo Errorhandle
                        End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 970 Then valid = False
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If

                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If

                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5600 To 5699
                        If idim5 = 930 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If

                    Case 5700 To 5799
                        valid = False
                        'validate the object with this function
                        If idim5 = 990 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5700."
                            GoTo Errorhandle
                        End If

                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If

                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7000 To 7099
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7100 To 7199
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle

                    Case 7200 To 7299
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7300 To 7399
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle

                    Case 7400 To 7499
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7500 To 7599
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7600 To 7699
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7700 To 7799
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7800 To 7899
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8100."
                            GoTo Errorhandle
                        End If

                    Case 8900
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 299             'payroll objects???
                        'If idim8 = 0 Then
                        valid = True
                        errorval = dim4
                        errorphase = "4"
                        errordescr = "Warning: Obj may not be valid for fd 60."
                        GoTo Errorhandle
                        'End If
                        'Case 200 To 299             'payroll objects???
                        'If idim8 = 0 Then
                        'valid = True
                        'errorval = dim4
                        'errorphase = "4"
                        'errordescr = "Warning: Obj may not be valid for fd 60."
                        'GoTo Errorhandle
                        ' End If
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3140 Or idim4 <= 3149 Then valid = False
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        If idim4 <> 2319 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 561, 562, 566
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 630
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 641, 643, 644, 645
                        valid = False
                        If idim4 <> 1000 And dim9 = "050" Then valid = True
                        If idim4 = 1000 And dim9 <> "050" Then valid = True
                        If idim4 = 2120 And dim9 <> "050" Then valid = True
                        If idim4 = 2220 And dim9 <> "050" Then valid = True
                        If dim9 <> "050" Then valid = True
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site invalid for this Function/Object."
                            GoTo Errorhandle
                        End If
                    Case 643, 644, 645
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 710
                        valid = False
                        If idim4 = 2630 Then valid = True
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 720
                        valid = False
                        If idim4 = 2620 Then valid = True
                        If idim4 = 4600 Then valid = True
                        If idim4 = 4700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 831, 832
                        valid = False
                        If idim4 = 2511 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5100 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 833
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 870
                        If idim4 <> 2518 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If
                    Case 880
                        If idim4 <= 7200 Or idim4 >= 7299 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 930
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 = 5900 Then valid = True
                        If idim4 = 7400 Then valid = False
                        If idim4 = 8100 Then valid = True
                        If idim4 = 8900 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 970
                        valid = False
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 981, 982
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 990
                        If idim4 <> 5700 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim4 = 1000 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 900 invalid for func 1000."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                        'valid = False
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

                Select Case idim9
                    Case 50
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site not valid for School."
                            GoTo Errorhandle
                        End If
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                'added this part to handle the warning on objects 100-299
                ' errorphase = "4" pec 04-26-11

                If errorphase = "4" Then
                    valid = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                Else
                    If valid = False Then
                        Me.HasErrors = True
                        With Me.GridDetail
                            .SetData(currow, 11, errorphase)
                            .SetData(currow, 14, errorval)
                            .SetData(currow, 15, errordescr)
                        End With
                    End If
                End If

                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2011_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            Else
                dim5 = "900"
            End If

            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If

            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2011_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                If idim5 < 800 Then
                    valid = False
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Program invalid for fund 60."
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 385        'source validation
                        valid = False
                        If idim4 = 1310 Then valid = True
                        If idim4 = 1320 Then valid = True
                        If idim4 = 1440 Then valid = True
                        If idim4 = 1510 Then valid = True
                        If idim4 = 1530 Then valid = True
                        If idim4 = 1550 Then valid = True
                        If idim4 = 1590 Then valid = True
                        If idim4 = 1670 Then valid = True
                        If idim4 = 1680 Then valid = False
                        If idim4 >= 1700 And idim4 <= 1799 Then valid = True
                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                        If idim4 = 4710 Then valid = True
                        If idim4 = 4720 Then valid = True
                        If idim4 = 4730 Then valid = True
                        If idim4 >= 5100 And idim4 <= 5199 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 >= 6000 And idim4 <= 6200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Source invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800        'fund 60 only
                        valid = True
                    Case Else       'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the source
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1100 To 1199
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 1200 To 1299
                        valid = True
                    Case 1300 To 1799
                        valid = True
                    Case 1800 To 1899
                        valid = True
                    Case 1900 To 1999
                        If idim3 = 800 Then
                            errordescr = ""
                            valid = True
                        Else
                            valid = False
                            errordescr = "Source invalid for project " & dim3 & "."
                        End If
                    Case 2000 To 4999
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5111, 5112, 5120, 5130, 5150, 5160, 5190
                        valid = True
                    Case 5200
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5300
                        valid = True
                    Case 5400, 5600, 5800
                        valid = True
                    Case 6110, 6130, 6140
                        valid = True
                    Case 6200
                        valid = True
                    Case Else
                        valid = False
                        errordescr = "Source invalid for fund 60."
                End Select
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: " + errordescr
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 800
                        valid = True
                    Case 900
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the site
                ''''''''''''''''''''''''''''''''''''''

                Dim mysite As String = Me.DistrictId
                Dim myopunit As Char
                myopunit = GetChar(mysite, 1)

                Select Case idim6
                    Case idim6
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

#End Region

#Region "  Methods 2012 Edit Checks "

    Private Function Expenditure2012_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 700) And (temp6 <= 799) Then
                dim6 = "700"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Expenditure2012_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298               'fund 60 only
                        valid = False
                        If idim6 >= 700 And idim6 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for proj 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 3200 And idim4 <= 3299 Then valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5700 And idim4 <= 5799 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 421 To 791             'fund 60 only not valid
                        valid = False
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If

                    Case 1500
                        valid = False
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2120
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function
                        If idim6 = 800 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 2140
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Programs 239 & 430."
                            GoTo Errorhandle
                        End If

                    Case 2152
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If
                    Case 2153
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2220
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2410
                        valid = True
                        If idim6 = 100 Then valid = False
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 or program 100 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2490
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 3100 To 3199
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 3200
                        valid = False
                        'validate the object with this function
                        If idim5 = 660 Then valid = True
                        If idim5 = 670 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 3200."
                            GoTo Errorhandle
                        End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 970 Then valid = False
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If

                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If

                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5600 To 5699
                        If idim5 = 930 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If

                    Case 5700 To 5799
                        valid = False
                        'validate the object with this function
                        If idim5 = 990 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5700."
                            GoTo Errorhandle
                        End If

                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If

                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7000 To 7099
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7100 To 7199
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle

                    Case 7200 To 7299
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7300 To 7399
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle

                    Case 7400 To 7499
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7500 To 7599
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7600 To 7699
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7700 To 7799
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7800 To 7899
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8100."
                            GoTo Errorhandle
                        End If

                    Case 8900
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 299             'payroll objects???
                        valid = True
                        errorval = dim4
                        errorphase = "4"
                        errordescr = "Warning: Obj may not be valid for fd 60."
                        GoTo Errorhandle
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = False
                        If idim4 = 5500 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3140 Or idim4 <= 3149 Then valid = False
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        If idim4 <> 2319 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 561, 562, 566
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 630
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 641, 643, 644, 645
                        valid = False
                        If idim4 <> 1000 And dim9 = "050" Then valid = True
                        If idim4 = 1000 And dim9 <> "050" Then valid = True
                        If idim4 = 2120 And dim9 <> "050" Then valid = True
                        If idim4 = 2220 And dim9 <> "050" Then valid = True
                        If dim9 <> "050" Then valid = True
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site invalid for this Function/Object."
                            GoTo Errorhandle
                        End If
                    Case 643, 644, 645
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 710
                        valid = False
                        If idim4 = 2630 Then valid = True
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 720
                        valid = False
                        If idim4 = 2620 Then valid = True
                        If idim4 = 4600 Then valid = True
                        If idim4 = 4700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 831, 832
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle
                    Case 833
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 870
                        If idim4 <> 2518 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If
                    Case 880
                        If idim4 <= 7200 Or idim4 >= 7299 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 930
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 = 5900 Then valid = True
                        If idim4 = 7400 Then valid = False
                        If idim4 = 8100 Then valid = True
                        If idim4 = 8900 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 970
                        valid = False
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 981, 982
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 990
                        If idim4 <> 5700 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 = 800 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 700 valid with proj 000-298, 385 & 800."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = False
                        If idim3 = 385 Then valid = False
                        If idim4 = 1000 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program 900 invalid."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 1060
                        valid = False
                        If idim6 = 239 Then valid = True
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: subject not valid for fund 60."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                        'valid = False
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

                Select Case idim9
                    Case 50
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site not valid for School."
                            GoTo Errorhandle
                        End If
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                'added this part to handle the warning on objects 100-299
                ' errorphase = "4" pec 04-26-11

                If errorphase = "4" Then
                    valid = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                Else
                    If valid = False Then
                        Me.HasErrors = True
                        With Me.GridDetail
                            .SetData(currow, 11, errorphase)
                            .SetData(currow, 14, errorval)
                            .SetData(currow, 15, errordescr)
                        End With
                    End If
                End If

                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2012_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 700) And (temp5 <= 799) Then
                dim5 = "700"
            End If
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            End If
            If (temp5 >= 900) And (temp5 <= 999) Then
                dim5 = "900"
            End If
            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010
                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2012_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                If idim5 < 700 Then
                    valid = False
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Program invalid for fund 60."
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298      'fund 60 project 000 to 298 school assgined for child nur.
                        valid = False
                        If idim5 >= 700 And idim5 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Prog invalid for project 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'source validation
                        valid = False
                        If idim4 = 1310 Then valid = True
                        If idim4 = 1320 Then valid = True
                        If idim4 = 1440 Then valid = True
                        If idim4 = 1510 Then valid = True
                        If idim4 = 1530 Then valid = True
                        If idim4 = 1550 Then valid = True
                        If idim4 = 1590 Then valid = True
                        If idim4 = 1670 Then valid = True
                        If idim4 = 1680 Then valid = True
                        If idim4 >= 1700 And idim4 <= 1799 Then valid = False
                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                        If idim4 = 4710 Then valid = True
                        If idim4 = 4720 Then valid = True
                        If idim4 = 4730 Then valid = True
                        If idim4 = 4740 Then valid = True
                        If idim4 = 4750 Then valid = True
                        If idim4 >= 5100 And idim4 <= 5199 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 >= 6000 And idim4 <= 6200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Source invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800        'fund 60 only
                        valid = True
                    Case Else       'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the source
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1100 To 1199
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 1200 To 1299
                        valid = True
                    Case 1300 To 1799
                        valid = True
                    Case 1800 To 1899
                        valid = True
                    Case 1900 To 1999
                        If idim3 = 800 Then
                            errordescr = ""
                            valid = True
                        Else
                            valid = False
                            errordescr = "Source invalid for project " & dim3 & "."
                        End If
                    Case 2000 To 4999
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5111, 5112, 5120, 5130, 5150, 5160, 5190
                        valid = True
                    Case 5200
                        'errordescr = "Source valid for zero amount."
                        valid = True
                    Case 5300
                        valid = True
                    Case 5400, 5600, 5800
                        valid = True
                    Case 6110, 6130, 6140
                        valid = True
                    Case 6200
                        valid = True
                    Case Else
                        valid = False
                        errordescr = "Source invalid for fund 60."
                End Select
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: " + errordescr
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 = 800 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program valid for proj 000-298,385 & 800."
                            GoTo Errorhandle
                        End If
                    Case 800
                        valid = True
                    Case 900
                        valid = False
                        If idim3 <> 385 Then valid = True
                        If idim3 >= 0 And idim3 <= 298 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program invalid for proj 000-298 & 385."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the site
                ''''''''''''''''''''''''''''''''''''''

                Dim mysite As String = Me.DistrictId
                Dim myopunit As Char
                myopunit = GetChar(mysite, 1)

                Select Case idim6
                    Case idim6
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

#End Region

#Region "  Methods 2013 Edit Checks "

    Private Function Expenditure2013_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 700) And (temp6 <= 799) Then
                dim6 = "700"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Expenditure2013_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298               'fund 60 only
                        valid = False
                        If idim6 >= 700 And idim6 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for proj 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 3200 And idim4 <= 3299 Then valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5700 And idim4 <= 5799 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 421 To 791             'fund 60 only not valid
                        valid = False
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If

                    Case 1500
                        valid = False
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2120
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function
                        If idim6 = 800 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 2140
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Programs 239 & 430."
                            GoTo Errorhandle
                        End If

                    Case 2152
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If
                    Case 2153
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2220
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2410
                        valid = True
                        If idim6 = 100 Then valid = False
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 or program 100 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2490
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 3100 To 3199
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle
                        ''' changed 05-22-13 state took edit check off function 3200
                        '''Case 3200
                        '''    valid = False
                        '''    'validate the object with this function
                        '''    If idim5 = 660 Then valid = True
                        '''    If idim5 = 670 Then valid = True
                        '''    If Not valid Then
                        '''        errorval = dim5
                        '''        errorphase = "2"
                        '''        errordescr = "Error: Object invalid for function 3200."
                        '''        GoTo Errorhandle
                        '''    End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 970 Then valid = False
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If

                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If

                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5600 To 5699
                        If idim5 = 930 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If

                    Case 5700 To 5799
                        valid = False
                        'validate the object with this function
                        If idim5 = 990 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5700."
                            GoTo Errorhandle
                        End If

                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If

                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7000 To 7099
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7100 To 7199
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle

                    Case 7200 To 7299
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7300 To 7399
                        valid = True
                        'errorphase = "2"
                        'errordescr = "Error: Function invalid for fund 60."
                        'GoTo Errorhandle

                    Case 7400 To 7499
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7500 To 7599
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7600 To 7699
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7700 To 7799
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7800 To 7899
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8100."
                            GoTo Errorhandle
                        End If

                    Case 8900
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 299             'payroll objects???
                        valid = True
                        errorval = dim4
                        errorphase = "4"
                        errordescr = "Warning: Obj may not be valid for fd 60."
                        GoTo Errorhandle
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = False
                        If idim4 = 5500 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3140 Or idim4 <= 3149 Then valid = False
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        If idim4 <> 2319 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 561, 562, 566
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 630
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 641, 643, 644, 645
                        valid = False
                        If idim4 <> 1000 And dim9 = "050" Then valid = True
                        If idim4 = 1000 And dim9 <> "050" Then valid = True
                        If idim4 = 2120 And dim9 <> "050" Then valid = True
                        If idim4 = 2220 And dim9 <> "050" Then valid = True
                        If dim9 <> "050" Then valid = True
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site invalid for this Function/Object."
                            GoTo Errorhandle
                        End If
                    Case 643, 644, 645
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 710
                        valid = False
                        If idim4 = 2630 Then valid = True
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 720
                        valid = False
                        If idim4 = 2620 Then valid = True
                        If idim4 = 4600 Then valid = True
                        If idim4 = 4700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 831, 832
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle
                    Case 833
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 870
                        If idim4 <> 2518 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If
                    Case 880
                        If idim4 <= 7200 Or idim4 >= 7299 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 930
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 = 5900 Then valid = True
                        If idim4 = 7400 Then valid = False
                        If idim4 = 8100 Then valid = True
                        If idim4 = 8900 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 970
                        valid = False
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 981, 982
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 990
                        If idim4 <> 5700 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 = 800 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 700 valid with proj 000-298, 385 & 800."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = False
                        If idim3 = 385 Then valid = False
                        If idim4 = 1000 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program 900 invalid."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 1060
                        valid = False
                        If idim6 = 239 Then valid = True
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: subject not valid for fund 60."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                        'valid = False
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

                Select Case idim9
                    Case 50
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site not valid for School."
                            GoTo Errorhandle
                        End If
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                'added this part to handle the warning on objects 100-299
                ' errorphase = "4" pec 04-26-11

                If errorphase = "4" Then
                    valid = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                Else
                    If valid = False Then
                        Me.HasErrors = True
                        With Me.GridDetail
                            .SetData(currow, 11, errorphase)
                            .SetData(currow, 14, errorval)
                            .SetData(currow, 15, errordescr)
                        End With
                    End If
                End If

                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2013_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 700) And (temp5 <= 799) Then
                dim5 = "700"
            End If
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            End If
            If (temp5 >= 900) And (temp5 <= 999) Then
                dim5 = "900"
            End If
            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010
                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2013_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                If idim5 < 700 Then
                    valid = False
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Program invalid for fund 60."
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298      'fund 60 project 000 to 298 school assgined for child nur.
                        valid = False
                        If idim5 >= 700 And idim5 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Prog invalid for project 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'source validation
                        valid = False
                        If idim4 = 1310 Then valid = True
                        If idim4 = 1320 Then valid = True
                        If idim4 = 1440 Then valid = True
                        If idim4 = 1510 Then valid = True
                        If idim4 = 1530 Then valid = True
                        If idim4 = 1550 Then valid = True
                        If idim4 = 1590 Then valid = True
                        If idim4 = 1670 Then valid = True
                        If idim4 = 1680 Then valid = True
                        If idim4 >= 1700 And idim4 <= 1799 Then valid = False
                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                        If idim4 = 4710 Then valid = True
                        If idim4 = 4720 Then valid = True
                        If idim4 = 4730 Then valid = True
                        If idim4 = 4740 Then valid = True
                        If idim4 = 4750 Then valid = True
                        If idim4 >= 5100 And idim4 <= 5199 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If idim4 >= 6000 And idim4 <= 6200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Source invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800        'fund 60 only
                        valid = True
                    Case Else       'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the source
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1100 To 1199
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 1200 To 1299
                        valid = True
                    Case 1300 To 1799
                        valid = True
                    Case 1800 To 1899
                        valid = True
                    Case 1900 To 1999
                        If idim3 = 800 Then
                            errordescr = ""
                            valid = True
                        Else
                            valid = False
                            errordescr = "Source invalid for project " & dim3 & "."
                        End If
                    Case 2000 To 4999
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5111, 5112, 5120, 5130, 5150, 5160, 5190
                        valid = True
                    Case 5200
                        'errordescr = "Source valid for zero amount."
                        valid = True
                    Case 5300
                        valid = True
                    Case 5400, 5600, 5800
                        valid = True
                    Case 6110, 6130, 6140
                        valid = True
                    Case 6200
                        valid = True
                    Case Else
                        valid = False
                        errordescr = "Source invalid for fund 60."
                End Select
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: " + errordescr
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 = 800 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program valid for proj 000-298,385 & 800."
                            GoTo Errorhandle
                        End If
                    Case 800
                        valid = True
                    Case 900
                        valid = False
                        If idim3 <> 385 Then valid = True
                        If idim3 >= 0 And idim3 <= 298 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program invalid for proj 000-298 & 385."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the site
                ''''''''''''''''''''''''''''''''''''''

                Dim mysite As String = Me.DistrictId
                Dim myopunit As Char
                myopunit = GetChar(mysite, 1)

                Select Case idim6
                    Case idim6
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

#End Region

#Region "  Methods 2014 Edit Checks "

    Private Function Expenditure2014_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 700) And (temp6 <= 799) Then
                dim6 = "700"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Expenditure2014_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298               'fund 60 only
                        valid = False
                        If idim6 >= 700 And idim6 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for proj 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 3200 And idim4 <= 3299 Then valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 421 To 791             'fund 60 only not valid
                        valid = False
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If

                    Case 1500
                        valid = False
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2120
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function
                        If idim6 = 800 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 2140
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Programs 239 & 430."
                            GoTo Errorhandle
                        End If

                    Case 2152
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If
                    Case 2153
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2220
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2410
                        valid = True
                        If idim6 = 100 Then valid = False
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 or program 100 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2490
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                        'Case 3100 To 3199
                        '    valid = False
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Function invalid for fund 60."
                        ''    GoTo Errorhandle
                        ''' changed 05-22-13 state took edit check off function 3200
                        '''Case 3200
                        '''    valid = False
                        '''    'validate the object with this function
                        '''    If idim5 = 660 Then valid = True
                        '''    If idim5 = 670 Then valid = True
                        '''    If Not valid Then
                        '''        errorval = dim5
                        '''        errorphase = "2"
                        '''        errordescr = "Error: Object invalid for function 3200."
                        '''        GoTo Errorhandle
                        '''    End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 970 Then valid = True
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If

                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If

                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5600 To 5699
                        If idim5 = 930 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If

                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If

                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7000 To 7099
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7100 To 7199
                        If idim5 = 682 Then valid = True
                        If idim5 = 880 Then valid = True
                        If idim5 = 890 Then valid = True
                        errorphase = "2"
                        errordescr = "Error: Function can only use obj 682,880,890."
                        GoTo Errorhandle

                    Case 7200 To 7299
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7300 To 7399
                        If idim5 = 682 Then valid = True
                        errorphase = "2"
                        errordescr = "Error: Function can only use obj 682."
                        GoTo Errorhandle

                    Case 7400 To 7499
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7500 To 7599
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7600 To 7699
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7700 To 7799
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7800 To 7899
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8100."
                            GoTo Errorhandle
                        End If

                    Case 8900
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 299             'payroll objects???
                        valid = True
                        errorval = dim4
                        errorphase = "4"
                        errordescr = "Warning: Obj may not be valid for fd 60."
                        GoTo Errorhandle
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = False
                        If idim4 = 5500 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3190 Or idim4 <= 3199 Then valid = False
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        If idim4 <> 2319 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 3160 Then valid = False
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 561, 562, 566
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 580
                        valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object invalid for fund 60."
                            GoTo Errorhandle
                        End If
                    Case 630
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 641 To 648
                        valid = False
                        If idim4 <> 1000 And dim9 = "050" Then valid = True
                        If idim4 = 1000 And dim9 <> "050" Then valid = True
                        If idim4 = 2120 And dim9 <> "050" Then valid = True
                        If idim4 = 2220 And dim9 <> "050" Then valid = True
                        If dim9 <> "050" Then valid = True
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site invalid for this Function/Object."
                            GoTo Errorhandle
                        End If
                    Case 643, 644
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 658
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 710
                        valid = False
                        If idim4 = 2630 Then valid = True
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 720
                        valid = False
                        If idim4 = 2620 Then valid = True
                        If idim4 = 4600 Then valid = True
                        If idim4 = 4700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 820, 831, 832
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle
                    Case 833, 834
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle
                    Case 870
                        If idim4 <> 2518 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If
                    Case 880
                        If idim4 = 2199 Then valid = True
                        If idim4 >= 7100 Or idim4 <= 7299 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                        ' taken out 06-25-14
                        'Case 930
                        '    valid = False
                        '    If idim4 = 5200 Then valid = True
                        '    If idim4 = 5600 Then valid = True
                        '    If idim4 = 5900 Then valid = True
                        '    If idim4 = 7400 Then valid = False
                        '    If idim4 = 8100 Then valid = True
                        '    If idim4 = 8900 Then valid = True
                        '    If Not valid Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Function invalid for this object."
                        '        GoTo Errorhandle
                        '    End If

                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 970
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 981, 982
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 990
                        If idim4 <> 5700 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 = 800 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 700 valid with proj 000-298, & 385."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = False
                        If idim3 = 385 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program 900 invalid."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 1060
                        valid = False
                        If idim6 = 239 Then valid = True
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: subject not valid for fund 60."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                        'valid = False
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

                Select Case idim9
                    Case 50
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site not valid for School."
                            GoTo Errorhandle
                        End If
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                'added this part to handle the warning on objects 100-299
                ' errorphase = "4" pec 04-26-11

                If errorphase = "4" Then
                    valid = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                Else
                    If valid = False Then
                        Me.HasErrors = True
                        With Me.GridDetail
                            .SetData(currow, 11, errorphase)
                            .SetData(currow, 14, errorval)
                            .SetData(currow, 15, errordescr)
                        End With
                    End If
                End If

                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2014_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 700) And (temp5 <= 799) Then
                dim5 = "700"
            End If
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            End If
            If (temp5 >= 900) And (temp5 <= 999) Then
                dim5 = "900"
            End If
            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010
                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2014_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                If idim5 < 700 Then
                    valid = False
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Program invalid for fund 60."
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298      'fund 60 project 000 to 298 school assgined for child nur.
                        valid = False
                        If idim5 >= 700 And idim5 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Prog invalid for project 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'source validation
                        valid = False
                        If idim4 = 1310 Then valid = True
                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Source invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800        'fund 60 only
                        valid = True
                    Case Else       'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the source
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1100 To 1199
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 1200 To 1299
                        valid = True
                    Case 1300 To 1799
                        valid = True
                    Case 1800 To 1899
                        valid = True
                    Case 1900 To 1999
                        If idim3 = 800 Then
                            errordescr = ""
                            valid = True
                        Else
                            valid = False
                            errordescr = "Source invalid for project " & dim3 & "."
                        End If
                    Case 2000 To 4999
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5111, 5112, 5120, 5130, 5150, 5160, 5190
                        valid = True
                    Case 5200
                        'errordescr = "Source valid for zero amount."
                        valid = False
                    Case 5300
                        valid = True
                    Case 5400, 5600, 5800
                        valid = True
                    Case 6110, 6130, 6140
                        valid = True
                    Case 6200
                        valid = True
                    Case Else
                        valid = False
                        errordescr = "Source invalid for fund 60."
                End Select
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: " + errordescr
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 = 800 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program valid for proj 000-298 & 385."
                            GoTo Errorhandle
                        End If
                    Case 800
                        valid = True
                    Case 900
                        valid = False
                        If idim3 <> 385 Then valid = True
                        If idim3 >= 0 And idim3 <= 298 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program invalid for proj 000-298 & 385."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the site
                ''''''''''''''''''''''''''''''''''''''

                Dim mysite As String = Me.DistrictId
                Dim myopunit As Char
                myopunit = GetChar(mysite, 1)

                Select Case idim6
                    Case idim6
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

#End Region

#Region "  Methods 2015 Edit Checks "

    Private Function Expenditure2015_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 700) And (temp6 <= 799) Then
                dim6 = "700"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next

    End Function

    Private Function Expenditure2015_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298               'fund 60 only
                        valid = False
                        If idim6 >= 700 And idim6 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for proj 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 3200 And idim4 <= 3299 Then valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 421 To 791             'fund 60 only not valid
                        valid = False
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function DIM 4
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If

                    Case 1500
                        valid = False
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2120
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 2140
                        valid = False
                        If idim6 = 239 Then valid = True
                        If idim6 = 430 Then valid = True
                        If idim6 = 497 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Programs 239 & 430."
                            GoTo Errorhandle
                        End If

                    Case 2152
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If
                    Case 2153
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2220
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2410
                        valid = True
                        If idim6 = 100 Then valid = False
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 or program 100 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2490
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 3100 To 3199
                        valid = False
                        If idim3 = 0 And idim6 = 700 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                        'changed 05-22-13 state took edit check off function 3200
                    Case 3200
                        valid = False
                        'validate the object with this function
                        If idim5 = 660 Then valid = True
                        If idim5 = 670 Then valid = True
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 3200."
                            GoTo Errorhandle
                        End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 970 Then valid = True
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If

                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If

                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5600 To 5699
                        If idim5 = 930 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If

                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If

                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7000 To 7999
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 8100
                        valid = False
                        'validate the object with this function
                        'If idim5 = 890 Then valid = True
                        'If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Invalid Function."
                            GoTo Errorhandle
                        End If

                    Case 8900
                        valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 299             'payroll objects???
                        valid = True
                        errorval = dim4
                        errorphase = "4"
                        errordescr = "Warning: Obj may not be valid for fd 60."
                        GoTo Errorhandle
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3190 Or idim4 <= 3199 Then valid = True
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        valid = False
                        If idim4 = 2319 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 561, 562, 566
                        valid = False
                        If idim4 = 1000 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object can only use fund 11 & 12."
                        GoTo Errorhandle

                    Case 563, 564, 567
                        valid = False
                        If idim4 = 1000 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object can only use function 1000."
                        GoTo Errorhandle


                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                    Case 580
                        valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object invalid for fund 60."
                            GoTo Errorhandle
                        End If

                    Case 630
                        valid = False
                        If idim4 = 3110 And idim6 = 700 Then valid = True
                        If idim4 = 3150 And idim6 = 700 Then valid = True
                        If idim4 = 3155 And idim6 = 700 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for function."
                        GoTo Errorhandle

                    Case 641 To 648
                        valid = False
                        If idim4 <> 1000 And dim9 = "050" Then valid = True
                        If idim4 = 1000 And dim9 <> "050" Then valid = True
                        If idim4 = 2120 And dim9 <> "050" Then valid = True
                        If idim4 = 2220 And dim9 <> "050" Then valid = True
                        If dim9 <> "050" Then valid = True
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site invalid for this Function/Object."
                            GoTo Errorhandle
                        End If

                    Case 643, 644
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 658
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 710
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2630 Then valid = True
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 720
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2620 Then valid = True
                        If idim4 >= 4600 Or idim4 <= 4699 Then valid = True
                        If idim4 >= 4700 Or idim4 <= 4799 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 820, 831, 832
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function valid in fund 12 & 41."
                        GoTo Errorhandle

                    Case 833, 834
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                    Case 870
                        valid = False
                        If idim4 <> 2518 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If

                    Case 880
                        If idim4 = 2199 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                        ' taken out 06-25-14
                        'Case 930
                        '    valid = False
                        '    If idim4 = 5200 Then valid = True
                        '    If idim4 = 5600 Then valid = True
                        '    If idim4 = 5900 Then valid = True
                        '    If idim4 = 7400 Then valid = False
                        '    If idim4 = 8100 Then valid = True
                        '    If idim4 = 8900 Then valid = True
                        '    If Not valid Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Function invalid for this object."
                        '        GoTo Errorhandle
                        '    End If

                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 970
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 981, 982
                        valid = False
                        If idim4 = 3200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 >= 800 And idim3 <= 999 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 700 valid with proj 000-298, & 385."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim3 >= 800 And idim3 <= 999 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program 900 invalid."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 1060
                        valid = False
                        If idim6 = 239 Then valid = True
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: subject not valid for fund 60."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                        'valid = False
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

                Select Case idim9
                    Case 50
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site not valid for School."
                            GoTo Errorhandle
                        End If
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                'added this part to handle the warning on objects 100-299
                ' errorphase = "4" pec 04-26-11

                If errorphase = "4" Then
                    valid = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                Else
                    If valid = False Then
                        Me.HasErrors = True
                        With Me.GridDetail
                            .SetData(currow, 11, errorphase)
                            .SetData(currow, 14, errorval)
                            .SetData(currow, 15, errordescr)
                        End With
                    End If
                End If

                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2015_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 700) And (temp5 <= 799) Then
                dim5 = "700"
            End If
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            End If
            If (temp5 >= 900) And (temp5 <= 999) Then
                dim5 = "900"
            End If
            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010
                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2015_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                If idim5 < 700 Then
                    valid = False
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Program invalid for fund 60."
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298      'fund 60 project 000 to 298 school assgined for child nur.
                        valid = False
                        If idim5 >= 700 And idim5 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Prog invalid for project 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'source validation
                        valid = False
                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Source invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800        'fund 60 only
                        valid = True
                    Case Else       'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the source
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1100 To 1199
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 1200 To 1299
                        valid = True
                    Case 1300 To 1699
                        valid = True
                    Case 1700 To 1799
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim5 >= 700 And idim5 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Source valid with prj 000-298 & prg 700"
                            GoTo Errorhandle
                        End If
                    Case 1800 To 1899
                        valid = True
                    Case 1900 To 1999
                        If idim3 = 800 Then
                            errordescr = ""
                            valid = True
                        Else
                            valid = False
                            errordescr = "Source invalid for project " & dim3 & "."
                        End If
                    Case 2000 To 4999
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5111, 5112, 5113, 5120, 5130, 5150, 5160, 5190
                        valid = True
                    Case 5200
                        'errordescr = "Source valid for zero amount."
                        valid = False
                    Case 5300
                        valid = True
                    Case 5600, 5800
                        valid = True
                    Case 6110, 6130, 6140
                        valid = True
                    Case 6200
                        valid = True
                    Case Else
                        valid = False
                        errordescr = "Source invalid for fund 60."
                End Select
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: " + errordescr
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 = 800 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program valid for proj 000-298 & 385."
                            GoTo Errorhandle
                        End If
                    Case 800
                        valid = True
                    Case 900
                        valid = False
                        If idim3 <> 385 Then valid = True
                        If idim3 >= 0 And idim3 <= 298 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program invalid for proj 000-298 & 385."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the site
                ''''''''''''''''''''''''''''''''''''''

                Dim mysite As String = Me.DistrictId
                Dim myopunit As Char
                myopunit = GetChar(mysite, 1)

                Select Case idim6
                    Case idim6
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

#End Region

#Region "  Methods 2016 Edit Checks "

    Private Function Expenditure2016_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 0) And (temp3 <= 298) Then
                dim3 = "000"
            Else
                dim3 = "800"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 700) And (temp6 <= 799) Then
                dim6 = "700"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next

    End Function

    Private Function Expenditure2016_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298               'fund 60 only
                        valid = False
                        If idim6 >= 700 And idim6 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for proj 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 3200 And idim4 <= 3299 Then valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 421 To 791             'fund 60 only not valid
                        valid = False
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If

                    Case 1500
                        valid = False
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2120
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 2140
                        valid = False
                        If idim6 = 239 Then valid = True
                        If idim6 = 430 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Programs 239 & 430."
                            GoTo Errorhandle
                        End If

                    Case 2152
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If
                    Case 2153
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2220
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2410
                        valid = True
                        If idim6 = 100 Then valid = False
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 or program 100 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2490
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 3100 To 3199
                        valid = False
                        If idim3 = 0 And idim6 = 700 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                        'changed 05-22-13 state took edit check off function 3200
                    Case 3200
                        valid = False
                        'validate the object with this function
                        If idim5 = 660 Then valid = True
                        If idim5 = 670 Then valid = True
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 3200."
                            GoTo Errorhandle
                        End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 970 Then valid = True
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If

                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If

                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5600 To 5699
                        If idim5 = 930 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If

                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If

                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7000 To 7999
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        'If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Invalid Function."
                            GoTo Errorhandle
                        End If

                    Case 8900
                        valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 299             'payroll objects???
                        valid = True
                        errorval = dim4
                        errorphase = "4"
                        errordescr = "Warning: Obj may not be valid for fd 60."
                        GoTo Errorhandle
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3190 Or idim4 <= 3199 Then valid = True
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        valid = False
                        If idim4 = 2319 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 561, 562, 566
                        valid = False
                        If idim4 = 1000 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object can only use fund 11 & 12."
                        GoTo Errorhandle

                    Case 563, 564, 567
                        valid = False
                        If idim4 = 1000 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object can only use function 1000."
                        GoTo Errorhandle


                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                    Case 580
                        valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object invalid for fund 60."
                            GoTo Errorhandle
                        End If

                    Case 630
                        valid = False
                        If idim4 = 3110 And idim6 = 700 Then valid = True
                        If idim4 = 3150 And idim6 = 700 Then valid = True
                        If idim4 = 3155 And idim6 = 700 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for function."
                        GoTo Errorhandle

                    Case 641 To 648
                        valid = False
                        If idim4 <> 1000 And dim9 = "050" Then valid = True
                        If idim4 = 1000 And dim9 <> "050" Then valid = True
                        If idim4 = 2120 And dim9 <> "050" Then valid = True
                        If idim4 = 2220 And dim9 <> "050" Then valid = True
                        If dim9 <> "050" Then valid = True
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site invalid for this Function/Object."
                            GoTo Errorhandle
                        End If

                    Case 643, 644
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 658
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 710
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2630 Then valid = True
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 720
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2620 Then valid = True
                        If idim4 >= 4600 Or idim4 <= 4699 Then valid = True
                        If idim4 >= 4700 Or idim4 <= 4799 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 820, 831, 832
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function valid in fund 12 & 41."
                        GoTo Errorhandle

                    Case 833, 834
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                    Case 870
                        valid = False
                        If idim4 <> 2518 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If

                    Case 880
                        If idim4 = 2199 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                        ' taken out 06-25-14
                        'Case 930
                        '    valid = False
                        '    If idim4 = 5200 Then valid = True
                        '    If idim4 = 5600 Then valid = True
                        '    If idim4 = 5900 Then valid = True
                        '    If idim4 = 7400 Then valid = False
                        '    If idim4 = 8100 Then valid = True
                        '    If idim4 = 8900 Then valid = True
                        '    If Not valid Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Function invalid for this object."
                        '        GoTo Errorhandle
                        '    End If

                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 970
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 981, 982
                        valid = False
                        If idim4 = 3200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 >= 800 And idim3 <= 999 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 700 valid with proj 000-298, & 385."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim3 >= 800 And idim3 <= 999 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program 900 invalid."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 1060
                        valid = False
                        If idim6 = 239 Then valid = True
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: subject not valid for fund 60."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                        'valid = False
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim9
                    Case 50
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site not valid for School."
                            GoTo Errorhandle
                        End If
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                'added this part to handle the warning on objects 100-299
                ' errorphase = "4" pec 04-26-11

                If errorphase = "4" Then
                    valid = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                Else
                    If valid = False Then
                        Me.HasErrors = True
                        With Me.GridDetail
                            .SetData(currow, 11, errorphase)
                            .SetData(currow, 14, errorval)
                            .SetData(currow, 15, errordescr)
                        End With
                    End If
                End If

                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2016_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 700) And (temp5 <= 799) Then
                dim5 = "700"
            End If
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            End If
            If (temp5 >= 900) And (temp5 <= 999) Then
                dim5 = "900"
            End If
            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010
                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2016_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                If idim5 < 700 Then
                    valid = False
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Program invalid for fund 60."
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298      'fund 60 project 000 to 298 school assgined for child nur.
                        valid = False
                        If idim5 >= 700 And idim5 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Prog invalid for project 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'source validation
                        valid = False
                        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Source invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 800        'fund 60 only
                        valid = True
                    Case Else       'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the source
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1100 To 1199
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 1200 To 1299
                        valid = True
                    Case 1300 To 1699
                        valid = True
                    Case 1700 To 1799
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim5 >= 700 And idim5 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Source valid with prj 000-298 & prg 700"
                            GoTo Errorhandle
                        End If
                    Case 1800 To 1899
                        valid = True
                    Case 1900 To 1999
                        If idim3 = 800 Then
                            errordescr = ""
                            valid = True
                        Else
                            valid = False
                            errordescr = "Source invalid for project " & dim3 & "."
                        End If
                    Case 2000 To 4999
                        valid = False
                        errordescr = "Source invalid for fund 60."
                    Case 5111, 5112, 5113, 5120, 5130, 5150, 5160, 5190
                        valid = True
                    Case 5200
                        'errordescr = "Source valid for zero amount."
                        valid = False
                    Case 5300
                        valid = True
                    Case 5600, 5800
                        valid = True
                    Case 6110, 6130, 6140
                        valid = True
                    Case 6200
                        valid = True
                    Case Else
                        valid = False
                        errordescr = "Source invalid for fund 60."
                End Select
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: " + errordescr
                    GoTo Errorhandle
                End If

                ''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 = 800 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program valid for proj 000-298 & 385."
                            GoTo Errorhandle
                        End If
                    Case 800
                        valid = True
                    Case 900
                        valid = False
                        If idim3 <> 385 Then valid = True
                        If idim3 >= 0 And idim3 <= 298 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Program invalid for proj 000-298 & 385."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''
                'validate the site
                ''''''''''''''''''''''''''''''''''''''

                Dim mysite As String = Me.DistrictId
                Dim myopunit As Char
                myopunit = GetChar(mysite, 1)

                Select Case idim6
                    Case idim6
                        valid = True
                    Case Else
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Site invalid for fund 60."
                        GoTo Errorhandle
                End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

#End Region

#Region "  Methods 2017 Edit Checks "

    Private Function Expenditure2017_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 0) And (temp3 <= 298) Then
                dim3 = "000"
            Else
                dim3 = "800"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 700) And (temp6 <= 799) Then
                dim6 = "700"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next

    End Function

    Private Function Expenditure2017_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim2
                    Case 60
                    Case Else
                        valid = False
                        errorval = dim2
                        errorphase = "2"
                        errordescr = "Error: Fund 60 required."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim3
                    Case 0 To 298               'fund 60 only
                        valid = False
                        If idim6 >= 700 And idim6 <= 799 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for proj 000-298."
                            GoTo Errorhandle
                        End If
                    Case 385        'project to function validation
                        valid = False
                        If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        If idim4 >= 3200 And idim4 <= 3299 Then valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = True
                        If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        If idim4 >= 8900 And idim4 <= 8999 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for project 385."
                            GoTo Errorhandle
                        End If
                    Case 421 To 791             'fund 60 only not valid
                        valid = False
                    Case 800 To 998             'fund 60 only
                        valid = True
                    Case Else                   'all other projects fail
                        valid = False
                        errorval = dim3
                        errorphase = "2"
                        errordescr = "Error: Project invalid for fund 60."
                        GoTo Errorhandle
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        If idim5 = 641 And idim7 = 0 Then valid = False
                        If idim5 = 643 And idim7 = 0 Then valid = False
                        If idim5 = 644 And idim7 = 0 Then valid = False
                        If idim5 = 645 And idim7 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Subject required for function 1000."
                            GoTo Errorhandle
                        End If

                    Case 1500
                        valid = False
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2120
                        valid = True
                        If idim9 = 50 Then valid = False
                        'validate the site with this function
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                    Case 2140
                        valid = False
                        If idim6 = 239 Then valid = True
                        If idim6 = 430 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Programs 239 & 430."
                            GoTo Errorhandle
                        End If

                    Case 2152
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If
                    Case 2153
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2220
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2410
                        valid = True
                        If idim6 = 100 Then valid = False
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 or program 100 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2490
                        valid = True
                        If idim9 = 50 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Site 050 not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                    Case 3100 To 3199
                        valid = False
                        If idim3 = 0 And idim6 = 700 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                        'changed 05-22-13 state took edit check off function 3200
                    Case 3200
                        valid = False
                        'validate the object with this function
                        If idim5 = 660 Then valid = True
                        If idim5 = 670 Then valid = True
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 3200."
                            GoTo Errorhandle
                        End If

                    Case 5200 To 5299
                        valid = False
                        'validate the object with this function
                        If idim5 = 930 Then valid = True
                        If idim5 = 950 Then valid = True
                        If idim5 = 960 Then valid = True
                        If idim5 = 970 Then valid = True
                        If idim5 = 981 Then valid = True
                        If idim5 = 982 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5200."
                            GoTo Errorhandle
                        End If

                    Case 5300 To 5399
                        valid = False
                        'validate the object with this function
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5300."
                            GoTo Errorhandle
                        End If

                    Case 5400 To 5499
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5500 To 5599
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 5600 To 5699
                        If idim5 = 930 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5600."
                            GoTo Errorhandle
                        End If

                    Case 5800 To 5899
                        If idim5 <> 970 Then
                            valid = False
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 5800."
                            GoTo Errorhandle
                        End If

                    Case 5900 To 5999
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 7000 To 7999
                        valid = False
                        errorphase = "2"
                        errordescr = "Error: Function invalid for fund 60."
                        GoTo Errorhandle

                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        'If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Invalid Function."
                            GoTo Errorhandle
                        End If

                    Case 8900
                        valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object invalid for function 8900."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the object
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim5
                    Case 100 To 299             'payroll objects???
                        valid = True
                        errorval = dim4
                        errorphase = "4"
                        errordescr = "Warning: Obj may not be valid for fd 60."
                        GoTo Errorhandle
                    Case 290                    'payroll objects???
                        If idim4 <> 5300 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If
                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        If idim4 >= 3190 Or idim4 <= 3199 Then valid = True
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 522
                        valid = False
                        If idim4 = 2319 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function invalid for this object."
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 561, 562, 566
                        valid = False
                        If idim4 = 1000 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object can only use fund 11 & 12."
                        GoTo Errorhandle

                    Case 563, 564, 567
                        valid = False
                        If idim4 = 1000 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object can only use function 1000."
                        GoTo Errorhandle


                    Case 570
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                    Case 580
                        valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object invalid for fund 60."
                            GoTo Errorhandle
                        End If

                    Case 630
                        valid = False
                        If idim4 = 3110 And idim6 = 700 Then valid = True
                        If idim4 = 3150 And idim6 = 700 Then valid = True
                        If idim4 = 3155 And idim6 = 700 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for function."
                        GoTo Errorhandle

                    Case 641 To 648
                        valid = False
                        If idim4 <> 1000 And dim9 = "050" Then valid = True
                        If idim4 = 1000 And dim9 <> "050" Then valid = True
                        If idim4 = 2120 And dim9 <> "050" Then valid = True
                        If idim4 = 2220 And dim9 <> "050" Then valid = True
                        If dim9 <> "050" Then valid = True
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site invalid for this Function/Object."
                            GoTo Errorhandle
                        End If

                    Case 643, 644
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 658
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 660, 670
                        If idim4 <> 3200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 710
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2630 Then valid = True
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 720
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2620 Then valid = True
                        If idim4 >= 4600 Or idim4 <= 4699 Then valid = True
                        If idim4 >= 4700 Or idim4 <= 4799 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 820, 831, 832
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function valid in fund 12 & 41."
                        GoTo Errorhandle

                    Case 833, 834
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                    Case 870
                        valid = False
                        If idim4 <> 2518 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this fund."
                            GoTo Errorhandle
                        End If

                    Case 880
                        If idim4 = 2199 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 920
                        valid = False
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object invalid for fund 60."
                        GoTo Errorhandle

                        ' taken out 06-25-14
                        'Case 930
                        '    valid = False
                        '    If idim4 = 5200 Then valid = True
                        '    If idim4 = 5600 Then valid = True
                        '    If idim4 = 5900 Then valid = True
                        '    If idim4 = 7400 Then valid = False
                        '    If idim4 = 8100 Then valid = True
                        '    If idim4 = 8900 Then valid = True
                        '    If Not valid Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Function invalid for this object."
                        '        GoTo Errorhandle
                        '    End If

                    Case 950
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 970
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = False
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case 981, 982
                        valid = False
                        If idim4 = 3200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function invalid for this object."
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim6
                    Case 0
                        valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program invalid for fund 60."
                        GoTo Errorhandle
                    Case 100
                        If idim4 = 1000 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 100 only valid for func 1000."
                        GoTo Errorhandle
                    Case 700
                        valid = False
                        If idim3 >= 0 And idim3 <= 298 Then valid = True
                        If idim3 = 385 Then valid = True
                        If idim3 >= 800 And idim3 <= 999 Then valid = False
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Prog 700 valid with proj 000-298, & 385."
                        GoTo Errorhandle
                    Case 900
                        'valid = False
                        If idim3 >= 800 And idim3 <= 999 Then valid = True
                        errorval = dim6
                        errorphase = "2"
                        errordescr = "Error: Program 900 invalid."
                        GoTo Errorhandle
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    Case 0
                        If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: Subject is required for function 1000."
                        GoTo Errorhandle
                    Case 1060
                        valid = False
                        If idim6 = 239 Then valid = True
                        errorval = dim7
                        errorphase = "2"
                        errordescr = "Error: subject not valid for fund 60."
                        GoTo Errorhandle
                    Case 6000 To 7999
                        valid = False
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: subject invalid."
                            GoTo Errorhandle
                        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim8
                    Case Else
                        valid = True
                        'valid = False
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim9
                    Case 50
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site not valid for School."
                            GoTo Errorhandle
                        End If
                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                'added this part to handle the warning on objects 100-299
                ' errorphase = "4" pec 04-26-11

                If errorphase = "4" Then
                    valid = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                Else
                    If valid = False Then
                        Me.HasErrors = True
                        With Me.GridDetail
                            .SetData(currow, 11, errorphase)
                            .SetData(currow, 14, errorval)
                            .SetData(currow, 15, errordescr)
                        End With
                    End If
                End If

                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function


    Private Function Revenue2017_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 700) And (temp5 <= 799) Then
                dim5 = "700"
            End If
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            End If
            If (temp5 >= 900) And (temp5 <= 999) Then
                dim5 = "900"
            End If
            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010
                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function


    Private Function Revenue2017_Phase2_EditCheck() As Boolean
        'Complete Rewrite Mark 4.12.2017
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     errordescrs   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean
        Dim RecordCount As Double
        valid = True
        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1



                valid = True
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)

                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                If Me._editchk = True Then
                    revenuecode = Me._Revenuecode
                    _ExpenseCodeFlag = False
                    currow = Me.GridDetail.Rows.Count - 1
                End If
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'REVENUe bold code edit replace 4.12.2017 - Mark;
                'Old code commented out
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                'If idim5 < 700 Then
                '    valid = False
                '    errorval = dim5
                '    valid = False
                '    errorphase = "2"
                '    errordescr = "Error: Program invalid for fund 60."
                '    GoTo Errorhandle
                'End If



                'New Project to Perform OCAS Edit Checks, Mark 3.21.2017;

                '===============================FUND CODE======================================================================================
                '                                  IDIM 2
                '=================================================================================================================================
                valid = True
                Select Case idim2

                    'Fund Code 11, 12, 21, 22, 24, 25, 26, 30 Series, 41, 50, 60, 80 Series Requires A Source Code
                'Case 11, 12, 21, 22, 24, 25, 26, 30 To 39, 41, 50, 60, 80
                '        Select Case idim4
                '            Case 0
                '                If idim4 = 0 Then valid = False
                '                errordescr = "ERROR: Fund " & idim2 & " Requires A Source Code"
                '                errorphase = "2"
                '                errorval = dim2
                '                valid = False
                '                valid = False
                '                GoTo Errorhandle
                '        End Select

                    Case 11
                        If idim4 = 0 Then valid = False
                        If valid = False Then
                            errordescr = "ERROR: Fund " & idim2 & " Requires a Source code"
                            errorphase = "2"
                            errorval = dim2
                            valid = False
                            GoTo Errorhandle
                        End If


                        'Fund Code 21 Can Only Use Source Code 1100 Series, 1310, 1320, 1350, 1390, 1410, 1420, 1430, 1440, 1450, 1460, 1490 Series, 1510, 1530,
                        '1550, 1570, 1590, 1610, 1630, 1650, 1660, 1670, 1680, 1690, 2000 Series, 3160, 3190, 3250, 3480, 3610, 3620, 3690, 3890, 4120, 4130, 4131,
                        '4161, 4162, 4163, 4164, 4165, 4689, 4890, 5000 Series, 6000 Series
                        'Except When Using Project Code 431 Only When Using District 55I052 (midwest) --ignored


                    Case 21
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 1100 To 1199
                            Case 1310, 1320, 1350, 1390, 1410, 1420, 1430, 1440, 1450, 1460
                            Case 1490 To 1499
                            Case 1510, 1530, 1550, 1570, 1590, 1610, 1630, 1650, 1660, 1670, 1680, 1690
                            Case 2000 To 2999
                            Case 3160, 3190, 3250, 3480, 3610, 3620, 3690, 3890, 4120, 4130, 4131, 4161, 4162, 4163, 4164, 4165, 4689, 4890
                            Case 5000 To 6999

                            Case Else
                                errordescr = "ERROR: Fund " & dim2 & " Not Valid Against Source: " & idim4
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Fund Code 21 Cannot Use Source Code 3833 Except When Using District 55I052 (midwest) Only When Using Project Code 431
                    Case 21
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 3833
                                errordescr = "ERROR: Fund " & idim2 & " Cannot Use Source Code 3833"
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                valid = False
                                GoTo Errorhandle

                        End Select

                        'Fund Code 22 Can Only Use Program Code 700 Except When Using Project Code 456
                    Case 22
                        If idim4 = 0 Then valid = False
                        RecordCount = RecordCount + 1
                        Select Case idim5
                            Case 700
                                If idim3 = 456 Then
                                Else
                                    valid = False
                                    errordescr = "ERROR: Fund " & idim2 & " Cannot Use Program 700 with Project " & idim3
                                    errorphase = "2"
                                    errorval = dim2
                                    valid = False
                                    GoTo Errorhandle
                                End If
                        End Select

                        'Fund Code 30 Series Can Only Use Source Code 1310, 1340, 1430, 1440, 1590, 1670, 1680, 6110, 6130, 6140, 5111, 5112, 5190, 5600
                    Case 30 To 39
                        If idim4 = 0 Then valid = False
                        RecordCount = RecordCount + 1
                        Select Case idim4
                            Case 1310, 1340, 1430, 1440, 1590, 1670, 1680, 6110, 6130, 6140, 5111, 5112, 5190, 5600
                            Case Else
                                valid = False
                                errordescr = "ERROR: Fund " & idim2 & " Cannot Use Source Code " & idim4
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Fund Code 41 Can Only Use Source Code 1100 Series, 1310, 1340, 1350, 1390, 1410, 1430, 1670, 1680, 2000 Series, 3160, 3190, 3610, 3620,
                        '4161, 5111, 5160, 5190, 5600, 6110, 6130, 6140, 6200
                    Case 41
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 1100 To 1199
                            Case 1310, 1340, 1350, 1390, 1410, 1430, 1670, 1680
                            Case 2000 To 2999
                            Case 3160, 3190, 3610, 3620, 4161, 5111, 5160, 5190, 5600, 6110, 6130, 6140, 6200
                            Case Else
                                valid = False
                                errordescr = "ERROR: Fund " & idim2 & " Cannot Use Source Code " & idim4
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle

                        End Select

                        'Fund Code 50, 60, 80 Series Cannot Use Source Code 4000 Series
                    Case 50 To 69, 80 To 89
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 4000 To 4999
                                errordescr = "ERROR: Fund" & idim2 & " Cannot Use Source Code 4000 Series"
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                GoTo Errorhandle

                        End Select

                        'Fund Code 88 Can Only Use Source Code 1310, 5113, 5600, 6110
                    Case 88
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 1310, 5113, 5600, 6110
                            Case Else
                                errordescr = "ERROR: Fund " & idim2 & " Can Only Use Source Code 1310, 5113, 5600, 6110"
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                GoTo Errorhandle

                        End Select
                End Select


                '===============================FUND CODE=====================================================================================
                '                                   end idim2 
                '===============================================================================================================================



                '===============================PROJECT CODE======================================================================================
                '                                 Start idim3
                '=================================================================================================================================


                Select Case idim3
                    Case 306
                        RecordCount = RecordCount + 1
                        If idim4 = 3490 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 306 Can Only Use Source Code 3490, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            valid = False
                            GoTo Errorhandle

                        End If

                    Case 307 To 309, 370
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 307, 308, 309, 370 Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            valid = False
                            GoTo Errorhandle

                        End If

                    Case 308
                        RecordCount = RecordCount + 1
                        If idim5 = 277 Then
                        Else
                            errordescr = "ERROR: Project Code 308 Can Only Use Program Code 277"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 311
                        RecordCount = RecordCount + 1
                        If idim4 = 3411 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 311 Can Only Use Source Code 3411, 5800,6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 312
                        RecordCount = RecordCount + 1
                        If idim4 = 3412 Or idim4 = 5600 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 312 Can Only Use Source Code 3412, 5600, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 313
                        RecordCount = RecordCount + 1
                        If idim4 = 3480 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 313 Can Only Use Source Code 3480, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 314
                        RecordCount = RecordCount + 1
                        If idim4 = 3450 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 314 Can Only Use Source Code 3450, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 315
                        RecordCount = RecordCount + 1
                        If idim4 = 3360 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 315 Can Only Use Source Code 3360, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 316
                        RecordCount = RecordCount + 1
                        If idim4 = 3411 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 316 Can Only Use Source Code 3411, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 317
                        RecordCount = RecordCount + 1
                        If idim4 = 3440 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 317 Can Only Use Source Code 3440, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 319
                        RecordCount = RecordCount + 1
                        If idim4 = 3430 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 319 Can Only Use Source Code 3430, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        'Project Code 326 Can Only Use District 60I067 -Cushing


                    Case 326
                        RecordCount = RecordCount + 1
                        If SchoolNumber = "134" Then
                        Else
                            errordescr = "ERROR: Project Code 326 Can Only Use District 60I067"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        RecordCount = RecordCount + 1
                        If idim4 = 3310 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 326  Can Only Use Source Code 3310, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 388
                        RecordCount = RecordCount + 1
                        If idim4 = 3310 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 388  Can Only Use Source Code 3310, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 331 To 332, 334 To 335
                        RecordCount = RecordCount + 1
                        If idim4 = 3250 Or idim4 = 6110 Or idim4 = 5150 Or idim4 = 5800 Or idim4 = 6200 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3250, 6110, 5150, 5800, 6200"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 333
                        RecordCount = RecordCount + 1
                        If idim2 = 11 Then
                        Else
                            errordescr = "ERROR: Project Code 333 Can Only Use Fund Code 11"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        If idim4 = 3420 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 333 Can Only Use Source Code 3420, 5800, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 337, 386, 391, 397, 398
                        RecordCount = RecordCount + 1
                        If idim4 = 3310 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3310, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 338
                        RecordCount = RecordCount + 1
                        If idim4 = 3570 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3570, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 339
                        RecordCount = RecordCount + 1
                        If idim4 = 3650 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3650, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 360, 361, 363
                        If idim4 = 3690 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3690, 5800, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        'Project Code 362 Can Only Use Source Code 3690, 5800, 6110 Except When Using Source Code 6140 Only When Using District 36I071 - Ponca City
                    Case 362
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3650, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 365, 368, 369, 396
                        RecordCount = RecordCount + 1
                        If idim4 = 3470 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3470, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 367
                        RecordCount = RecordCount + 1
                        If idim4 = 3415 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3415, 5800, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 371, 372, 373
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 385
                        RecordCount = RecordCount + 1

                        If dim4.Substring(0, 2) = "37" Or idim4 = 5150 Or idim4 = 6110 Then

                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3700 Series, 5150, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only UseProgram Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 397
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 398
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 411
                        RecordCount = RecordCount + 1
                        If idim4 = 3811 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3811"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 412
                        RecordCount = RecordCount + 1
                        If idim4 = 3812 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3812, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 413
                        RecordCount = RecordCount + 1
                        If idim4 = 3813 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 418
                        RecordCount = RecordCount + 1
                        If idim4 = 3836 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 419
                        RecordCount = RecordCount + 1
                        If idim4 = 3819 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 419
                        RecordCount = RecordCount + 1
                        If idim4 = 3819 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 421, 422, 423, 424, 426, 427, 429
                        RecordCount = RecordCount + 1
                        If idim4 = 4821 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4821"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 431
                        RecordCount = RecordCount + 1
                        If idim4 = 3833 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3833"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 432
                        RecordCount = RecordCount + 1
                        If idim4 = 3832 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3832"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 433
                        RecordCount = RecordCount + 1
                        If idim4 = 3819 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3819"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 434
                        RecordCount = RecordCount + 1
                        If idim4 = 3834 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3834"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 435
                        RecordCount = RecordCount + 1
                        If idim4 = 3834 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3819"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 436
                        RecordCount = RecordCount + 1
                        If idim4 = 4836 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4836"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 437
                        RecordCount = RecordCount + 1
                        If idim4 = 3837 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3837"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 438
                        RecordCount = RecordCount + 1
                        If idim4 = 3838 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3838"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 441
                        RecordCount = RecordCount + 1
                        If idim4 = 3841 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3841"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 442
                        RecordCount = RecordCount + 1
                        If idim4 = 3842 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3842"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 443
                        RecordCount = RecordCount + 1
                        If idim4 = 3843 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3843"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 444
                        RecordCount = RecordCount + 1
                        If idim4 = 3844 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3844"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 447
                        RecordCount = RecordCount + 1
                        If idim4 = 4847 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4847"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 448
                        RecordCount = RecordCount + 1
                        If idim4 = 3848 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3848"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 451
                        If idim4 = 4850 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4850"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 452
                        RecordCount = RecordCount + 1
                        If idim4 = 4852 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4852"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 454
                        RecordCount = RecordCount + 1
                        If idim4 = 4616 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4616"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        'Except When Using District 16I008(lawton, 52I004
                    Case 456
                        RecordCount = RecordCount + 1
                        If idim4 = 4617 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4617"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 457
                        RecordCount = RecordCount + 1
                        If idim4 = 4618 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4618"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 461
                        If idim4 = 3861 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3861"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 462
                        If idim4 = 3862 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3862"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 463
                        If idim4 = 3852 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3852"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 464
                        If idim4 = 3864 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3864"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 466
                        RecordCount = RecordCount + 1
                        If idim4 = 3866 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3866"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 467
                        RecordCount = RecordCount + 1
                        If idim4 = 4867 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4867"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 468
                        RecordCount = RecordCount + 1
                        If idim4 = 4868 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4868"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 469
                        RecordCount = RecordCount + 1
                        If idim4 = 3892 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3892"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 474
                        RecordCount = RecordCount + 1
                        If idim4 = 4874 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4874"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 475
                        RecordCount = RecordCount + 1
                        If idim4 = 3875 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3875"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 476
                        RecordCount = RecordCount + 1
                        If idim4 = 4876 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4876"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 477
                        RecordCount = RecordCount + 1
                        If idim4 = 4877 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4877"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 478
                        RecordCount = RecordCount + 1
                        If idim4 = 3820 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3820"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 479
                        RecordCount = RecordCount + 1
                        If idim4 = 3879 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3879"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 481
                        RecordCount = RecordCount + 1
                        If idim4 = 4881 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4881"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 483
                        RecordCount = RecordCount + 1
                        If idim4 = 3839 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3839"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 484
                        RecordCount = RecordCount + 1
                        If idim4 = 4882 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4882"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        'Project Code 485 Can Only Use District 55I052 (MIDWEST), 55I041 (WESTERN HeIGHTS  - 880)
                        'READ AS RESERVED FOR THESE TWO SCHOOLS
                    Case 485
                        RecordCount = RecordCount + 1
                        If SchoolNumber = "880" Then
                            If idim4 = 3856 Then
                            Else
                                errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3856"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                            End If
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use District 55I052, 55I041"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 486
                        RecordCount = RecordCount + 1
                        If idim4 = 4886 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4886"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 489
                        RecordCount = RecordCount + 1
                        If idim4 = 3889 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3889"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 491, 492, 493, 494, 495
                        RecordCount = RecordCount + 1
                        If idim4 = 3890 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3890"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 511
                        RecordCount = RecordCount + 1
                        If idim4 = 4210 Or idim4 = 4271 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4210, 4271"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 515
                        RecordCount = RecordCount + 1
                        If idim4 = 4210 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4210"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 516, 519
                        RecordCount = RecordCount + 1
                        If idim4 = 4213 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4213"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 517, 518
                        RecordCount = RecordCount + 1
                        If idim4 = 4210 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4210"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 521
                        RecordCount = RecordCount + 1
                        If idim4 = 4230 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4230"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 531, 532
                        RecordCount = RecordCount + 1
                        If idim4 = 4240 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4240"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 541
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Or idim4 = 4441 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271, 4441"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 542, 544, 545
                        RecordCount = RecordCount + 1
                        If idim4 = 4273 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4273"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 543
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 546
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Or idim4 = 4441 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271, 4441"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 548
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 553, 554
                        RecordCount = RecordCount + 1
                        If idim4 = 4443 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4443"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 558
                        RecordCount = RecordCount + 1
                        If idim4 = 4462 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4462"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 559
                        RecordCount = RecordCount + 1
                        If idim4 = 4689 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4689"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 561
                        RecordCount = RecordCount + 1
                        If idim4 = 4140 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4140"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 563, 564
                        RecordCount = RecordCount + 1
                        If idim4 = 4550 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4550"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 571, 572
                        RecordCount = RecordCount + 1
                        If idim4 = 4281 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4281"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 586
                        RecordCount = RecordCount + 1
                        If idim4 = 271 Or idim4 = 4441 Or idim4 = 4461 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 44271, 4441, 4461"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 587
                        RecordCount = RecordCount + 1
                        If idim4 = 4470 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4470"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 588
                        RecordCount = RecordCount + 1
                        If idim4 = 4180 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4180, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 591, 592, 593
                        RecordCount = RecordCount + 1
                        If idim4 = 4130 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4130, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 594
                        RecordCount = RecordCount + 1
                        If idim4 = 4120 Or idim4 = 6110 Then

                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4120"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 596
                        RecordCount = RecordCount + 1
                        If idim4 = 4480 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4480"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 613, 615, 621, 623, 625, 626, 627 Can Only Use Source Code 4310, 5600 Only When Using District 25I038 (Wynnewood)
                        '               commented out as it passed upload test from state on another district  4.12.2017 Mark
                        ' Case 613, 615, 621, 623, 625, 626, 627
                        'Only for Wynnewood
                        '     errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Only When Using District 25I038 "
                        '        errorphase = "2"
                        '        errorval = dim3 
                        valid = False

                        '                    If idim4 = "4130" Or "5600" Then
                        '                    Else
                        '                        errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4310, 5600"
                        '                        errorphase = "2"
                        '                        errorval = dim3 
                        valid = False

                        '                    End If

                    Case 641, 642
                        RecordCount = RecordCount + 1
                        If idim4 = 4340 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4340"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 651
                        RecordCount = RecordCount + 1
                        If idim4 = 4350 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4350"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 691
                        RecordCount = RecordCount + 1
                        If idim4 = 4560 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4560"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 698
                        RecordCount = RecordCount + 1
                        If idim4 = 4580 Or idim4 = 5600 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4580, 5600, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 731, 732, 733, 734
                        RecordCount = RecordCount + 1
                        If idim4 = 4611 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4611, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 734 Can Only Use District 72I009  - Union
                    Case 734
                        RecordCount = RecordCount + 1
                        errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Can Only Use District 72I009"
                        errorphase = "2"
                        errorval = dim3
                        valid = False
                        GoTo Errorhandle


                    Case 735
                        RecordCount = RecordCount + 1
                        If idim4 = 4613 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4613"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 763
                        RecordCount = RecordCount + 1
                        If idim4 = 4710 Or idim4 = 5150 Or idim4 = 6110 Or idim4 = 6200 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4710, 5150, 6110, 6200"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 763, 764, 765, 766, 768, 769, 791
                        RecordCount = RecordCount + 1
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Program Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        If idim3 = 764 Then
                            If idim4 = 4720 Or idim4 = 5150 Or idim4 = 6110 Or idim4 = 6200 Then
                            Else
                                errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4720, 5150, 6110, 6200"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                            End If
                        End If




                    Case 765
                        RecordCount = RecordCount + 1
                        If idim4 = 4730 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4730, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 766
                        RecordCount = RecordCount + 1
                        If idim4 = 4740 Or idim4 = 5150 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4740, 6110, 5150"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 767
                        RecordCount = RecordCount + 1
                        If idim4 = 4770 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4770, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 767
                        RecordCount = RecordCount + 1
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Program Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 767
                        RecordCount = RecordCount + 1
                        If idim4 = 4790 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4790"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 768
                        RecordCount = RecordCount + 1
                        If idim4 = 4760 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4760, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 769
                        RecordCount = RecordCount + 1
                        If idim4 = 4750 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4750, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 770 Can Only Use Source Code 6110, 4000 Series Except When Using District 16I008 - Lawton Exception
                    Case 770
                        RecordCount = RecordCount + 1
                        If dim4.Substring(0, 1) = "4" Or idim4 = 6100 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 6110, 4000 Series"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 781
                        RecordCount = RecordCount + 1
                        If idim4 = 4685 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4685"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 790
                        RecordCount = RecordCount + 1
                        If idim4 = 4790 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4790"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 791
                        RecordCount = RecordCount + 1
                        If idim4 = 4780 Or idim4 = 5600 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4780, 5600"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 799 Can Only Use Source Code 4000 Series
                    Case 799
                        RecordCount = RecordCount + 1
                        If dim4.Substring(0, 1) = "4" Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4000 Series"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 799
                        RecordCount = RecordCount + 1
                        If idim5 <> 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Cannot Use Program Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 800
                        RecordCount = RecordCount + 1
                        If idim2 = 60 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can only use FUND 60"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                End Select

                '===============================PROJECT CODE=====================================================================================
                '                                  END
                '================================================================================================================================


                '===============================SOURCE CODE=====================================================================================
                '                                  Start
                '================================================================================================================================
                If idim4 >= 1000 And idim4 <= 6200 Then
                    RecordCount = RecordCount + 1
                    If idim6 = 0 Then
                        errordescr = "ERROR: Source Code " & idim4 & " Cannot Use Site Code 000"
                        errorphase = "2"
                        errorval = dim4
                        valid = False
                        GoTo Errorhandle
                    End If
                End If


                Select Case idim4
                    '                   Source Code 1100 Series Can Only Use Fund Code 11, 21, 24, 25, 41
                    Case 1100
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11, 21, 24, 25, 41
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 21, 24, 25, 41"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select


                    Case 1310
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 0, 299, 800, 900
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Invalid with Project " & dim3
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 1430
                        RecordCount = RecordCount + 1
                        If idim2 = 41 Then
                        Else
                            errordescr = "Error: Source Code " & idim4 & " Can Only Use Fund 41"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 1700
                        RecordCount = RecordCount + 1
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                        If idim3 = 0 Or idim3 = 800 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 000, 800"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 1900
                        RecordCount = RecordCount + 1
                        If idim2 = 60 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 60"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 2000
                        RecordCount = RecordCount + 1
                        If idim2 = 11 Or idim2 = 21 Or idim2 = 25 Or idim2 = 41 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 11, 21, 25, 41"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Source Code 3000 Series, 4000 Series Cannot Use Fund Code 60
                    Case 3000 To 4999
                        RecordCount = RecordCount + 1

                        If idim2 = 60 Then
                            errordescr = "ERROR: Source Code " & idim4 & " Cannot Use Fund Code 60"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                        '                    Source Code 3110, 3120 Cannot Use District Prefix C - uncoded for now (maple darlington banner greenvile..)

                        '                    Source Code 3111 Can Only Use District 57I002 - Pawhuska[600], 57I011- Shidler, 57I029 - Barnsdall ,
                        '57I030- wayona, 57I038 - Hominy, 57I050 - Prue, 57I090 - Woodland[894], 72I008 -tipton
                    Case 3111
                        RecordCount = RecordCount + 1
                        If SchoolNumber = "600" Or SchoolNumber = "894" Then
                            errordescr = "ERROR: Source Code " & idim4 & " Source Code 3111 Can Only Use Specified Districts"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 3140
                        RecordCount = RecordCount + 1
                        If dim2 = "11" Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 11"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 3210, 3120
                        RecordCount = RecordCount + 1
                        If dim2 = "11" Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 11"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 3250
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 331, 332, 334, 335
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 331, 332, 334, 335"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        Select Case idim2
                            Case 11, 12, 21, 22, 26
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 12, 21, 22, 26"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3310
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 326, 381, 388
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 326, 381, 388"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3360
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 315
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 315"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3411
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 311, 316
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 311, 316"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3412
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 312
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 312"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3415
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 367
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 367"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3420
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund 11"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim3
                            Case 333
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 333"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3430
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 319
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 319"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3440
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 317
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 317"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3450
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 314
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 314"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3470
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 365, 368, 369, 396
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 365, 368, 369, 396"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3480
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 313
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 313"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3490
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 306
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 306"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3570
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 338
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 338"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3650
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 339
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 339"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3700 To 3799
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11, 22
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 22"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim5
                            Case 700
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim3
                            Case 385
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 385"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3811
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 411
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 411"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3812
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 412
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 412"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3813
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 413
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 413"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3819
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 419, 433, 435
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 419, 433, 435"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3820
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 478
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 478"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3832
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 432
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 432"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3833
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 431
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 431"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3834
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 434
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 434"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3836
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 418
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 418"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3837
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 437
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 437"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3838
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 438
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 438"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3839
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 483
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 483"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3841
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 441
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 441"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3842
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 442
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 442"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3843
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 443
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 443"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3844
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 444
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 444"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3848
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 448
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 448"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3852
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 463
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 463"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 3856 Can Only Use Project Code 485 Only When Using District 55I052 (MIDWEST CITY-DEL City)
                    Case 3856
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 485
                                '                        Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " District 55I052 Reserved Project Code 485"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3861
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 461
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 461"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3862
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 462
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 462"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3864
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 464
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 464"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3866
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 466
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 466"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3875
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 475
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 475"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3879
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 479
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 479"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3889
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 489
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 489"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3890
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 491, 492, 493, 494, 495
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 491, 492, 493, 494, 495"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3892
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 469
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 469"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Source Code 4000 Series Cannot Use Project Code 000, 299, 300 Series
                    Case 4000 To 4999
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 0, 299, 300 To 399
                                errordescr = "ERROR: Source Code " & idim4 & " Cannot Use Project Code 000, 299, 300 Series"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4120
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 594, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 594, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4130
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 591, 592, 593, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 591, 592, 593, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim2
                            Case 11, 21
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 21"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4140
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 561, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 561, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4150, 4161, 4162, 4163, 4164, 4165, 4166, 4170
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 770, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 770, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4180
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 588, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 588, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4210
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 511, 515, 517, 518, 785, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 511, 515, 517, 518, 785, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4213
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 502, 503, 504, 516, 519, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 502, 503, 504, 516, 519, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4230
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 521, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 521, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4240
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 531, 532, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 531, 532, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4271
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 511, 541, 543, 546, 548, 586, 785, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 511, 541, 543, 546, 548, 586, 785, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4273
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 542, 544, 545, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 542, 544, 545, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4281
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 571, 572, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 571, 572, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4310
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 613, 615, 621, 623, 625, 626, 627, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 613, 615, 621, 623, 625, 626, 627, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4340
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 641, 642, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 641, 642, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4350
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 651, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 651, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4441
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 541, 546, 586, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 541, 546, 586, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4443
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 553, 554, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 553, 554, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4461
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 586, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 586, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4462
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 558, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 558, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4470
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 587, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 587, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4480
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 596, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 596, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4550
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 563, 564, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 563, 564, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4560
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 691, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 691, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4580
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 698, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 698, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4611
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 731, 732, 733, 734, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 731, 732, 733, 734, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4613
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 735, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 735, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4616
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 454, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 454, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4617
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 456, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 456, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4618
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 457, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 457, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4685
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 781, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 781, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Source Code 4700 Series Can Only Use Fund Code 11, 12, 22
                    Case 4700 To 4799
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11, 12, 22
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 12, 22"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim5
                            Case 700
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4710
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 763
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 763"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4720
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 764
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 764"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4730
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 765
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 765"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4740
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 766
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 766"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4750
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 769
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 769"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4760
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 768
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 768"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4770
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 767
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 767"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim5
                            Case 700
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4780
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 791
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 791"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4790
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 790
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 790"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4821
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 421, 422, 423, 424, 426, 427, 429, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 421, 422, 423, 424, 426, 427, 429, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4836
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 436, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 436, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4847
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 447, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 447, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4850
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 451, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 451, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4852
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 452, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 452, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4867
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 467, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 467, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4868
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 468, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 468, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4874
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 474, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 474, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4876 Can Only Use Project Code 476, 799
                    Case 4876
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 476, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 476, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Source Code 4877 Can Only Use Project Code 477, 799
                    Case 4877
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 477, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 477, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4881 Can Only Use Project Code 481, 799
                    Case 4881
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 790
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 481, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4882 Can Only Use Project Code 484, 799
                    Case 4882
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 484, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 484, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4886 Can Only Use Project Code 486
                    Case 4886
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 486
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 486"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 5200 Can Only Use Fund Code 11
                    Case 5200
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund 11"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'todo 3.22.2017 12:45am  Mark
                        'Source Code 5200 Must Be 0 Balance Fund Code!
                        'Source Code 5300 Must Be 0 Balance Fund Code !

                End Select
                '===============================SOURCE CODE=====================================================================================
                '                                  END
                '===============================================================================================================================
                '===============================PROGRAM CODE=====================================================================================
                '                                  START
                '===============================================================================================================================
                Select Case idim5
                    Case 277
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 308
                            Case Else
                                errordescr = "ERROR: Program Code " & idim5 & " Can Only Use Project Code 308"
                                errorphase = "2"
                                errorval = dim5
                                valid = False
                                GoTo Errorhandle
                        End Select
                End Select

                'Program Code 700 Can Only Use Source Code 1310, 1510, 1550, 1590, 1670, 1680, 1700 Series, 3250, 6000 Series, 3700 Series, 4130, 4700
                'Series, 5000 Series
                Select Case idim5
                    Case 700
                        RecordCount = RecordCount + 1
                        Select Case idim4
                            Case 1310, 1510, 1550, 1590, 1670, 1680
                            Case 1700 To 1799
                            Case 3250
                            Case 3700 To 3799
                            Case 4130
                            Case 4700 To 4799
                            Case 5000 To 6999

                            Case Else
                                errordescr = "ERROR: Program Code " & idim5 & " Not Valid Against Source: " & idim4
                                errorphase = "2"
                                errorval = dim5
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Program Code 700 Can Only Use Project Code 000, 331, 332, 334, 335, 385, 591, 791, 760 Series, 800 Series
                        Select Case idim3
                            Case 0
                            Case 331, 332, 334, 335, 385, 591, 791
                            Case 3250
                            Case 760 To 769
                            Case 800 To 899
                            Case Else
                                errordescr = "ERROR: Program Code " & idim5 & " Not Valid Against Project: " & idim3
                                errorphase = "2"
                                errorval = dim5
                                valid = False
                                GoTo Errorhandle
                        End Select
                End Select

                '===============================PROGRAM CODE=====================================================================================
                '                                  END
                '===============================================================================================================================


                'idim2 & idim3 & idim4 & idim5 & idim6    If SchoolNumber = 880 Then
                ' Case (Left$(idim4, 1) = "3") Or (Left$(idim4, 1) = "4")


                'If idim3 = "385" And (idim2 <> "11" And idim2 <> "22") Then
                '    errordescr = "ERROR: PROJECT 385 MUST BE USED IN FUND 11 OR 22"
                '    errorphase = "2"
                '    errorval = dim4 

                'End If

                'cONDITION CAHNGED RE: pAT 04-2012
                'If Left(idim4, 2) = "17" Then
                '    If idim3 <> "385" And idim3 <> "766" And idim3 <> "769" Then
                '       errordescr = "ERROR: SOURCES IN 1700''s MUST USE PROJECT 385 OR 766 OR 769"
                '       errorphase = "2"
                '       errorval = dim4 


                '   End If
                'End If


                '  If idim2 = "22" And idim4 = "6110" And idim5 = "000" Then
                '      errordescr = "ERROR: FUND 22 MUST USE PROGRAM CODE 700"
                '      errorphase = "2"
                '      errorval = dim4 


                '  End If

                If idim6 = 0 Then
                    RecordCount = RecordCount + 1
                    errordescr = "ERROR: UNIT CANNOT BE 000"
                    errorphase = "2"
                    errorval = dim6
                    valid = False
                    GoTo Errorhandle
                End If







                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                ''Select Case idim3
                ''    Case 0 To 298      'fund 60 project 000 to 298 school assgined for child nur.
                ''        valid = False
                ''        If idim5 >= 700 And idim5 <= 799 Then valid = True
                ''        If Not valid Then
                ''            errorval = dim5
                ''            errorphase = "2"
                ''            errordescr = "Prog invalid for project 000-298."
                ''            GoTo Errorhandle
                ''        End If
                ''    Case 306
                ''        Select Case idim4
                ''            Case 3490, 6110
                ''                valid = True
                ''            Case Else
                ''                valid = False
                ''                errorval = dim4 

                ''                errorphase = "2"
                ''                errordescr = "Source invalid for project 306."
                ''                GoTo Errorhandle
                ''        End Select

                ''    Case 385        'source validation
                ''        valid = False
                ''        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                ''        If Not valid Then
                ''            errorval = dim4 

                ''            errorphase = "2"
                ''            errordescr = "Source invalid for project 385."
                ''            GoTo Errorhandle
                ''        End If
                ''    Case 800        'fund 60 only
                ''        valid = True
                ''    Case Else       'all other projects fail
                ''        valid = False
                ''        errorval = dim3 

                ''        errorphase = "2"
                ''        errordescr = "Project invalid for fund 60."
                ''        GoTo Errorhandle
                ''End Select

                ''''''''''''''''''''''''''''''''''''''''
                '''validate the source
                ''''''''''''''''''''''''''''''''''''''''
                ''Select Case idim4
                ''    Case 1100 To 1199
                ''        valid = False
                ''        errordescr = "Source invalid for fund 60."
                ''    Case 1200 To 1299
                ''        valid = True
                ''    Case 1300 To 1699
                ''        valid = True
                ''    Case 1700 To 1799
                ''        valid = False
                ''        If idim3 >= 0 And idim3 <= 298 Then valid = True
                ''        If idim5 >= 700 And idim5 <= 799 Then valid = True
                ''        If Not valid Then
                ''            errorval = dim5
                ''            errorphase = "2"
                ''            errordescr = "Source valid with prj 000-298 & prg 700"
                ''            GoTo Errorhandle
                ''        End If
                ''    Case 1800 To 1899
                ''        valid = True
                ''    Case 1900 To 1999
                ''        If idim3 = 800 Then
                ''            errordescr = ""
                ''            valid = True
                ''        Else
                ''            valid = False
                ''            errordescr = "Source invalid for project " & dim3 & "."
                ''        End If
                ''    Case 2000 To 4999
                ''        valid = False
                ''        errordescr = "Source invalid for fund 60."
                ''    Case 5111, 5112, 5113, 5120, 5130, 5150, 5160, 5190
                ''        valid = True
                ''    Case 5200
                ''        errordescr = "Source valid for zero amount."
                ''        valid = True
                ''        'changed from false to true from ocas edit check 2017 DB
                ''    Case 5300
                ''        valid = True
                ''    Case 5600, 5800
                ''        valid = True
                ''    Case 6110, 6130, 6140
                ''        valid = True
                ''    Case 6200
                ''        valid = True
                ''    Case Else
                ''        valid = False
                ''        errordescr = "Source invalid for fund 60."
                ''End Select
                ''If Not valid Then
                ''    errorval = dim4 

                ''    errorphase = "2"
                ''    errordescr = "Error: " + errordescr
                ''    GoTo Errorhandle
                ''End If

                ''''''''''''''''''''''''''''''''''''''''
                '''validate the program
                ''''''''''''''''''''''''''''''''''''''''
                ''Select Case idim5
                ''    Case 700
                ''        valid = False
                ''        If idim3 >= 0 And idim3 <= 298 Then valid = True
                ''        If idim3 = 385 Then valid = True
                ''        If idim3 = 800 Then valid = False
                ''        If Not valid Then
                ''            errorval = dim5
                ''            errorphase = "2"
                ''            errordescr = "Program valid for proj 000-298 & 385."
                ''            GoTo Errorhandle
                ''        End If
                ''    Case 800
                ''        valid = True
                ''    Case 900
                ''        valid = False
                ''        If idim3 <> 385 Then valid = True
                ''        If idim3 >= 0 And idim3 <= 298 Then valid = False
                ''        If Not valid Then
                ''            errorval = dim5
                ''            errorphase = "2"
                ''            errordescr = "Program invalid for proj 000-298 & 385."
                ''            GoTo Errorhandle
                ''        End If
                ''    Case Else
                ''        valid = False
                ''        errorval = dim5
                ''        errorphase = "2"
                ''        errordescr = "Error: Program invalid for fund 60."
                ''        GoTo Errorhandle
                ''End Select

                ''''''''''''''''''''''''''''''''''''''''
                '''validate the site
                ''''''''''''''''''''''''''''''''''''''''

                ''Dim mysite As String = Me.DistrictId
                ''Dim myopunit As Char
                ''myopunit = GetChar(mysite, 1)

                ''Select Case idim6
                ''    Case idim6
                ''        valid = True
                ''    Case Else
                ''        valid = False
                ''        errorval = dim6
                ''        errorphase = "2"
                ''        errordescr = "Error: Site invalid for fund 60."
                ''        GoTo Errorhandle
                ''End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function




    '     Future Function - split dim check: Public Function ExpDim2Fund_EditCheck() As Boolean
    '        'phase 2 performs the edit checks for the dimensions used. at this
    '        'point, the codes have already been rolled to the bold.  Note: the 
    '        'phaseerror will be accessed to determine if this item should run 
    '        'thru the edit checks.  If an item failed in phase 1, then it will
    '        'be skipped in this phase.


    '        '****Mark added - set default - we are addng other funds and all coding, so we can incorporate code in merge Program**
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        '     0           1         2        3        4        5   
    '        '   bank       fisyr    docnumber   amt    count   revenuecode
    '        '     6           7         8        9       10
    '        '   descr     remarks   created    ttype -- NOT USED --
    '        '    11          12        13       14       15   
    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
    '        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
    '        Dim expendcode, boldcode, boldcodefmt As String
    '        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
    '        Dim currow, rowindex As Int32
    '        Dim valid As Boolean
    '        '3.29.2017, Mark;  errorphase = "2"   - error caught in phase2 checking


    '        valid = True 'mark added - set default
    '        Try

    '            For currow = 0 To Me.GridDetail.Rows.Count - 1
    '                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
    '                If phaseerror <> "0" Then GoTo Skiprecord

    '                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
    '                dim1 = expendcode.Substring(0, 1)
    '                dim2 = expendcode.Substring(1, 2)
    '                dim3 = expendcode.Substring(3, 3)
    '                dim4 = expendcode.Substring(6, 4)
    '                dim5 = expendcode.Substring(10, 3)
    '                dim6 = expendcode.Substring(13, 3)
    '                dim7 = expendcode.Substring(16, 4)
    '                dim8 = expendcode.Substring(20, 3)
    '                dim9 = expendcode.Substring(23, 3)
    '                'convert to ints
    '                idim1 = CInt(dim1)
    '                idim2 = CInt(dim2)
    '                idim3 = CInt(dim3)
    '                idim4 = CInt(dim4)
    '                idim5 = CInt(dim5)
    '                idim6 = CInt(dim6)
    '                idim7 = CInt(dim7)
    '                idim8 = CInt(dim8)
    '                idim9 = CInt(dim9)

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the fund DIM 2
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim2
    '                    '****Mark added - set default - we are addng other funds so we can incorporate code in merge Program**
    '                    'Added Fund checks 4.10.2017, Mark;
    '                Case 11, 12, 21, 22, 24, 25, 26, 30 To 39, 41, 50, 60, 80 To 89
    '                        valid = True
    '                        If dim4.Length < 4 Then valid = False
    '                        If idim4 = 0 Then valid = False
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If
    '                        'Added 4.10.2017, Mark;
    '                    Case 11, 12, 21, 22, 24, 25, 26, 30 To 39, 41, 50, 60, 80 To 89
    '                        valid = True
    '                        If dim5.Length < 3 Then valid = False
    '                        If idim3 = 0 Then valid = False
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim4
    '                            GoTo Errorhandle
    '                        End If
    '                        'Added 4.10.2017, Mark;
    '                    Case 21
    '                        valid = True
    '                        If idim4 = 2700 Then
    '                            'hulbert
    '                            If SchoolNumber = "337" Then
    '                                valid = True
    '                            Else
    '                                valid = False
    '                            End If
    '                        End If
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 22
    '                        valid = True
    '                        Select Case idim4
    '                            Case 3100 To 3199, 5200, 5300, 5400, 5600, 5700, 5800, 8000 To 8999
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 22
    '                        valid = True
    '                        Select Case idim6
    '                            Case 239, 700
    '                                If idim6 = 293 Then
    '                                    If idim3 = 456 Then
    '                                        valid = True
    '                                    Else
    '                                        valid = False
    '                                    End If
    '                                End If
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim6
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 41
    '                        valid = True
    '                        Select Case idim5
    '                            Case 310, 833
    '                                valid = False
    '                            Case Else
    '                                valid = True
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 41
    '                        valid = True
    '                        Select Case idim4
    '                            Case 5100, 5200, 5600
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 60
    '                        valid = True
    '                        Select Case idim3
    '                            Case 421 To 799
    '                                valid = False
    '                            Case Else
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim3
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Project " & dim3
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 60
    '                        valid = True
    '                        If dim6.Length < 3 Then valid = False
    '                        If idim6 = 0 Then
    '                            Select Case idim4
    '                                Case 2321, 2410
    '                                    valid = True
    '                                Case Else
    '                                    valid = False
    '                            End Select
    '                        End If
    '                        If Not valid Then
    '                            errorval = dim6
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 82
    '                        valid = True
    '                        Select Case idim4
    '                            Case 2317, 2511, 2572, 7600, 7710, 7720, 7800
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 83
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7400
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 84
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7500
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 85
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7710, 7720, 7730, 7740
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 87
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7400
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 88
    '                        valid = True
    '                        Select Case idim4
    '                            Case 5900
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If
    '                    Case Else
    '                        valid = True
    '                End Select

    'Errorhandle:
    '                If valid = False Then
    '                    Me.HasErrors = True
    '                    With Me.GridDetail
    '                        .SetData(currow, 11, errorphase)
    '                        .SetData(currow, 14, errorval)
    '                        .SetData(currow, 15, errordescr)
    '                    End With
    '                End If
    '                'clear the vars
    '                errorphase = "0"
    '                errorval = ""
    '                errordescr = ""
    'Skiprecord:
    '            Next

    '        Catch ex As Exception
    '            Throw
    '        End Try

    '    End Function


#End Region

#Region "  Methods 2018 Edit Checks "

    Private Function Expenditure2018_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 0) And (temp3 <= 298) Then
                dim3 = "000"
            Else
                dim3 = "800"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 700) And (temp6 <= 799) Then
                dim6 = "700"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next

    End Function

    Private Function Expenditure2018_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.


        '****Mark added - Set default - we are Adding other funds and Complete coding, in order to Incorporate code in Merge Program**
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean
        '3.29.2017, Mark;  errorphase = "2"   - error caught in phase2 checking


        valid = True 'mark added - set default
        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                If Me._editchk = True Then
                    expendcode = _expendcode
                    _ExpenseCodeFlag = True
                    currow = Me.GridDetail.Rows.Count - 1
                End If


                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)


                'check fund
                ' ValidateDim2FundExpense(expendcode)
                'ValidateDim3Project(expendcode)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund DIM 2
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'Me.ExpDim2Fund_EditCheck()--for future application - split Dim Functions

                Select Case idim2
                    '****Mark added - set default - we are addng other funds so we can incorporate code in merge Program**
                    'Added Fund checks 4.10.2017, Mark;

                    Case 11
                        valid = True
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim4
                            GoTo Errorhandle
                        End If
                        'Added 4.10.2017, Mark;
                    Case 21
                        valid = True
                        If idim4 = 2700 Then
                            'hulbert
                            If SchoolNumber = "337" Then
                                valid = True
                            Else
                                valid = False
                            End If
                        End If
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 22
                        valid = True
                        Select Case idim4
                            Case 3100 To 3199, 5200, 5300, 5400, 5600, 5700, 5800, 8000 To 8999
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        valid = True
                        Select Case idim6
                            Case 239, 700
                                If idim6 = 293 Then
                                    If idim3 = 456 Then
                                        valid = True
                                    Else
                                        valid = False
                                    End If
                                End If
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 41
                        valid = True
                        Select Case idim5
                            Case 310, 833
                                valid = False
                            Case Else
                                valid = True
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 41
                        valid = True
                        Select Case idim4
                            Case 5100, 5200, 5600
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If
              'Added 4.10.2017, Mark;
                    Case 60
                        valid = True
                        If dim6.Length < 3 Then valid = False
                        If idim6 = 0 Then
                            Select Case idim4
                                Case 2321, 2410
                                    valid = True
                                Case Else
                                    valid = False
                            End Select
                        End If

                        Select Case idim3
                            Case 421 To 799
                                valid = False
                            Case Else
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        'If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Project " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 82
                        valid = True
                        Select Case idim4
                            Case 2317, 2511, 2572, 7600, 7710, 7720, 7800
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 83
                        valid = True
                        Select Case idim4
                            Case 7400
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 84
                        valid = True
                        Select Case idim4
                            Case 7500
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 85
                        valid = True
                        Select Case idim4
                            Case 7710, 7720, 7730, 7740
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 87
                        valid = True
                        Select Case idim4
                            Case 7400
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 88
                        valid = True
                        Select Case idim4
                            Case 5900
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                    Case Else

                        valid = False
                        'we did not find a code
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid"
                            GoTo Errorhandle
                        End If
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project DIM 3
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
#Region " Dim 3 PROJECT"



                'Added 4.10.2017, Mark;
                Select Case idim3
                    Case 0 To 310, 312 To 317, 320 To 398
                        valid = True
                        Select Case idim4
                            Case 1000, 2120, 2213, 2220, 2400 To 2399
                                If dim9.Length < 3 Then valid = False
                                If idim9 = 0 Then valid = False
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Oper Unit "
                            GoTo Errorhandle
                        End If


                        'Added 4.10.2017, Mark;
                    Case 301
                        valid = True
                        Select Case idim5
                            Case 172, 182, 200
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 308
                        valid = True
                        Select Case idim6
                            Case 277
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 308
                        valid = True
                        Select Case idim4
                            Case 2213, 2544, 2573
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 312
                        valid = True
                        Select Case idim4
                            Case 1000, 2120, 2140, 2152, 2153, 2220, 5600
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 316
                        valid = True
                        Select Case idim4
                            Case 2213, 2573, 5600, 8100
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 316
                        valid = True
                        Select Case idim5
                            Case 170, 200 To 299, 890, 930
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 317
                        valid = True
                        Select Case idim4
                            Case 1000, 5600, 8100
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 319
                        valid = True
                        Select Case idim6
                            Case 500 To 599
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 326
                        valid = False
                        If SchoolNumber = "134" Then valid = True ''134 - Cushing
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with District Number "
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 331
                        valid = True
                        Select Case idim5
                            Case 115, 231, 232, 273
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 331, 332, 334, 335
                        valid = True
                        Select Case idim4
                            Case 2321
                                Select Case idim8
                                    Case 101, 106, 107, 609, 612, 613, 690
                                        valid = True
                                    Case Else
                                        valid = False
                                End Select
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 332
                        valid = True
                        Select Case idim5
                            Case 125, 241, 242, 283, 930
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 334
                        valid = True
                        Select Case idim5
                            Case 115, 212, 213, 214, 215, 216, 217, 218, 231, 232, 273
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 335
                        valid = True
                        Select Case idim5
                            Case 125, 222, 223, 224, 225, 226, 227, 228, 241, 242, 283, 930
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 338
                        valid = True
                        Select Case idim4
                            Case 2194, 5600, 8100
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 360
                        valid = True
                        Select Case idim6
                            Case 260 To 269
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 361, 362
                        valid = True
                        Select Case idim6
                            Case 426, 441, 442
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 367
                        valid = True
                        Select Case idim6
                            Case 427, 441
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 385
                        valid = True
                        Select Case idim4
                            Case 3120, 3130, 3140, 3150, 3160, 3180, 3190, 3200, 5200, 5300, 5600, 5700, 5800, 8100
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 385
                        valid = True
                        Select Case idim6
                            Case 700
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 385
                        valid = True
                        Select Case idim2
                            Case 11, 22
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark;
                    Case 388
                        valid = True
                        Select Case idim6
                            Case 430
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 388
                        valid = True
                        Select Case idim8
                            Case 700
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Job Code " & dim8
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 397
                        valid = True
                        Select Case idim4
                            Case 2132, 5600, 8100
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 398
                        valid = True
                        Select Case idim5
                            Case 170, 171, 200 To 299
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 400 To 495
                        valid = True
                        Select Case idim6
                            Case 300 To 399
                            Case 500 To 599
                            Case Else
                                If idim3 = 456 Then
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 400 To 495
                        valid = True
                        Select Case idim7
                            Case 0, 4400, 5000
                            Case 8000 To 9999
                            Case Else
                                If idim3 = 456 Then
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Subject " & dim7
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark;
                    Case 421, 422, 423, 424
                        valid = True
                        Select Case idim6
                            Case 330 To 390
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark (Exceptions for Sile and Silina not included);
                    Case 423
                        valid = True
                        Select Case idim2
                            Case 12
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 456
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark FOR MIDEWEST only;
                    Case 485
                        valid = False
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with your District"
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 502, 503, 504, 515, 516, 518, 519
                        valid = True
                        Select Case idim6
                            Case 424, 429, 441, 442, 494
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 511
                        valid = True
                        Select Case idim6
                            Case 425, 429, 441, 442, 494, 495
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 511
                        valid = True
                        Select Case idim8
                            Case 0, 101, 106, 108, 110, 112, 202, 203, 204, 206, 207, 210, 211, 214, 315, 321, 322, 350, 341, 352, 354
                            Case 356, 359, 401, 402, 406, 410, 411, 413, 414, 415, 615, 801, 803, 951, 954, 961
                            Case Else
                                If idim4 = 2213 Or idim4 = 2573 Then
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Job Code " & dim8
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 517, 531, 532
                        valid = True
                        Select Case idim6
                            Case 424, 429, 494
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 521
                        valid = True
                        Select Case idim6
                            Case 429, 494
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark (Exceptions for Sile and Silina not included);
                    Case 542, 544
                        valid = True
                        Select Case idim2
                            Case 11, 12
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 553
                        valid = True
                        Select Case idim4
                            Case 1000 To 3190, 5400
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 553
                        valid = True
                        Select Case idim6
                            Case 500 To 799
                                valid = False
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 553, 554
                        valid = True
                        Select Case idim6
                            Case 490
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark 'Waynoka exception;
                    Case 563, 691
                        valid = True
                        Select Case idim6
                            Case 700
                                If SchoolNumber = "870" Then
                                Else
                                    valid = False
                                End If
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 571, 572
                        valid = True
                        Select Case idim6
                            Case 410
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 592, 613, 615, 621, 625, 641, 642, 651
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 593
                        valid = True
                        Select Case idim4
                            Case 4000 To 4999
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 596
                        valid = True
                        Select Case idim6
                            Case 425, 495
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 610 To 619, 621, 625, 626, 640 To 649
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 623
                        valid = True
                        Select Case idim6
                            Case 100, 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 627
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 641
                        valid = True
                        Select Case idim7
                            Case 1010 To 1019, 1020 To 1029, 1041
                            Case Else
                                Select Case idim4
                                    Case 2132, 2135, 2140, 2152, 2153, 2170, 2180, 2720, 5400
                                    Case Else
                                        valid = False
                                End Select
                        End Select
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Subject " & dim7
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 642
                        valid = True
                        Select Case idim7
                            Case 1010 To 1019
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Subject " & dim7
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark Union Exception;
                    Case 731, 732, 733, 734, 735
                        valid = True
                        Select Case idim4
                            Case 1000 To 3300, 7000 To 8999
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark ;
                    Case 731 To 734
                        valid = True
                        Select Case idim6
                            Case 500 To 599
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                    Case 760 To 769, 791
                        valid = True
                        Select Case idim6
                            Case 700
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 760 To 769, 791
                        valid = True
                        Select Case idim4
                            Case 2199, 3110, 3155
                                valid = False
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 763, 764
                        valid = True
                        Select Case idim2
                            Case 11, 12
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 763, 764, 765, 766, 768, 769, 791
                        valid = True
                        Select Case idim4
                            Case 3120, 3130, 3140, 3150, 3160, 3180, 3190, 5200, 5300, 5400, 5600, 5700, 8000 To 8999
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark;
                    Case 767
                        valid = True
                        Select Case idim6
                            Case 700
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 767
                        valid = True
                        Select Case idim4
                            Case 3180
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 768
                        valid = True
                        Select Case idim9
                            Case 50
                                If idim4 = 3140 Then
                                Else
                                    valid = False
                                End If
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Oper Unit " & dim9
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 799
                        valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Expenditures"
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark;
                    Case 800 To 998
                        valid = True
                        Select Case idim2
                            Case 60
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        'old project check < 2017

                        ''Case 0 To 298               'fund 60 only
                        ''    valid = False
                        ''    If idim6 >= 700 And idim6 <= 799 Then valid = True

                        ''    If Not valid Then
                        ''        errorval = dim6
                        ''        errorphase = "2"
                        ''        errordescr = "Error: Program invalid for proj 000-298."
                        ''        GoTo Errorhandle
                        ''    End If
                        ''Case 385        'project to function validation

                        ''    'If idim4 >= 3100 And idim4 <= 3199 Then valid = True
                        ''    'If idim4 >= 3200 And idim4 <= 3299 Then valid = True
                        ''    'If idim4 >= 4000 And idim4 <= 4999 Then valid = True
                        ''    'If idim4 >= 5200 And idim4 <= 5299 Then valid = True
                        ''    'If idim4 >= 5300 And idim4 <= 5399 Then valid = True
                        ''    'If idim4 >= 5600 And idim4 <= 5699 Then valid = True
                        ''    'If idim4 >= 5800 And idim4 <= 5899 Then valid = True
                        ''    '    If idim4 >= 8100 And idim4 <= 8199 Then valid = True
                        ''    'If idim4 >= 8900 And idim4 <= 8999 Then valid = False

                        ''    errorval = dim3
                        ''    errorphase = "2"
                        ''    errordescr = "Error: Project invalid for fund 60."
                        ''    GoTo Errorhandle

                        ''Case 421 To 791             'fund 60 only not valid
                        ''    valid = False
                        ''Case 800 To 998             'fund 60 only
                        ''    valid = True
                        ''Case Else                   'all other projects fail
                        ''    valid = False
                        ''    errorval = dim3
                        ''    errorphase = "2"
                        ''    errordescr = "Error: Project invalid for fund 60."
                        ''    GoTo Errorhandle
                End Select



#End Region

#Region " Dim 4 FUNCTION"


                'idim4 = 2573
                'dim4 = "2573" --test
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function  DIM 4
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4
                    Case 1000
                        valid = True
                        '4.11.2017 Custom Edit Mark;

                        Select Case idim5
                            Case 100 To 199, 641, 642, 643, 644, 645
                                Select Case idim5
                                    Case 130 To 139, 140 To 149
                                        Select Case idim8
                                            Case 214, 315, 328, 405, 413, 415
                                            Case Else
                                                If idim7 = 0 Then valid = False
                                        End Select
                                        Select Case idim6
                                            Case 421, 511 To 590
                                            Case Else
                                                If idim7 = 0 Then valid = False
                                        End Select
                                        Select Case idim3
                                            Case 731 To 735
                                            Case Else
                                                If idim7 = 0 Then valid = False
                                        End Select
                                End Select
                            Case Else
                        End Select

                        Select Case idim5
                            Case 110 'line5
                                If idim8 = 214 Then
                                    If idim7 = 0 Then valid = False
                                End If
                            Case 100 To 110, 200 To 299
                                If idim5 <> 130 Or idim5 <> 140 Then
                                    If idim9 <> 50 Then valid = False
                                End If
                                Select Case idim6
                                    Case 511 To 590, 441442, 490 To 499
                                    Case Else
                                        If idim9 <> 50 Then valid = False
                                End Select
                                Select Case idim8
                                    Case 213, 214, 328, 346, 406, 409, 413, 414, 415, 963
                                    Case Else
                                        If idim9 <> 50 Then valid = False
                                End Select
                        End Select

                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Function " & dim4 & " Invalid per Custom Edit Check Line 2-7"
                            GoTo Errorhandle
                        End If

                        'Case 1000
                        '    If idim6 = 0 Then   'Added by Dan, 2016.05.10;
                        '        errorval = dim6
                        '        errorphase = "2"
                        '        errordescr = "Error: Program code required for function 1000."
                        '        GoTo Errorhandle
                        '    End If


                        'Rewrote mark^^
                        'If idim5 = 641 And idim7 = 0 Then valid = False
                        'If idim5 = 642 And idim7 = 0 Then valid = False
                        'If idim5 = 643 And idim7 = 0 Then valid = False
                        'If idim5 = 644 And idim7 = 0 Then valid = False
                        'If idim5 = 645 And idim7 = 0 Then valid = False
                        'If Not valid Then
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Subject required for function 1000."
                        '    errordescr = "Error: Function " & dim4 & " Invalid with Object " & dim5
                        '    GoTo Errorhandle
                        'End If






                    Case 1500
                        valid = False 'Only true for Mid-Del mark 3.22.2017
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2112 'Added Dan 3.22.2017
                        valid = True
                        If dim5.Substring(0, 1) = "1" Then
                            Select Case dim8 'Corrected to dim 8,was Dim9 Mark, 3.29.2017
                                Case "000", "109", "214", "304", "308", "348", "356", "604", "609", "614", "615"
                                Case Else
                                    valid = False
                            End Select
                        End If

                        'validate the site with this function 'Error discription, Mark update 3.29.2017
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        'removed 3.29.2017, Mark;
                        'If idim9 = 50 Then
                        '    valid = False
                        'End If
                        'validate the site with this function

                        'added 3.29.2017, Mark;
                        Select Case idim8
                            Case 0, 109, 214, 313, 322, 352, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If



                    Case 2120
                        valid = True
                        'removed 3.29.2017, Mark;
                        'If idim9 = 50 Then valid = False
                        'validate the site with this function


                        'added 3.29.2017, Mark;
                        Select Case idim8
                            Case 0, 109, 110, 202, 203, 214, 348, 401, 404, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 3.29.2017, Mark
                    Case 2132
                        valid = True

                        Select Case idim8
                            Case 0, 109, 110, 214, 328, 333, 339, 347, 360, 409, 507, 609, 614, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function Dan commented out 240
                        If idim6 = 239 Then valid = True
                        'If idim6 = 240 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                        'added 3.29.2017, Mark
                        Select Case idim8
                            Case 0, 214, 334, 416, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                    Case 2140
                        valid = False
                        If idim6 = 239 Then valid = True
                        If idim6 = 430 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Programs 239 or 430."
                            GoTo Errorhandle
                        End If
                        'added 3.29.2017, Mark
                        valid = True
                        Select Case idim8
                            Case 0, 205, 214, 343, 412, 510, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2152
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If
                        'added 3.29.2017, Mark
                        valid = True
                        Select Case idim8
                            Case 0, 110, 214, 215, 216, 351, 353, 512, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2153
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If

                        'added 3.29.2017, Mark
                        valid = True
                        Select Case idim8
                            Case 0, 110, 214, 309, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 3.29.2017, Mark
                    Case 2170
                        valid = True
                        Select Case idim8
                            Case 0, 214, 338, 417, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2194
                        valid = True
                        Select Case idim8
                            Case 0, 110, 214, 322, 328, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2212
                        valid = True
                        Select Case idim8
                            Case 0, 101, 107 To 110, 204, 210 To 212, 214, 305, 354, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'added 4.11.2017, Custom Edit, Mark
                    Case 2213
                        valid = True
                        Select Case idim5
                            Case 110
                                Select Case idim8
                                    Case 210, 214, 413, 414
                                        If idim7 = 0 Then valid = False
                                    Case Else
                                End Select
                            Case Else

                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error Custom: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2220
                        valid = True
                        'removed 4.1.2017, Mark
                        'If idim9 = 50 Then valid = False
                        Select Case idim8
                            Case 0, 109, 110, 206, 214, 410, 411, 508, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2230
                        valid = True
                        Select Case idim8
                            Case 0, 109, 214, 315, 324, 332, 406, 502, 603
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2240
                        valid = True
                        Select Case idim8
                            Case 0, 108, 214, 321, 409, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.11.2017, Custom Edit, Mark
                    Case 2312
                        valid = True
                        Select Case idim5
                            Case 100 To 299, 525 'custom conflict
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error Custom: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'added 4.1.2017, Mark
                    Case 2313, 2318
                        valid = True
                        Select Case idim5
                            Case 100 To 299, 310, 525
                            Case 320
                                valid = False
                            Case Else
                                If idim4 = 2313 And idim5 = 525 Then
                                    valid = True
                                Else
                                    valid = False
                                End If
                        End Select
                        Select Case idim6 'Prog
                            Case 0, 251, 426, 800, 900
                                If idim4 = 2321 Then
                                    valid = True
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'added 4.1.2017, Mark
                    Case 2317
                        valid = True
                        Select Case idim5
                            Case 3330
                                valid = False
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2321
                        valid = True
                        Select Case idim5
                            Case 100 To 299, 310, 525
                            Case Else
                                errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                        End Select
                        If idim5 = 320 Then
                            valid = False
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                        End If

                        Select Case idim6 ' prog
                            Case 0, 251, 426, 800, 900
                            Case Else
                                valid = False
                                errordescr = "Error: Program Code " & dim6 & " Invalid with Function " & dim4
                        End Select
                        Select Case idim8 ' prog
                            Case 0, 101, 106, 107, 115, 214, 609, 612, 613, 690
                            Case Else
                                valid = False
                                errordescr = "Error: Object Code " & dim8 & " Invalid with Function " & dim4
                        End Select

                        Select Case idim3
                            Case 421 To 589, 592 To 799
                                valid = False
                                errordescr = "Error: Project Code " & dim3 & " Invalid with Function " & dim4
                            Case Else
                                valid = True
                        End Select
                        If idim3 = 591 Then
                            If idim5 = 525 Then
                                valid = True
                            Else
                                valid = False
                                errordescr = "Error: Project Code " & dim3 & " Invalid with Function " & dim4
                            End If
                        End If
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If



                        'added 4.11.2017, Custom Edit, Mark


                        'removed 4.1.2017, Mark
                        'Case 2410
                        'valid = True
                        'If idim6 = 100 Then valid = False
                        'If idim9 = 50 Then valid = False
                        'If Not valid Then
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Site 050 or program 100 not valid for function."
                        '    GoTo Errorhandle
                        'End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                        'removed 4.1.2017, Mark
                        ' Case 2490
                        'valid = True
                        'If idim9 = 50 Then valid = False
                        'If Not valid Then
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Site 050 not valid for function."
                        '    GoTo Errorhandle
                        'End If

                        'added 4.11.2017, Custom Edit, Mark
                    Case 2511
                        valid = True
                        Select Case idim5
                            Case 100 To 299
                                Select Case idim5
                                    Case 301, 601
                                    Case Else
                                        valid = False
                                        errordescr = "Error Custom: Object Code " & idim5 & " Invalid with Function " & dim4
                                End Select
                            Case Else 'conflicts with  custom code
                                'If idim4 = 2511 And idim5 = 525 Then
                                '    valid = True
                                'Else
                                '    valid = False
                                '    errordescr = "Error Custom: Object Code " & idim5 & " Invalid with Function " & dim4

                                'End If
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = errordescr
                            GoTo Errorhandle
                        End If


                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2573
                        valid = True
                        Select Case idim8
                            Case 210, 213
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.11.2017, Custom Edit, Mark
                        'Case 2573
                        valid = True
                        Select Case idim5
                            Case 110
                                Select Case idim8
                                    Case 210, 214, 413, 414
                                        If idim7 = 0 Then valid = False
                                    Case Else
                                End Select
                            Case Else
                                ' valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error Custom: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2580
                        valid = True
                        Select Case idim8
                            Case 0, 109, 110, 214, 314, 315, 324, 332, 406, 502, 513, 603, 604, 615
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2660
                        valid = True
                        Select Case idim8
                            Case 0, 109, 409, 513, 605, 607, 615, 959, 961, 964
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2670
                        valid = True
                        Select Case idim8
                            Case 0, 109, 110, 409, 506, 607, 951, 957, 959, 964
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2720
                        valid = True
                        Select Case idim8
                            Case 0, 109, 110, 513, 605, 609, 615, 801 To 803
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2730
                        valid = True
                        Select Case idim8
                            Case 0, 951
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        'replaced 4.1.2017, Mark
                        'Case 3100 To 3199
                        '    valid = False
                        '    If idim3 = 0 And idim6 = 700 Then valid = True
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Function invalid for fund 60."
                        '    GoTo Errorhandle

                        'added 4.1.2017, Mark
                    Case 3100 To 3199
                        valid = True
                        If idim6 = 700 Then
                            If idim3 = 456 Or idim3 = 553 Or idim3 = 691 Then
                                valid = False
                            End If
                        Else
                            valid = False
                        End If
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim6 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 3110
                        valid = True
                        Select Case idim3
                            Case 385, 760 To 769, 791
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project Code " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 3120
                        valid = True
                        Select Case idim8
                            Case 0, 109, 110, 214, 319, 511, 513, 602, 609, 612, 614, 615, 953, 955, 958, 964
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 5.15.2018, Dan
                    Case 3155
                        valid = True
                        Select Case idim3
                            Case < 0
                                '385, 760 To 769, 791
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Project Code " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed 4.1.2017, Mark
                        'changed 05-22-13 state took edit check off function 3200
                        ' Case 3200
                        'valid = False
                        ''validate the object with this function
                        'If idim5 = 660 Then valid = True
                        'If idim5 = 670 Then valid = True
                        'If idim5 = 981 Then valid = True
                        'If idim5 = 982 Then valid = True
                        'If Not valid Then
                        '    errorval = dim5
                        '    errorphase = "2"
                        '    errordescr = "Error: Object invalid for function 3200."
                        '    GoTo Errorhandle
                        'End If

                        'added 4.1.2017, Mark
                    Case 3300
                        valid = True
                        Select Case idim3
                            Case 790
                                Select Case idim8
                                    Case 790
                                    Case Else
                                        valid = False
                                End Select

                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: " & "Function " & dim4 & " Can Only Use Job Code 405 When Using Project 790"
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 4200
                        valid = True
                        If idim5 = 440 Or idim5 = 710 Or idim5 = 834 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'added 4.1.2017, Mark
                    Case 5100
                        valid = True
                        Select Case idim2
                            Case 41, 21
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Fund  " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        Select Case idim5
                            Case 810, 820, 831, 832, 920
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object  " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed 4.1.2017, Mark
                        'Case 5200 To 5299
                        'valid = False
                        ''validate the object with this function
                        'If idim5 = 930 Then valid = True
                        'If idim5 = 950 Then valid = True
                        'If idim5 = 960 Then valid = True
                        'If idim5 = 970 Then valid = True
                        'If idim5 = 981 Then valid = True
                        'If idim5 = 982 Then valid = True
                        'If Not valid Then
                        '    errorval = dim5
                        '    errorphase = "2"
                        '    errordescr = "Error: Object invalid for function 5200."
                        '    GoTo Errorhandle
                        'End If

                        'added 4.1.2017, Mark
                    Case 5200
                        valid = True
                        Select Case idim5
                            Case 930, 950, 960, 970, 981, 982
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code  " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 5300
                        valid = False
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code  " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 5400
                        valid = False
                        If idim5 = 642 Then valid = True Else valid = False
                        If idim5 = 970 Then valid = True Else valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code  " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        'added 4.1.2017, Mark
                    Case 5400, 5500
                        valid = True
                        If idim9 < 50 Then valid = False
                        If dim9.Length < 3 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Site Code  Required with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 5400, 5500
                        valid = True
                        Select Case idim2
                            Case 11, 22, 22
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'Removed 4.1.2017, Mark
                        'Case 5400 To 5499
                        '    valid = False
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Function invalid for fund 60."
                        '    GoTo Errorhandle
                        'Removed 4.1.2017, Mark
                        'Case 5500 To 5599
                        '    valid = False
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Function invalid for fund 60."
                        '    GoTo Errorhandle
                        'added 4.1.2017, Mark
                    Case 5600 '/ remove series condition Mark 4.1.2017 'To 5699
                        valid = False
                        If idim5 = 930 Or idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed /updated  4.1.2017, Mark;
                    Case 5700
                        valid = True
                        If idim5 = 990 Then
                        Else
                            valid = False
                        End If
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed /updated  4.1.2017, Mark;
                    Case 5800 ' To 5899
                        valid = False
                        If idim5 = 970 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        'removed mark 4.1.2017;
                        'Case 5900 To 5999
                        '    valid = False
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Function invalid for fund 60."
                        '    GoTo Errorhandle
                    Case 5900
                        valid = True
                        If idim2 <> 88 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7400
                        valid = True
                        Select Case idim2
                            Case 83, 87
                            Case Else
                                valid = False
                                If Not valid Then
                                    errorval = dim5
                                    errorphase = "2"
                                    errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                                    GoTo Errorhandle
                                End If
                        End Select

                        If dim5.Substring(0, 1) = "2" Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        'added 4.1.2017, Mark
                    Case 7400, 7500, 7600, 7700
                        valid = True
                        If idim5 = 100 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7500
                        valid = True
                        If idim2 <> 84 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'Case 7000 To 7999
                        '    valid = False
                        '    errorphase = "2"
                        '    errordescr = "Error: Function invalid for fund 60."
                        '    GoTo Errorhandle

                        'added 4.1.2017, Mark
                    Case 7600, 7800
                        valid = True
                        If idim2 <> 82 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7710, 7720
                        valid = True
                        If idim2 <> 82 Or idim2 <> 85 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7730, 7740
                        valid = True
                        If idim2 <> 85 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7740
                        valid = True
                        If dim8.Length < 3 Then valid = False
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code  Required with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7800
                        valid = True
                        If idim2 <> 82 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        Select Case idim5
                            Case 195, 200 To 299, 336
                            Case Else
                                valid = False
                                If Not valid Then
                                    errorval = dim5
                                    errorphase = "2"
                                    errordescr = "Error: Object Code " & dim2 & " Invalid with Function " & dim4
                                    GoTo Errorhandle
                                End If
                        End Select

                        'added 4.1.2017, Mark
                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        'If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed 4.1.2017 Mark;
                        'Case 8900
                        '    valid = False
                        '    If Not valid Then
                        '        errorval = dim5
                        '        errorphase = "2"
                        '        errordescr = "Error: Object invalid for function 8900."
                        '        GoTo Errorhandle
                        '    End If

                    Case Else
                        valid = True
                End Select

#End Region

#Region " Dim 5 OBJECT"


                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the Object DIM 5
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'If & Select Statement Added 4.2.2017 Mark

                Select Case idim5


                    'Added 4.2.2017 Mark
                    Case 110
                        valid = True
                        If dim9.Length < 3 Then
                            Select Case idim4
                                Case 2212, 2213
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If dim9.Length < 3 Then
                            Select Case idim6
                                Case 276
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If valid = False Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site Code Required with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.2.2017 Mark
                    Case 110, 114, 115, 116, 131, 133, 139, 160, 170, 171, 172, 192, 210 To 219, 230 To 232, 251 To 253, 271, 273
                        valid = True
                        Select Case idim8
                            Case 100 To 115, 201 To 215, 217, 301 To 322, 324 To 348, 350, 351 To 359, 409, 414, 415, 510, 605, 954
                            Case Else
                                valid = False
                                If valid = False Then
                                    errorval = dim8
                                    errorphase = "2"
                                    errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                                    GoTo Errorhandle
                                End If
                        End Select

                        'Added 4.2.2017 Mark
                    Case 114
                        valid = True

                        If dim3.Substring(0, 1) = "5" Or dim3.Substring(0, 1) = "6" Or dim3.Substring(0, 1) = "7" Then
                            valid = False
                        End If
                        If valid = False Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.6.2017 Mark
                    Case 120, 124, 125, 141, 142, 143, 149, 150, 180 To 182, 193, 220 To 229, 240 To 242, 260 To 263, 280 To 283
                        valid = True
                        If idim2 = 83 Then
                            Select Case idim8
                                Case 102, 107, 109, 201 To 204, 214, 216, 301 To 332, 334 To 346, 348, 350, 352, 353 To 360, 400 To 999
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If valid = False Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.6.2017 Mark
                    Case 124
                        valid = True
                        If dim3.Substring(0, 1) = "5" Or dim3.Substring(0, 1) = "6" Or dim3.Substring(0, 1) = "7" Then
                            valid = False
                        End If
                        If valid = False Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Project Code " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.7.2017 Mark
                    Case 172, 182
                        valid = True
                        If idim3 = 301 Then valid = False
                        If valid = False Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Project Code " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.7.2017 Mark
                    Case 100 To 299
                        valid = True
                        'custom
                        If idim5 = 239 Then
                            Select Case idim4
                                Case 1000
                                    Select Case idim5
                                        Case 131, 141, 142, 200 To 299, 320, 360, 400 To 499, 530, 560 To 569, 580 To 599, 610 To 619, 641, 642, 645, 646, 647, 648, 650 To 659, 680 To 689, 730 To 739
                                        Case Else
                                            If idim7 = 0 Then valid = False
                                    End Select
                                    Select Case idim8
                                        Case 110, 213, 413, 414, 415, 963
                                        Case Else
                                            If idim7 = 0 Then valid = False
                                    End Select
                                    If idim7 = 0 And idim3 = 456 Then valid = False

                                    If idim7 = 0 And idim8 = 110 Then valid = True
                                Case 2113, 2120, 2132, 2135, 2140, 2152, 2153, 2170, 2180, 2194, 2199
                                Case 2212, 2213, 2330, 2340, 2410, 2511, 2560, 2573, 2620, 2640, 2660, 2700 To 2799, 5500
                                Case Else
                                    If idim7 = 0 Then valid = False
                                    If idim3 = 456 Then
                                        Select Case idim5
                                            Case 110, 114, 115, 120, 124, 125, 150, 160, 170, 171, 180, 191, 192, 193, 195, 196, 197, 198, 199
                                            Case Else
                                                If idim7 = 0 Then valid = False
                                        End Select
                                    End If
                            End Select
                            Select Case idim8
                                Case 110, 213, 322, 413, 414, 415, 502, 963
                                    If idim7 = 0 Then valid = False
                                Case Else
                            End Select
                        End If

                        Select Case idim5
                            Case 200 To 299
                                'custom
                                If idim7 = 0 Then
                                    Select Case idim8
                                        Case 108, 208, 213, 214, 346, 402, 409, 413, 414, 415, 963
                                        Case Else
                                            valid = False
                                    End Select
                                    Select Case idim6
                                        Case 500 To 599, 421
                                        Case Else
                                            valid = False
                                    End Select
                                End If
                                Select Case idim4
                                    Case 2213, 2573, 5300, 7400
                                    Case Else
                                        If dim8.Length < 3 Or idim8 = 0 Then
                                            valid = False
                                        End If
                                End Select
                        End Select
                        Select Case idim5
                            Case 100 To 299
                                valid = True
                                If idim5 = 290 Then
                                    If idim4 <> 5300 Then
                                        valid = False
                                        errorval = dim4
                                        errorphase = "2"
                                        errordescr = "Error: Function Code 5300 Only Valid with " & dim5
                                        GoTo Errorhandle
                                    End If
                                End If
                                If dim8.Length < 3 Then
                                    If idim2 = 83 Then
                                        Select Case idim5
                                            Case 219, 229, 290
                                            Case Else
                                                valid = False
                                        End Select
                                    End If
                                End If
                        End Select
                        If valid = False Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error Cust: Object Code " & dim5 & " Requires a Job Code"
                            GoTo Errorhandle
                        End If

                        'Added 4.7.2017 Mark
                    Case 310
                        Select Case idim4
                            Case 2321
                                Select Case idim8
                                    Case 115, 690
                                    Case Else
                                        valid = False
                                End Select
                            Case 2300 To 2399
                                 '2310, 2312 To 2319, 2321, 2323, 2330, 2340 '2300 series
                            Case 2541, 2542, 2543, 2544, 2511
                            Case Else
                                valid = False
                                If valid = False Then
                                    errorval = dim4
                                    errorphase = "2"
                                    errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5
                                    GoTo Errorhandle
                                End If
                        End Select


                    Case 320
                        Select Case idim4
                            Case 1000, 2100 To 2199, 2544, 2200 To 2299, 5500 'Added 2330 5.15.2017 Dan
                            Case Else
                                valid = False
                                errorval = dim4
                                errorphase = "2"
                                errordescr = "Error: Function invalid for this object."
                                GoTo Errorhandle
                        End Select

                        If idim9 < 50 Then valid = False 'update from < 100 4.7.2017 Mark

                        If valid = False Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Requires an Operational Unit Code "
                            GoTo Errorhandle
                        End If


                        'Added 4.7.2017 Mark
                    Case 340
                        valid = False

                        If valid = False Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Is Not BOLD"
                            GoTo Errorhandle
                        End If

                          'Added 4.7.2017 Mark
                    Case 341 To 346
                        valid = True

                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid "
                            GoTo Errorhandle
                        End If

                        'Added 4.7.2017 Mark
                    Case 350
                        valid = True
                        Select Case idim4
                            Case 2317, 3190
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5
                            GoTo Errorhandle
                        End If



                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = True 'fix bool val Mark 4.7.2017
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 450
                        valid = False
                        'validate the function with this object
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        'If idim4 >= 3190 Or idim4 <= 3199 Then valid = True 'fix not for entire series Mark 4.7.2017
                        If idim4 = 3190 Then valid = True 'Cfix not for entire series
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 522
                        valid = False
                        If idim4 = 2319 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        If idim4 = 1000 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                        GoTo Errorhandle


                    Case 540
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2314 Then valid = True
                        If idim4 = 2560 Then valid = True
                        If idim4 = 2571 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with Object " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                        'Added Mark 4.7.2017
                    Case 560
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 1500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5
                            GoTo Errorhandle
                        End If


                    Case 561, 562, 566 'Corrected condition 04.07.2017 Mark;
                        valid = False
                        'If idim4 = 1000 Then valid = True
                        If idim2 = 11 Then valid = True
                        If idim2 = 12 Then valid = True
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Fund" & dim2 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                        'comment out - not on list 2017 04.09.2017 Mark;
                        'Case 563, 564, 567
                        '    valid = False
                        '    If idim4 = 1000 Then valid = True
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Object can only use function 1000."
                        '    GoTo Errorhandle

                        'comment out - not on list 2017 04.09.2017 Mark;
                        'Case 570
                        '    valid = False
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Object invalid for fund 60."

                        '    GoTo Errorhandle
                        'Object Code 570 Can Only Use Program Code 700

                        'Add Mark 04.26.2017;

                    Case 570
                        valid = True

                        Select Case idim6
                            Case 700
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 580
                        valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = False

                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 620
                        valid = True
                        Select Case idim4
                            Case 1000, 2620, 2630, 2640, 2650, 2720, 2730, 2740, 3140
                            Case 3300
                                If dim6.Substring(0, 1) = "6" Then valid = True
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 630
                        valid = False
                        If idim6 = 700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                    Case 630
                        valid = False
                        If idim4 = 3110 And idim6 = 700 Then valid = True
                        If idim4 = 3150 And idim6 = 700 Then valid = True
                        If idim4 = 3155 And idim6 = 700 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                        GoTo Errorhandle

                        'Added 04.09.2017 Mark;
                    Case 641 To 648, 651 To 659, 660, 670, 681

                        valid = True
                        If dim9.Length < 3 Then valid = False
                        If idim9 < 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Unit " & dim9
                            GoTo Errorhandle
                        End If

                        Select Case idim5
                            Case 660, 670
                                If idim4 <> 3200 Then
                                    valid = False
                                    errorval = dim4
                                    errorphase = "2"
                                    errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4 'update 4.9.17 Mark
                                    GoTo Errorhandle
                                End If
                        End Select

                    Case 643, 644
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4 'update 4.9.17 Mark
                            GoTo Errorhandle
                        End If

                    Case 658
                        valid = False ' correction Mark
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim6 'update 4.9.17 Mark
                            GoTo Errorhandle
                        End If

                    Case 683
                        valid = False ' correction Mark
                        If idim4 = 2199 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim6 'update 4.9.17 Mark
                            GoTo Errorhandle
                        End If




                    Case 710
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2630 Then valid = True
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4 'update 4.9.17 Mark
                            GoTo Errorhandle
                        End If

                    Case 720
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2620 Then valid = True
                        If idim4 >= 4600 Or idim4 <= 4699 Then valid = True
                        If idim4 >= 4700 Or idim4 <= 4799 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4 'update 4.9.17 Mark
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 733, 735, 738
                        valid = True
                        If dim9.Length < 3 Then valid = False
                        If idim9 < 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Unit " & dim9
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 733, 735, 738
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 760
                        valid = True
                        Select Case idim4
                            Case 1000, 2650, 2720, 3190
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 820, 831, 832
                        valid = False
                        Select Case idim2
                            Case 12, 21, 41
                                valid = True
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 831, 832
                        valid = False
                        If idim4 = 5100 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 833, 834
                        valid = False
                        If idim2 = 41 Then valid = True
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                    Case 870
                        valid = False
                        'If idim4 <> 2518 Then valid = True ' upated 4.9.2017 Mark to;
                        If idim4 = 2518 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 880
                        valid = False 'added Mark
                        If idim4 = 2199 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed 04.09.2017, Mark;
                        'Case 890
                        '    valid = False
                        '    '    If idim4 = 5200 Then valid = True
                        '    '    If idim4 = 5600 Then valid = True
                        '    '    If idim4 = 5900 Then valid = True
                        '    '    If idim4 = 7400 Then valid = False
                        '    If idim4 = 8100 Then valid = True
                        '    'If idim4 = 8900 Then valid = True
                        '    If Not valid Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Function invalid for this object."
                        '        GoTo Errorhandle
                        '    End If


                        'Added 04.09.2017, Mark;

                    Case 920
                        valid = False
                        If idim4 = 5100 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        ' taken out 06-25-14 -error will always throw - Mark removed 4.09.2017
                        'Case 930
                        '    valid = False
                        '    '    If idim4 = 5200 Then valid = True
                        '    '    If idim4 = 5600 Then valid = True
                        '    '    If idim4 = 5900 Then valid = True
                        '    '    If idim4 = 7400 Then valid = False
                        '    'If idim4 = 8100 Then valid = True
                        '    'If idim4 = 8900 Then valid = True
                        '    If Not valid Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Function invalid for this object."
                        '        GoTo Errorhandle
                        '    End If

                    Case 950
                        valid = True
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        'If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 970
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = True ' corrected 4.9.2017 Mark
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 981, 982
                        valid = False
                        If idim4 = 3200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select


#End Region

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program dim6 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                ' Commented out entire dim6 previous validation - start new 'Mark 04.09.2017
                'Case 0
                '    valid = False
                '    errorval = dim6
                '    errorphase = "2"
                '    errordescr = "Error: Program invalid for fund 60."
                '    GoTo Errorhandle
                'Case 100
                '    If idim4 = 1000 Then valid = True
                '    errorval = dim6
                '    errorphase = "2"
                '    errordescr = "Error: Prog 100 only valid for func 1000."
                '    GoTo Errorhandle
                'Case 700
                '    valid = False
                '    If idim3 >= 0 And idim3 <= 298 Then valid = True
                '    If idim3 = 385 Then valid = True
                '    If idim3 >= 800 And idim3 <= 999 Then valid = False
                '    errorval = dim6
                '    errorphase = "2"
                '    errordescr = "Error: Prog 700 valid with proj 000-298, & 385."
                '    GoTo Errorhandle
                'Case 900
                '    'valid = False
                '    If idim3 >= 800 And idim3 <= 999 Then valid = True
                '    errorval = dim6
                '    errorphase = "2"
                '    errordescr = "Error: Program 900 invalid."
                '    GoTo Errorhandle
                'Case Else
                '    valid = True
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program dim6  new
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

                'Added 04.09.2017, Mark;
                Select Case idim6
                    Case 277
                        valid = True
                        Select Case idim4
                            Case 2213, 2544, 2573
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 277
                        valid = True
                        Select Case idim6
                            Case 0, 308, 311, 332, 334, 335
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 311 To 320
                        valid = True
                        Select Case idim7
                            Case 0
                            Case 5000
                            Case 8000 To 9999
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Subject " & dim7
                            GoTo Errorhandle
                        End If


                        'Added 04.09.2017, Mark;
                    Case 330 To 390
                        valid = True
                        If idim4 = 1000 Then
                            Select Case idim3
                                Case 0, 331 To 332, 334, 335, 421, 422, 423, 424, 426
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 330 To 390
                        valid = True
                        If idim4 = 1000 Then
                            Select Case idim7
                                Case 4400, 5000
                                Case 8000 To 9999
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 426
                        valid = True
                        Select Case idim3
                            Case 0, 331 To 335, 361, 362
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 427
                        valid = True
                        Select Case idim3
                            Case 0, 331 To 335, 367
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 492
                        valid = True
                        Select Case idim3
                            Case 0, 331 To 335, 553, 554
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, School spec Mark;
                    Case 495
                        valid = True
                        Select Case dim9
                            Case "050"
                            Case Else
                                If SchoolNumber = "346" Then 'exception Justice
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Unit " & dim9
                            GoTo Errorhandle
                        End If


                        'Added 04.09.2017, Mark;
                    Case 495
                        valid = True
                        Select Case idim3
                            Case 331 To 335, 511 To 791
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 500, 510, 511, 512, 530, 540, 550, 560, 570, 580, 590
                        valid = True
                        Select Case idim3
                            Case 0, 319, 331, 332, 334, 335, 731, 732, 733, 734, 735, 800
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 610
                        valid = True
                        If idim4 <> 3300 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 620, 630, 640, 650, 690
                        valid = True
                        Select Case idim4
                            Case 3300, 5200, 7800
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim6 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 660
                        valid = True
                        Select Case idim4
                            Case 1000 To 2999
                            Case 3200
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 700
                        valid = True
                        Select Case idim3
                            Case 0, 331, 332, 333, 334, 335, 385, 563, 591, 691, 760 To 769, 770, 791, 799, 800 To 899
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        valid = True
                        Select Case idim4
                            Case 2318, 3100 To 3199, 5200, 5300, 5400, 5600, 5700, 5900
                            Case 8000 To 8999
                            Case 2199, 2600 To 2699
                                valid = False
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If




                        ' Commented out entire dim6 previous validation - start new 'Mark 04.09.2017
                        'Case 0
                        '    valid = False
                        '    errorval = dim6
                        '    errorphase = "2"
                        '    errordescr = "Error: Program invalid for fund 60."
                        '    GoTo Errorhandle
                        'Case 100
                        '    If idim4 = 1000 Then valid = True
                        '    errorval = dim6
                        '    errorphase = "2"
                        '    errordescr = "Error: Prog 100 only valid for func 1000."
                        '    GoTo Errorhandle
                        'Case 700
                        '    valid = False
                        '    If idim3 >= 0 And idim3 <= 298 Then valid = True
                        '    If idim3 = 385 Then valid = True
                        '    If idim3 >= 800 And idim3 <= 999 Then valid = False
                        '    errorval = dim6
                        '    errorphase = "2"
                        '    errordescr = "Error: Prog 700 valid with proj 000-298, & 385."
                        '    GoTo Errorhandle
                        'Case 900
                        '    'valid = False
                        '    If idim3 >= 800 And idim3 <= 999 Then valid = True
                        '    errorval = dim6
                        '    errorphase = "2"
                        '    errordescr = "Error: Program 900 invalid."
                        '    GoTo Errorhandle
                        'Case Else
                        '    valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject  DIM 7
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    'removed for now 4.9.201, Mark;

                    Case 0
                        'If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        'If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        'If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        'errorval = dim7
                        'errorphase = "2"
                        'errordescr = "Error: Subject is required for function 1000."
                        'GoTo Errorhandle
                    Case 1060
                        valid = False
                        If idim6 = 239 Then valid = True
                        If valid = False Then ' updated 4.9.2017, Mark;
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Subject Code " & dim7 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If
                        'Case 6000 To 7999
                        '        valid = False
                        '        If Not valid Then
                        '            errorval = dim7
                        '            errorphase = "2"
                        '            errordescr = "Error: subject invalid."
                        '            GoTo Errorhandle
                        '        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass DIM 8 All new added 4/9/2017 no prior entries
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                ' Added 4.9.2017, Mark;
                Select Case idim8
                    Case 0
                        valid = True
                        Select Case idim5
                            Case 100 To 299
                                valid = False
                            Case Else
                        End Select
                        If valid = False Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 101
                        valid = True
                        Select Case idim4
                            Case 2212, 2321, 2330, 2340, 2410, 2490, 2511, 2520, 2542, 2571, 2575, 2620
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 102
                        valid = True
                        Select Case idim4
                            Case 2312, 2319
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 103
                        valid = True
                        Select Case idim4
                            Case 1000
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 104
                        valid = True
                        Select Case idim4
                            Case 2490
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 105
                        valid = True
                        Select Case idim4
                            Case 2410, 2571
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 106
                        valid = True
                        Select Case idim4
                            Case 2321
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        ' Added 4.9.2017, Mark;
                        '   Case 106
                        valid = True
                        Select Case idim5
                            Case 252, 262
                                valid = False
                            Case Else
                        End Select
                        If valid = False Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 107
                        valid = True
                        Select Case idim4
                            Case 2212, 2321, 2330, 2340, 2410, 2490, 2511, 2541, 2560, 2572
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 108
                        valid = True
                        Select Case idim4
                            Case 1000, 2212, 2240, 2330, 2340, 2430
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 109
                        valid = True
                        Select Case idim4
                            Case 2112, 2113, 2120, 2132, 2212, 2220, 2230, 2330, 2340, 2490
                            Case 2511, 2520, 2530, 2560, 2571, 2572, 2580, 2620, 2660, 2670, 2720
                            Case 3120, 3160, 3180, 3190
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 110
                        valid = True
                        Select Case idim4
                            Case 1500, 2112, 2120, 2332, 2140, 2152, 2194, 2199, 2212, 2220, 2330, 2340, 2410, 2430, 2410, 2430, 2490, 2511, 2520
                            Case 2542, 2543, 2571, 2580, 2620, 2670, 2720, 3120, 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 112
                        valid = True
                        Select Case idim4
                            Case 2410, 2571, 2573, 2575
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 115
                        valid = True
                        Select Case idim5
                            Case 120, 125, 252, 262
                                valid = False
                            Case Else
                        End Select
                        If valid = False Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 115, 690
                        valid = True
                        Select Case idim4
                            Case 2321, 2573
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 115, 690
                        valid = True
                        Select Case idim3
                            Case 331, 334, 421 To 799
                                valid = False
                            Case Else
                        End Select
                        If valid = False Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 115, 690
                        valid = True
                        Select Case idim2
                            Case 11, 21
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 201
                        valid = True
                        Select Case idim4
                            Case 1000, 2199
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 202, 203
                        valid = True
                        Select Case idim4
                            Case 2120
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 204
                        valid = True
                        Select Case idim4
                            Case 2212
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 205
                        valid = True
                        Select Case idim4
                            Case 2140, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 206
                        valid = True
                        Select Case idim4
                            Case 2220
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 207
                        valid = True
                        Select Case idim4
                            Case 1000
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 208
                        valid = True
                        Select Case idim4
                            Case 1000, 2199
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 209
                        valid = True
                        Select Case idim4
                            Case 1000
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 210
                        valid = True
                        Select Case idim4
                            Case 1000, 1500, 2192, 2212, 2213, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 211
                        valid = True
                        Select Case idim4
                            Case 2212, 2213
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 212
                        valid = True
                        Select Case idim4
                            Case 1000, 2212
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        ' Added 4.9.2017, Mark;
                    Case 213
                        valid = True
                        Select Case idim4
                            Case 1000, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        ' Added 4.9.2017, Mark;
                    Case 213
                        valid = True
                        Select Case idim6
                            Case 239, 429, 494
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Progam " & dim6
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 214
                        valid = True
                        Select Case idim4
                            Case 1000, 2112 To 2180, 2194 To 2313, 2316 To 2410, 2490 To 2511, 2520 To 2720, 2740, 3120, 2330 To 3190, 3300, 4400, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                    Case 214
                        valid = True
                        Select Case idim5
                            Case 110, 120
                                Select Case idim9
                                    Case 0
                                        valid = False
                                        If dim9.Length < 3 Then
                                            valid = False
                                        End If
                                End Select
                        End Select
                        If valid = False Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Unit " & dim9
                            GoTo Errorhandle
                        End If
                    Case 214
                        valid = True
                        Select Case idim5
                            Case 110, 120
                                Select Case idim7
                                    Case 0
                                        valid = False
                                        If dim9.Length < 4 Then
                                            valid = False
                                        End If
                                End Select
                        End Select
                        If valid = False Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Subject " & dim7
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 215, 216
                        valid = True
                        Select Case idim4
                            Case 2152
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 301
                        valid = True
                        Select Case idim4
                            Case 2313, 2511
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 303
                        valid = True
                        Select Case idim4
                            Case 2410
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 304
                        valid = True
                        Select Case idim4
                            Case 2112
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 305
                        valid = True
                        Select Case idim4
                            Case 2212, 2240, 2511
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 306
                        valid = True
                        Select Case idim4
                            Case 4400
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        ' Added 4.9.2017, Mark;
                    Case 307
                        valid = True
                        Select Case idim4
                            Case 1000, 2199, 2575
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 308
                        valid = True
                        Select Case idim4
                            Case 2112
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 309
                        valid = True
                        Select Case idim4
                            Case 2153
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 311
                        valid = True
                        Select Case idim4
                            Case 2572
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        ' Added 4.9.2017, Mark;
                    Case 312
                        valid = True
                        Select Case idim4
                            Case 2511, 2572
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 313
                        valid = True
                        Select Case idim4
                            Case 2113
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        ' Added 4.9.2017, Mark;
                    Case 311
                        valid = True
                        Select Case idim4
                            Case 2572
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 314, 315
                        valid = True
                        Select Case idim4
                            Case 2230, 2580
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 319
                        valid = True
                        Select Case idim4
                            Case 3120, 3180
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 321
                        valid = True
                        Select Case idim4
                            Case 2240, 2544
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 322
                        valid = True
                        Select Case idim4
                            Case 2113, 2194, 2199, 2323, 300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 324
                        valid = True
                        Select Case idim4
                            Case 2230, 2580
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 325
                        valid = True
                        Select Case idim4
                            Case 2330, 2340, 2541
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 327
                        valid = True
                        Select Case idim4
                            Case 2511
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 328
                        valid = True
                        Select Case idim4
                            Case 1000, 2332, 2194, 2323, 2340, 2490, 3100 To 3199
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 329
                        valid = True
                        Select Case idim4
                            Case 2317
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 331
                        valid = True
                        Select Case idim4
                            Case 2316
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 332
                        valid = True
                        Select Case idim4
                            Case 230, 2580
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 333
                        valid = True
                        Select Case idim4
                            Case 2132, 2574
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 334
                        valid = True
                        Select Case idim4
                            Case 2135
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 337
                        valid = True
                        Select Case idim4
                            Case 2571, 2572
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 338
                        valid = True
                        Select Case idim4
                            Case 2170, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 339
                        valid = True
                        Select Case idim4
                            Case 2132, 2574
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 341
                        valid = True
                        Select Case idim4
                            Case 2490, 2541
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 343
                        valid = True
                        Select Case idim4
                            Case 2140, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 344
                        valid = True
                        Select Case idim4
                            Case 2323, 2560
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 346
                        valid = True
                        Select Case idim4
                            Case 1000, 2199, 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 347
                        valid = True
                        Select Case idim4
                            Case 2132, 2574
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 348
                        valid = True
                        Select Case idim4
                            Case 2112, 2120, 2199, 2410
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 350
                        valid = True
                        Select Case idim4
                            Case 2542, 2543
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 351
                        valid = True
                        Select Case idim4
                            Case 2152
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 352
                        valid = True
                        Select Case idim4
                            Case 2113
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 353
                        valid = True
                        Select Case idim4
                            Case 2152, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 354
                        valid = True
                        Select Case idim4
                            Case 2212, 2213
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 356
                        valid = True
                        Select Case idim4
                            Case 2112
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 358
                        valid = True
                        Select Case idim4
                            Case 1000
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 358
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 351
                        valid = True
                        Select Case idim4
                            Case 1000, 2199, 2560, 2572
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 360
                        valid = True
                        Select Case idim4
                            Case 2132, 2573
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 401
                        valid = True
                        Select Case idim4
                            Case 2120
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 402, 403
                        valid = True
                        Select Case idim4
                            Case 1000
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 403
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 404
                        valid = True
                        Select Case idim4
                            Case 2120
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 405
                        valid = True
                        Select Case idim4
                            Case 1000, 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 406
                        valid = True
                        Select Case idim4
                            Case 1000, 2230, 2580
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 407
                        valid = True
                        Select Case idim4
                            Case 2199, 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 409
                        valid = True
                        Select Case idim4
                            Case 1000, 2132, 2199, 2240, 2660, 2670, 3190
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 410, 411
                        valid = True
                        Select Case idim4
                            Case 2220
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 412
                        valid = True
                        Select Case idim4
                            Case 2140
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 413
                        valid = True
                        Select Case idim4
                            Case 1000, 2213, 2192
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 413, 414
                        valid = True
                        Select Case idim9
                            Case 0
                                valid = False
                            Case Else
                                If idim9 < 50 Then
                                    valid = False
                                End If
                                valid = True
                        End Select
                        If valid = False Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Unit " & dim9
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 414
                        valid = True
                        Select Case idim4
                            Case 1000, 1500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 415
                        valid = True
                        Select Case idim4
                            Case 1000, 2213, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 416
                        valid = True
                        Select Case idim4
                            Case 2135, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 417
                        valid = True
                        Select Case idim4
                            Case 2170, 5500
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 502
                        valid = True
                        Select Case idim4
                            Case 2230, 2580, 3190
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 505
                        valid = True
                        Select Case idim4
                            Case 2560
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 506
                        valid = True
                        Select Case idim4
                            Case 2670
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 507
                        valid = True
                        Select Case idim4
                            Case 2132, 2574
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 508
                        valid = True
                        Select Case idim4
                            Case 1000, 2220, 2560, 2640
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 510
                        valid = True
                        Select Case idim4
                            Case 2140
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 511
                        valid = True
                        Select Case idim4
                            Case 2511, 2520, 3120
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 513
                        valid = True
                        Select Case idim4
                            Case 2199, 2330, 2500 To 2799, 3100 To 3199, 3300 To 3399, 4700 To 4799
                            Case 4610
                                If SchoolNumber = "399" Then valid = True
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 601
                        valid = True
                        Select Case idim4
                            Case 2313, 2330, 2511, 3140, 3190, 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 602
                        valid = True
                        Select Case idim4
                            Case 3120, 2511, 2199
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 603
                        valid = True
                        Select Case idim4
                            Case 2230, 2580
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 604
                        valid = True
                        Select Case idim4
                            Case 2112, 2511, 2580, 3190
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 605
                        valid = True
                        Select Case idim4
                            Case 2650, 2660, 2720
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 606
                        valid = True
                        Select Case idim4
                            Case 1000, 2410, 2530
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 607
                        valid = True
                        Select Case idim4
                            Case 2600 To 2699
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 608
                        valid = True
                        Select Case idim4
                            Case 2410, 2511
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 609
                        valid = True
                        Select Case idim4
                            Case 2112, 2120, 2132, 2140, 2194, 2212, 2220, 2321, 2330, 2340, 2410, 2420, 2511, 2520, 2530, 2544, 2560
                            Case 2571, 2572, 2620, 2720, 3120, 3150, 3300, 7800
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 610
                        valid = True
                        Select Case idim4
                            Case 2511, 2520, 2573
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 612
                        valid = True
                        Select Case idim4
                            Case 2321, 2410, 2511, 2520, 2620, 3120
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 613
                        valid = True
                        Select Case idim4
                            Case 2321, 2410, 2511, 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 614
                        valid = True
                        Select Case idim4
                            Case 2112, 2332, 2312, 2410, 2511, 2572, 2572, 3120, 3180
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 615
                        valid = True
                        Select Case idim4
                            Case 1000, 4000 To 5999, 7000 To 8999
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 617
                        valid = True
                        Select Case idim4
                            Case 2520, 2620, 3130
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 690
                        valid = True
                        Select Case idim4
                            Case 2321, 2573
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 701
                        valid = True
                        Select Case idim4
                            Case 2620, 3140, 3160, 4600 To 4699
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 702
                        valid = True
                        Select Case idim4
                            Case 2620, 2330, 3140, 3160, 4600 To 4699
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 703
                        valid = True
                        Select Case idim4
                            Case 2520, 2530, 3140, 3160, 4600 To 4699
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 704, 705, 706
                        valid = True
                        Select Case idim4
                            Case 2620, 3140, 3160, 4600 To 4699
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 707
                        valid = True
                        Select Case idim4
                            Case 2620, 2630, 2640, 2740, 3140, 3160
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 708
                        valid = True
                        Select Case idim4
                            Case 2620, 3140, 3160
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 710
                        valid = True
                        Select Case idim4
                            Case 2620, 3140, 3160, 4600 To 4799
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 711
                        valid = True
                        Select Case idim4
                            Case 2530
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 712
                        valid = True
                        Select Case idim4
                            Case 2650, 2740
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 801
                        valid = True
                        Select Case idim4
                            Case 2574, 2720, 3190
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 802
                        valid = True
                        Select Case idim4
                            Case 2520, 2620, 2720, 3130
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 803
                        valid = True
                        Select Case idim4
                            Case 2720, 3190
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 901
                        valid = True
                        Select Case idim4
                            Case 2620, 4300, 4600 To 4799
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 902
                        valid = True
                        Select Case idim4
                            Case 2520, 3130
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 905
                        valid = True
                        Select Case idim4
                            Case 2630
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 907
                        valid = True
                        Select Case idim4
                            Case 2640, 2740
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 951
                        valid = True
                        Select Case idim4
                            Case 2199, 2670, 2730
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 952
                        valid = True
                        Select Case idim4
                            Case 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 953
                        valid = True
                        Select Case idim4
                            Case 2199, 3120, 3130, 3160, 3180, 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 954
                        valid = True
                        Select Case idim4
                            Case 2620, 3140, 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 955
                        valid = True
                        Select Case idim4
                            Case 3120, 3150, 3180
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 957
                        valid = True
                        Select Case idim4
                            Case 2620, 2670
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 958
                        valid = True
                        Select Case idim4
                            Case 3120, 3180, 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 959
                        valid = True
                        Select Case idim4
                            Case 2660, 2670
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 961
                        valid = True
                        Select Case idim4
                            Case 2660, 3190
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 962
                        valid = True
                        Select Case idim4
                            Case 3300
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 963
                        valid = True
                        Select Case idim4
                            Case 1000
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 963
                        valid = True
                        Select Case idim3
                            Case 0, 456
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 964
                        valid = True
                        Select Case idim4
                            Case 2600 To 2699, 3120
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                        'valid = False
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site DIM 9
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

                Select Case idim9
                    ' Added 4.9.2017, Mark;
                    Case 0
                        valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site Code " & dim9 & " Invalid"
                            GoTo Errorhandle
                        End If

                    Case 50
                        valid = True
                        'Custom
                        Select Case idim3
                            Case 0 To 310, 312 To 316, 318, 320 To 328, 333, 336 To 398
                                Select Case idim4
                                    Case 1000, 2120, 2213, 2220, 2400 To 2499
                                        Select Case idim6
                                            Case 511 To 590
                                                valid = True
                                            Case Else
                                                valid = False
                                        End Select
                                        Select Case idim8
                                            Case 110, 211, 405, 415, 615
                                                valid = True
                                            Case Else
                                                valid = False
                                        End Select
                                        valid = False
                                End Select
                            Case 425, 458, 459, 516, 533, 534, 536, 573, 538, 549, 597, 622, 624, 643, 692, 693, 694, 695, 696, 697, 782, 783, 784, 789, 790
                                Select Case idim4
                                    Case 1000, 2132, 2135, 2140, 2194, 2199, 2213, 2330, 2573, 2720, 2730, 5500
                                    Case 5400, 8100
                                        Select Case idim6
                                            Case 239, 429, 494, 495
                                            Case Else
                                                valid = False
                                        End Select
                                    Case Else
                                        valid = False
                                End Select
                                If idim5 = 653 And idim6 = 239 Then valid = True
                                If idim8 = 207 Or idim8 = 211 Then valid = True
                                If idim5 >= 610 And idim5 <= 619 And idim6 = 495 Then valid = True
                                If idim3 = 597 And idim6 = 425 Then valid = True
                                If idim3 = 790 And idim6 = 700 Then valid = True

                        End Select

                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site Code " & dim9 & " Invalid"
                            GoTo Errorhandle
                        End If

                        ' Added 4.9.2017, Mark;
                    Case 998
                        valid = True

                        Select Case idim2
                            Case 12, 21
                            Case Else
                                If SchoolNumber = "134" Then
                                    valid = True
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site Code " & dim9 & " Invalid"
                            GoTo Errorhandle
                        End If


                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                'added this part to handle the warning on objects 100-299
                ' errorphase = "4" pec 04-26-11

                If errorphase = "4" Then
                    valid = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                Else
                    If valid = False Then
                        Me.HasErrors = True
                        With Me.GridDetail
                            .SetData(currow, 11, errorphase)
                            .SetData(currow, 14, errorval)
                            .SetData(currow, 15, errordescr)
                        End With
                    End If
                End If

                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2018_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 700) And (temp5 <= 799) Then
                dim5 = "700"
            End If
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            End If
            If (temp5 >= 900) And (temp5 <= 999) Then
                dim5 = "900"
            End If
            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010
                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2018_Phase2_EditCheck() As Boolean
        'Complete Rewrite Mark 4.12.2017
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     errordescrs   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean
        Dim RecordCount As Double
        valid = True
        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1



                valid = True
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)

                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                If Me._editchk = True Then
                    revenuecode = Me._Revenuecode
                    _ExpenseCodeFlag = False
                    currow = Me.GridDetail.Rows.Count - 1
                End If
                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)
                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                ''''''''''''''''''''''''''''''''''''''
                'REVENUe bold code edit replace 4.12.2017 - Mark;
                'Old code commented out
                'validate the fund
                ''''''''''''''''''''''''''''''''''''''
                'fund 60 requires a program code
                'If idim5 < 700 Then
                '    valid = False
                '    errorval = dim5
                '    valid = False
                '    errorphase = "2"
                '    errordescr = "Error: Program invalid for fund 60."
                '    GoTo Errorhandle
                'End If



                'New Project to Perform OCAS Edit Checks, Mark 3.21.2017;

                '===============================FUND CODE======================================================================================
                '                                  IDIM 2
                '=================================================================================================================================
                valid = True
                Select Case idim2

                    'Fund Code 11, 12, 21, 22, 24, 25, 26, 30 Series, 41, 50, 60, 80 Series Requires A Source Code
                'Case 11, 12, 21, 22, 24, 25, 26, 30 To 39, 41, 50, 60, 80
                '        Select Case idim4
                '            Case 0
                '                If idim4 = 0 Then valid = False
                '                errordescr = "ERROR: Fund " & idim2 & " Requires A Source Code"
                '                errorphase = "2"
                '                errorval = dim2
                '                valid = False
                '                valid = False
                '                GoTo Errorhandle
                '        End Select

                    Case 11
                        If idim4 = 0 Then valid = False
                        If valid = False Then
                            errordescr = "ERROR: Fund " & idim2 & " Requires a Source code"
                            errorphase = "2"
                            errorval = dim2
                            valid = False
                            GoTo Errorhandle
                        End If


                        'Fund Code 21 Can Only Use Source Code 1100 Series, 1310, 1320, 1350, 1390, 1410, 1420, 1430, 1440, 1450, 1460, 1490 Series, 1510, 1530,
                        '1550, 1570, 1590, 1610, 1630, 1650, 1660, 1670, 1680, 1690, 2000 Series, 3160, 3190, 3250, 3480, 3610, 3620, 3690, 3890, 4120, 4130, 4131,
                        '4161, 4162, 4163, 4164, 4165, 4689, 4890, 5000 Series, 6000 Series
                        'Except When Using Project Code 431 Only When Using District 55I052 (midwest) --ignored


                    Case 21
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 1100 To 1199
                            Case 1310, 1320, 1350, 1390, 1410, 1420, 1430, 1440, 1450, 1460
                            Case 1490 To 1499
                            Case 1510, 1530, 1550, 1570, 1590, 1610, 1630, 1650, 1660, 1670, 1680, 1690
                            Case 2000 To 2999
                            Case 3160, 3190, 3250, 3480, 3610, 3620, 3690, 3890, 4120, 4130, 4131, 4161, 4162, 4163, 4164, 4165, 4689, 4890
                            Case 5000 To 6999

                            Case Else
                                errordescr = "ERROR: Fund " & dim2 & " Not Valid Against Source: " & idim4
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Fund Code 21 Cannot Use Source Code 3833 Except When Using District 55I052 (midwest) Only When Using Project Code 431
                    Case 21
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 3833
                                errordescr = "ERROR: Fund " & idim2 & " Cannot Use Source Code 3833"
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                valid = False
                                GoTo Errorhandle

                        End Select

                        'Fund Code 22 Can Only Use Program Code 700 Except When Using Project Code 456
                    Case 22
                        If idim4 = 0 Then valid = False
                        RecordCount = RecordCount + 1
                        Select Case idim5
                            Case 700
                                If idim3 = 456 Then
                                Else
                                    valid = False
                                    errordescr = "ERROR: Fund " & idim2 & " Cannot Use Program 700 with Project " & idim3
                                    errorphase = "2"
                                    errorval = dim2
                                    valid = False
                                    GoTo Errorhandle
                                End If
                        End Select

                        'Fund Code 30 Series Can Only Use Source Code 1310, 1340, 1430, 1440, 1590, 1670, 1680, 6110, 6130, 6140, 5111, 5112, 5190, 5600
                    Case 30 To 39
                        If idim4 = 0 Then valid = False
                        RecordCount = RecordCount + 1
                        Select Case idim4
                            Case 1310, 1340, 1430, 1440, 1590, 1670, 1680, 6110, 6130, 6140, 5111, 5112, 5190, 5600
                            Case Else
                                valid = False
                                errordescr = "ERROR: Fund " & idim2 & " Cannot Use Source Code " & idim4
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Fund Code 41 Can Only Use Source Code 1100 Series, 1310, 1340, 1350, 1390, 1410, 1430, 1670, 1680, 2000 Series, 3160, 3190, 3610, 3620,
                        '4161, 5111, 5160, 5190, 5600, 6110, 6130, 6140, 6200
                    Case 41
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 1100 To 1199
                            Case 1310, 1340, 1350, 1390, 1410, 1430, 1670, 1680
                            Case 2000 To 2999
                            Case 3160, 3190, 3610, 3620, 4161, 5111, 5160, 5190, 5600, 6110, 6130, 6140, 6200
                            Case Else
                                valid = False
                                errordescr = "ERROR: Fund " & idim2 & " Cannot Use Source Code " & idim4
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle

                        End Select

                        'Fund Code 50, 60, 80 Series Cannot Use Source Code 4000 Series
                    Case 50 To 69, 80 To 89
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 4000 To 4999
                                errordescr = "ERROR: Fund" & idim2 & " Cannot Use Source Code 4000 Series"
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                GoTo Errorhandle

                        End Select

                        'Fund Code 88 Can Only Use Source Code 1310, 5113, 5600, 6110
                    Case 88
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 1310, 5113, 5600, 6110
                            Case Else
                                errordescr = "ERROR: Fund " & idim2 & " Can Only Use Source Code 1310, 5113, 5600, 6110"
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                GoTo Errorhandle

                        End Select
                End Select


                '===============================FUND CODE=====================================================================================
                '                                   end idim2 
                '===============================================================================================================================



                '===============================PROJECT CODE======================================================================================
                '                                 Start idim3
                '=================================================================================================================================


                Select Case idim3
                    Case 306
                        RecordCount = RecordCount + 1
                        If idim4 = 3490 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 306 Can Only Use Source Code 3490, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            valid = False
                            GoTo Errorhandle

                        End If

                    Case 307 To 309, 370
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 307, 308, 309, 370 Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            valid = False
                            GoTo Errorhandle

                        End If

                    Case 308
                        RecordCount = RecordCount + 1
                        If idim5 = 277 Then
                        Else
                            errordescr = "ERROR: Project Code 308 Can Only Use Program Code 277"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 311
                        RecordCount = RecordCount + 1
                        If idim4 = 3411 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 311 Can Only Use Source Code 3411, 5800,6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 312
                        RecordCount = RecordCount + 1
                        If idim4 = 3412 Or idim4 = 5600 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 312 Can Only Use Source Code 3412, 5600, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 313
                        RecordCount = RecordCount + 1
                        If idim4 = 3480 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 313 Can Only Use Source Code 3480, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 314
                        RecordCount = RecordCount + 1
                        If idim4 = 3450 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 314 Can Only Use Source Code 3450, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 315
                        RecordCount = RecordCount + 1
                        If idim4 = 3360 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 315 Can Only Use Source Code 3360, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 316
                        RecordCount = RecordCount + 1
                        If idim4 = 3411 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 316 Can Only Use Source Code 3411, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 317
                        RecordCount = RecordCount + 1
                        If idim4 = 3440 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 317 Can Only Use Source Code 3440, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 319
                        RecordCount = RecordCount + 1
                        If idim4 = 3430 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 319 Can Only Use Source Code 3430, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        'Project Code 326 Can Only Use District 60I067 -Cushing


                    Case 326
                        RecordCount = RecordCount + 1
                        If SchoolNumber = "134" Then
                        Else
                            errordescr = "ERROR: Project Code 326 Can Only Use District 60I067"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        RecordCount = RecordCount + 1
                        If idim4 = 3310 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 326  Can Only Use Source Code 3310, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 388
                        RecordCount = RecordCount + 1
                        If idim4 = 3310 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 388  Can Only Use Source Code 3310, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 331 To 332, 334 To 335
                        RecordCount = RecordCount + 1
                        If idim4 = 3250 Or idim4 = 6110 Or idim4 = 5150 Or idim4 = 5800 Or idim4 = 6200 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3250, 6110, 5150, 5800, 6200"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 333
                        RecordCount = RecordCount + 1
                        If idim2 = 11 Then
                        Else
                            errordescr = "ERROR: Project Code 333 Can Only Use Fund Code 11"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        If idim4 = 3420 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 333 Can Only Use Source Code 3420, 5800, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 337, 386, 391, 397, 398
                        RecordCount = RecordCount + 1
                        If idim4 = 3310 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3310, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 338
                        RecordCount = RecordCount + 1
                        If idim4 = 3570 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3570, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 339
                        RecordCount = RecordCount + 1
                        If idim4 = 3650 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3650, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 360, 361, 363
                        If idim4 = 3690 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3690, 5800, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        'Project Code 362 Can Only Use Source Code 3690, 5800, 6110 Except When Using Source Code 6140 Only When Using District 36I071 - Ponca City
                    Case 362
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3650, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 365, 368, 369, 396
                        RecordCount = RecordCount + 1
                        If idim4 = 3470 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3470, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 367
                        RecordCount = RecordCount + 1
                        If idim4 = 3415 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3415, 5800, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 371, 372, 373
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 385
                        RecordCount = RecordCount + 1

                        If dim4.Substring(0, 2) = "37" Or idim4 = 5150 Or idim4 = 6110 Then

                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3700 Series, 5150, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only UseProgram Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 397
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 398
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 411
                        RecordCount = RecordCount + 1
                        If idim4 = 3811 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3811"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 412
                        RecordCount = RecordCount + 1
                        If idim4 = 3812 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3812, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 413
                        RecordCount = RecordCount + 1
                        If idim4 = 3813 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 418
                        RecordCount = RecordCount + 1
                        If idim4 = 3836 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 419
                        RecordCount = RecordCount + 1
                        If idim4 = 3819 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 419
                        RecordCount = RecordCount + 1
                        If idim4 = 3819 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 421, 422, 423, 424, 426, 427, 429
                        RecordCount = RecordCount + 1
                        If idim4 = 4821 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4821"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 431
                        RecordCount = RecordCount + 1
                        If idim4 = 3833 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3833"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 432
                        RecordCount = RecordCount + 1
                        If idim4 = 3832 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3832"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 433
                        RecordCount = RecordCount + 1
                        If idim4 = 3819 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3819"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 434
                        RecordCount = RecordCount + 1
                        If idim4 = 3834 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3834"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 435
                        RecordCount = RecordCount + 1
                        If idim4 = 3834 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3819"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 436
                        RecordCount = RecordCount + 1
                        If idim4 = 4836 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4836"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 437
                        RecordCount = RecordCount + 1
                        If idim4 = 3837 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3837"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 438
                        RecordCount = RecordCount + 1
                        If idim4 = 3838 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3838"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 441
                        RecordCount = RecordCount + 1
                        If idim4 = 3841 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3841"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 442
                        RecordCount = RecordCount + 1
                        If idim4 = 3842 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3842"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 443
                        RecordCount = RecordCount + 1
                        If idim4 = 3843 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3843"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 444
                        RecordCount = RecordCount + 1
                        If idim4 = 3844 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3844"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 447
                        RecordCount = RecordCount + 1
                        If idim4 = 4847 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4847"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 448
                        RecordCount = RecordCount + 1
                        If idim4 = 3848 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3848"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 451
                        If idim4 = 4850 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4850"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 452
                        RecordCount = RecordCount + 1
                        If idim4 = 4852 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4852"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 454
                        RecordCount = RecordCount + 1
                        If idim4 = 4616 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4616"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        'Except When Using District 16I008(lawton, 52I004
                    Case 456
                        RecordCount = RecordCount + 1
                        If idim4 = 4617 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4617"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 457
                        RecordCount = RecordCount + 1
                        If idim4 = 4618 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4618"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 461
                        If idim4 = 3861 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3861"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 462
                        If idim4 = 3862 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3862"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 463
                        If idim4 = 3852 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3852"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 464
                        If idim4 = 3864 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3864"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 466
                        RecordCount = RecordCount + 1
                        If idim4 = 3866 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3866"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 467
                        RecordCount = RecordCount + 1
                        If idim4 = 4867 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4867"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 468
                        RecordCount = RecordCount + 1
                        If idim4 = 4868 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4868"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 469
                        RecordCount = RecordCount + 1
                        If idim4 = 3892 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3892"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 474
                        RecordCount = RecordCount + 1
                        If idim4 = 4874 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4874"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 475
                        RecordCount = RecordCount + 1
                        If idim4 = 3875 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3875"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 476
                        RecordCount = RecordCount + 1
                        If idim4 = 4876 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4876"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 477
                        RecordCount = RecordCount + 1
                        If idim4 = 4877 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4877"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 478
                        RecordCount = RecordCount + 1
                        If idim4 = 3820 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3820"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 479
                        RecordCount = RecordCount + 1
                        If idim4 = 3879 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3879"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 481
                        RecordCount = RecordCount + 1
                        If idim4 = 4881 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4881"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 483
                        RecordCount = RecordCount + 1
                        If idim4 = 3839 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3839"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 484
                        RecordCount = RecordCount + 1
                        If idim4 = 4882 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4882"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        'Project Code 485 Can Only Use District 55I052 (MIDWEST), 55I041 (WESTERN HeIGHTS  - 880)
                        'READ AS RESERVED FOR THESE TWO SCHOOLS
                    Case 485
                        RecordCount = RecordCount + 1
                        If SchoolNumber = "880" Then
                            If idim4 = 3856 Then
                            Else
                                errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3856"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                            End If
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use District 55I052, 55I041"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 486
                        RecordCount = RecordCount + 1
                        If idim4 = 4886 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4886"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 489
                        RecordCount = RecordCount + 1
                        If idim4 = 3889 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3889"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 491, 492, 493, 494, 495
                        RecordCount = RecordCount + 1
                        If idim4 = 3890 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3890"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 511
                        RecordCount = RecordCount + 1
                        If idim4 = 4210 Or idim4 = 4271 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4210, 4271"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 515
                        RecordCount = RecordCount + 1
                        If idim4 = 4210 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4210"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 516, 519
                        RecordCount = RecordCount + 1
                        If idim4 = 4213 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4213"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 517, 518
                        RecordCount = RecordCount + 1
                        If idim4 = 4210 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4210"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 521
                        RecordCount = RecordCount + 1
                        If idim4 = 4230 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4230"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 531, 532
                        RecordCount = RecordCount + 1
                        If idim4 = 4240 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4240"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 541
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Or idim4 = 4441 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271, 4441"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 542, 544, 545
                        RecordCount = RecordCount + 1
                        If idim4 = 4273 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4273"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 543
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 546
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Or idim4 = 4441 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271, 4441"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 548
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 553, 554
                        RecordCount = RecordCount + 1
                        If idim4 = 4443 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4443"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 558
                        RecordCount = RecordCount + 1
                        If idim4 = 4462 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4462"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 559
                        RecordCount = RecordCount + 1
                        If idim4 = 4689 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4689"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 561
                        RecordCount = RecordCount + 1
                        If idim4 = 4140 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4140"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 563, 564
                        RecordCount = RecordCount + 1
                        If idim4 = 4550 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4550"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 571, 572
                        RecordCount = RecordCount + 1
                        If idim4 = 4281 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4281"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 586
                        RecordCount = RecordCount + 1
                        If idim4 = 271 Or idim4 = 4441 Or idim4 = 4461 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 44271, 4441, 4461"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 587
                        RecordCount = RecordCount + 1
                        If idim4 = 4470 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4470"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 588
                        RecordCount = RecordCount + 1
                        If idim4 = 4180 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4180, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 591, 592, 593
                        RecordCount = RecordCount + 1
                        If idim4 = 4130 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4130, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 594
                        RecordCount = RecordCount + 1
                        If idim4 = 4120 Or idim4 = 6110 Then

                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4120"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 596
                        RecordCount = RecordCount + 1
                        If idim4 = 4480 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4480"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 613, 615, 621, 623, 625, 626, 627 Can Only Use Source Code 4310, 5600 Only When Using District 25I038 (Wynnewood)
                        '               commented out as it passed upload test from state on another district  4.12.2017 Mark
                        ' Case 613, 615, 621, 623, 625, 626, 627
                        'Only for Wynnewood
                        '     errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Only When Using District 25I038 "
                        '        errorphase = "2"
                        '        errorval = dim3 
                        valid = False

                        '                    If idim4 = "4130" Or "5600" Then
                        '                    Else
                        '                        errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4310, 5600"
                        '                        errorphase = "2"
                        '                        errorval = dim3 
                        valid = False

                        '                    End If

                    Case 641, 642
                        RecordCount = RecordCount + 1
                        If idim4 = 4340 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4340"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 651
                        RecordCount = RecordCount + 1
                        If idim4 = 4350 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4350"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 691
                        RecordCount = RecordCount + 1
                        If idim4 = 4560 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4560"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 698
                        RecordCount = RecordCount + 1
                        If idim4 = 4580 Or idim4 = 5600 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4580, 5600, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 731, 732, 733, 734
                        RecordCount = RecordCount + 1
                        If idim4 = 4611 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4611, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 734 Can Only Use District 72I009  - Union
                    Case 734
                        RecordCount = RecordCount + 1
                        errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Can Only Use District 72I009"
                        errorphase = "2"
                        errorval = dim3
                        valid = False
                        GoTo Errorhandle


                    Case 735
                        RecordCount = RecordCount + 1
                        If idim4 = 4613 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4613"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 763
                        RecordCount = RecordCount + 1
                        If idim4 = 4710 Or idim4 = 5150 Or idim4 = 6110 Or idim4 = 6200 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4710, 5150, 6110, 6200"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 763, 764, 765, 766, 768, 769, 791
                        RecordCount = RecordCount + 1
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Program Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        If idim3 = 764 Then
                            If idim4 = 4720 Or idim4 = 5150 Or idim4 = 6110 Or idim4 = 6200 Then
                            Else
                                errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4720, 5150, 6110, 6200"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                            End If
                        End If




                    Case 765
                        RecordCount = RecordCount + 1
                        If idim4 = 4730 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4730, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 766
                        RecordCount = RecordCount + 1
                        If idim4 = 4740 Or idim4 = 5150 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4740, 6110, 5150"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 767
                        RecordCount = RecordCount + 1
                        If idim4 = 4770 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4770, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 767
                        RecordCount = RecordCount + 1
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Program Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 767
                        RecordCount = RecordCount + 1
                        If idim4 = 4790 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4790"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 768
                        RecordCount = RecordCount + 1
                        If idim4 = 4760 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4760, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 769
                        RecordCount = RecordCount + 1
                        If idim4 = 4750 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4750, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 770 Can Only Use Source Code 6110, 4000 Series Except When Using District 16I008 - Lawton Exception
                    Case 770
                        RecordCount = RecordCount + 1
                        If dim4.Substring(0, 1) = "4" Or idim4 = 6100 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 6110, 4000 Series"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 781
                        RecordCount = RecordCount + 1
                        If idim4 = 4685 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4685"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 790
                        RecordCount = RecordCount + 1
                        If idim4 = 4790 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4790"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 791
                        RecordCount = RecordCount + 1
                        If idim4 = 4780 Or idim4 = 5600 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4780, 5600"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 799 Can Only Use Source Code 4000 Series
                    Case 799
                        RecordCount = RecordCount + 1
                        If dim4.Substring(0, 1) = "4" Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4000 Series"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 799
                        RecordCount = RecordCount + 1
                        If idim5 <> 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Cannot Use Program Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 800
                        RecordCount = RecordCount + 1
                        If idim2 = 60 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can only use FUND 60"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                End Select

                '===============================PROJECT CODE=====================================================================================
                '                                  END
                '================================================================================================================================


                '===============================SOURCE CODE=====================================================================================
                '                                  Start
                '================================================================================================================================
                If idim4 >= 1000 And idim4 <= 6200 Then
                    RecordCount = RecordCount + 1
                    If idim6 = 0 Then
                        errordescr = "ERROR: Source Code " & idim4 & " Cannot Use Site Code 000"
                        errorphase = "2"
                        errorval = dim4
                        valid = False
                        GoTo Errorhandle
                    End If
                End If


                Select Case idim4
                    '                   Source Code 1100 Series Can Only Use Fund Code 11, 21, 24, 25, 41
                    Case 1100
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11, 21, 24, 25, 41
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 21, 24, 25, 41"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select


                    Case 1310
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 0, 299, 800, 900
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Invalid with Project " & dim3
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 1430
                        RecordCount = RecordCount + 1
                        If idim2 = 41 Then
                        Else
                            errordescr = "Error: Source Code " & idim4 & " Can Only Use Fund 41"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 1700
                        RecordCount = RecordCount + 1
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                        If idim3 = 0 Or idim3 = 800 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 000, 800"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 1900
                        RecordCount = RecordCount + 1
                        If idim2 = 60 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 60"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 2000
                        RecordCount = RecordCount + 1
                        If idim2 = 11 Or idim2 = 21 Or idim2 = 25 Or idim2 = 41 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 11, 21, 25, 41"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Source Code 3000 Series, 4000 Series Cannot Use Fund Code 60
                    Case 3000 To 4999
                        RecordCount = RecordCount + 1

                        If idim2 = 60 Then
                            errordescr = "ERROR: Source Code " & idim4 & " Cannot Use Fund Code 60"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                        '                    Source Code 3110, 3120 Cannot Use District Prefix C - uncoded for now (maple darlington banner greenvile..)

                        '                    Source Code 3111 Can Only Use District 57I002 - Pawhuska[600], 57I011- Shidler, 57I029 - Barnsdall ,
                        '57I030- wayona, 57I038 - Hominy, 57I050 - Prue, 57I090 - Woodland[894], 72I008 -tipton
                    Case 3111
                        RecordCount = RecordCount + 1
                        If SchoolNumber = "600" Or SchoolNumber = "894" Then
                            errordescr = "ERROR: Source Code " & idim4 & " Source Code 3111 Can Only Use Specified Districts"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 3140
                        RecordCount = RecordCount + 1
                        If dim2 = "11" Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 11"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 3210, 3120
                        RecordCount = RecordCount + 1
                        If dim2 = "11" Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 11"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 3250
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 331, 332, 334, 335
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 331, 332, 334, 335"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        Select Case idim2
                            Case 11, 12, 21, 22, 26
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 12, 21, 22, 26"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3310
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 326, 381, 388
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 326, 381, 388"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3360
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 315
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 315"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3411
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 311, 316
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 311, 316"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3412
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 312
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 312"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3415
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 367
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 367"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3420
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund 11"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim3
                            Case 333
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 333"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3430
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 319
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 319"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3440
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 317
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 317"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3450
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 314
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 314"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3470
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 365, 368, 369, 396
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 365, 368, 369, 396"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3480
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 313
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 313"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3490
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 306
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 306"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3570
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 338
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 338"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3650
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 339
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 339"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3700 To 3799
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11, 22
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 22"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim5
                            Case 700
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim3
                            Case 385
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 385"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3811
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 411
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 411"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3812
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 412
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 412"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3813
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 413
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 413"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3819
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 419, 433, 435
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 419, 433, 435"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3820
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 478
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 478"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3832
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 432
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 432"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3833
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 431
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 431"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3834
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 434
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 434"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3836
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 418
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 418"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3837
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 437
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 437"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3838
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 438
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 438"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3839
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 483
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 483"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3841
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 441
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 441"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3842
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 442
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 442"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3843
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 443
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 443"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3844
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 444
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 444"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3848
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 448
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 448"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3852
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 463
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 463"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 3856 Can Only Use Project Code 485 Only When Using District 55I052 (MIDWEST CITY-DEL City)
                    Case 3856
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 485
                                '                        Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " District 55I052 Reserved Project Code 485"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3861
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 461
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 461"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3862
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 462
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 462"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3864
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 464
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 464"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3866
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 466
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 466"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3875
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 475
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 475"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3879
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 479
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 479"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3889
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 489
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 489"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3890
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 491, 492, 493, 494, 495
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 491, 492, 493, 494, 495"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3892
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 469
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 469"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Source Code 4000 Series Cannot Use Project Code 000, 299, 300 Series
                    Case 4000 To 4999
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 0, 299, 300 To 399
                                errordescr = "ERROR: Source Code " & idim4 & " Cannot Use Project Code 000, 299, 300 Series"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4120
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 594, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 594, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4130
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 591, 592, 593, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 591, 592, 593, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim2
                            Case 11, 21
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 21"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4140
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 561, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 561, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4150, 4161, 4162, 4163, 4164, 4165, 4166, 4170
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 770, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 770, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4180
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 588, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 588, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4210
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 511, 515, 517, 518, 785, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 511, 515, 517, 518, 785, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4213
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 502, 503, 504, 516, 519, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 502, 503, 504, 516, 519, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4230
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 521, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 521, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4240
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 531, 532, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 531, 532, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4271
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 511, 541, 543, 546, 548, 586, 785, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 511, 541, 543, 546, 548, 586, 785, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4273
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 542, 544, 545, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 542, 544, 545, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4281
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 571, 572, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 571, 572, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4310
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 613, 615, 621, 623, 625, 626, 627, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 613, 615, 621, 623, 625, 626, 627, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4340
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 641, 642, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 641, 642, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4350
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 651, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 651, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4441
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 541, 546, 586, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 541, 546, 586, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4443
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 553, 554, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 553, 554, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4461
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 586, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 586, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4462
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 558, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 558, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4470
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 587, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 587, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4480
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 596, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 596, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4550
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 563, 564, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 563, 564, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4560
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 691, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 691, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4580
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 698, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 698, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4611
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 731, 732, 733, 734, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 731, 732, 733, 734, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4613
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 735, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 735, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4616
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 454, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 454, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4617
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 456, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 456, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4618
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 457, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 457, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4685
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 781, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 781, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Source Code 4700 Series Can Only Use Fund Code 11, 12, 22
                    Case 4700 To 4799
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11, 12, 22
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 12, 22"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim5
                            Case 700
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4710
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 763
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 763"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4720
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 764
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 764"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4730
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 765
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 765"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4740
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 766
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 766"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4750
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 769
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 769"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4760
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 768
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 768"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4770
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 767
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 767"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim5
                            Case 700
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4780
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 791
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 791"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4790
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 790
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 790"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4821
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 421, 422, 423, 424, 426, 427, 429, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 421, 422, 423, 424, 426, 427, 429, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4836
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 436, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 436, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4847
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 447, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 447, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4850
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 451, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 451, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4852
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 452, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 452, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4867
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 467, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 467, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4868
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 468, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 468, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4874
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 474, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 474, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4876 Can Only Use Project Code 476, 799
                    Case 4876
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 476, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 476, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Source Code 4877 Can Only Use Project Code 477, 799
                    Case 4877
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 477, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 477, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4881 Can Only Use Project Code 481, 799
                    Case 4881
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 790
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 481, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4882 Can Only Use Project Code 484, 799
                    Case 4882
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 484, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 484, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4886 Can Only Use Project Code 486
                    Case 4886
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 486
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 486"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 5200 Can Only Use Fund Code 11
                    Case 5200
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund 11"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'todo 3.22.2017 12:45am  Mark
                        'Source Code 5200 Must Be 0 Balance Fund Code!
                        'Source Code 5300 Must Be 0 Balance Fund Code !

                End Select
                '===============================SOURCE CODE=====================================================================================
                '                                  END
                '===============================================================================================================================
                '===============================PROGRAM CODE=====================================================================================
                '                                  START
                '===============================================================================================================================
                Select Case idim5
                    Case 277
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 308
                            Case Else
                                errordescr = "ERROR: Program Code " & idim5 & " Can Only Use Project Code 308"
                                errorphase = "2"
                                errorval = dim5
                                valid = False
                                GoTo Errorhandle
                        End Select
                End Select

                'Program Code 700 Can Only Use Source Code 1310, 1510, 1550, 1590, 1670, 1680, 1700 Series, 3250, 6000 Series, 3700 Series, 4130, 4700
                'Series, 5000 Series
                Select Case idim5
                    Case 700
                        RecordCount = RecordCount + 1
                        Select Case idim4
                            Case 1310, 1510, 1550, 1590, 1670, 1680
                            Case 1700 To 1799
                            Case 3250
                            Case 3700 To 3799
                            Case 4130
                            Case 4700 To 4799
                            Case 5000 To 6999

                            Case Else
                                errordescr = "ERROR: Program Code " & idim5 & " Not Valid Against Source: " & idim4
                                errorphase = "2"
                                errorval = dim5
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Program Code 700 Can Only Use Project Code 000, 331, 332, 334, 335, 385, 591, 791, 760 Series, 800 Series
                        Select Case idim3
                            Case 0
                            Case 331, 332, 334, 335, 385, 591, 791
                            Case 3250
                            Case 760 To 769
                            Case 800 To 899
                            Case Else
                                errordescr = "ERROR: Program Code " & idim5 & " Not Valid Against Project: " & idim3
                                errorphase = "2"
                                errorval = dim5
                                valid = False
                                GoTo Errorhandle
                        End Select
                End Select

                '===============================PROGRAM CODE=====================================================================================
                '                                  END
                '===============================================================================================================================


                'idim2 & idim3 & idim4 & idim5 & idim6    If SchoolNumber = 880 Then
                ' Case (Left$(idim4, 1) = "3") Or (Left$(idim4, 1) = "4")


                'If idim3 = "385" And (idim2 <> "11" And idim2 <> "22") Then
                '    errordescr = "ERROR: PROJECT 385 MUST BE USED IN FUND 11 OR 22"
                '    errorphase = "2"
                '    errorval = dim4 

                'End If

                'cONDITION CAHNGED RE: pAT 04-2012
                'If Left(idim4, 2) = "17" Then
                '    If idim3 <> "385" And idim3 <> "766" And idim3 <> "769" Then
                '       errordescr = "ERROR: SOURCES IN 1700''s MUST USE PROJECT 385 OR 766 OR 769"
                '       errorphase = "2"
                '       errorval = dim4 


                '   End If
                'End If


                '  If idim2 = "22" And idim4 = "6110" And idim5 = "000" Then
                '      errordescr = "ERROR: FUND 22 MUST USE PROGRAM CODE 700"
                '      errorphase = "2"
                '      errorval = dim4 


                '  End If

                If idim6 = 0 Then
                    RecordCount = RecordCount + 1
                    errordescr = "ERROR: UNIT CANNOT BE 000"
                    errorphase = "2"
                    errorval = dim6
                    valid = False
                    GoTo Errorhandle
                End If







                ''''''''''''''''''''''''''''''''''''''
                'validate the project
                ''''''''''''''''''''''''''''''''''''''
                ''Select Case idim3
                ''    Case 0 To 298      'fund 60 project 000 to 298 school assgined for child nur.
                ''        valid = False
                ''        If idim5 >= 700 And idim5 <= 799 Then valid = True
                ''        If Not valid Then
                ''            errorval = dim5
                ''            errorphase = "2"
                ''            errordescr = "Prog invalid for project 000-298."
                ''            GoTo Errorhandle
                ''        End If
                ''    Case 306
                ''        Select Case idim4
                ''            Case 3490, 6110
                ''                valid = True
                ''            Case Else
                ''                valid = False
                ''                errorval = dim4 

                ''                errorphase = "2"
                ''                errordescr = "Source invalid for project 306."
                ''                GoTo Errorhandle
                ''        End Select

                ''    Case 385        'source validation
                ''        valid = False
                ''        If idim4 >= 3700 And idim4 <= 3799 Then valid = True
                ''        If Not valid Then
                ''            errorval = dim4 

                ''            errorphase = "2"
                ''            errordescr = "Source invalid for project 385."
                ''            GoTo Errorhandle
                ''        End If
                ''    Case 800        'fund 60 only
                ''        valid = True
                ''    Case Else       'all other projects fail
                ''        valid = False
                ''        errorval = dim3 

                ''        errorphase = "2"
                ''        errordescr = "Project invalid for fund 60."
                ''        GoTo Errorhandle
                ''End Select

                ''''''''''''''''''''''''''''''''''''''''
                '''validate the source
                ''''''''''''''''''''''''''''''''''''''''
                ''Select Case idim4
                ''    Case 1100 To 1199
                ''        valid = False
                ''        errordescr = "Source invalid for fund 60."
                ''    Case 1200 To 1299
                ''        valid = True
                ''    Case 1300 To 1699
                ''        valid = True
                ''    Case 1700 To 1799
                ''        valid = False
                ''        If idim3 >= 0 And idim3 <= 298 Then valid = True
                ''        If idim5 >= 700 And idim5 <= 799 Then valid = True
                ''        If Not valid Then
                ''            errorval = dim5
                ''            errorphase = "2"
                ''            errordescr = "Source valid with prj 000-298 & prg 700"
                ''            GoTo Errorhandle
                ''        End If
                ''    Case 1800 To 1899
                ''        valid = True
                ''    Case 1900 To 1999
                ''        If idim3 = 800 Then
                ''            errordescr = ""
                ''            valid = True
                ''        Else
                ''            valid = False
                ''            errordescr = "Source invalid for project " & dim3 & "."
                ''        End If
                ''    Case 2000 To 4999
                ''        valid = False
                ''        errordescr = "Source invalid for fund 60."
                ''    Case 5111, 5112, 5113, 5120, 5130, 5150, 5160, 5190
                ''        valid = True
                ''    Case 5200
                ''        errordescr = "Source valid for zero amount."
                ''        valid = True
                ''        'changed from false to true from ocas edit check 2017 DB
                ''    Case 5300
                ''        valid = True
                ''    Case 5600, 5800
                ''        valid = True
                ''    Case 6110, 6130, 6140
                ''        valid = True
                ''    Case 6200
                ''        valid = True
                ''    Case Else
                ''        valid = False
                ''        errordescr = "Source invalid for fund 60."
                ''End Select
                ''If Not valid Then
                ''    errorval = dim4 

                ''    errorphase = "2"
                ''    errordescr = "Error: " + errordescr
                ''    GoTo Errorhandle
                ''End If

                ''''''''''''''''''''''''''''''''''''''''
                '''validate the program
                ''''''''''''''''''''''''''''''''''''''''
                ''Select Case idim5
                ''    Case 700
                ''        valid = False
                ''        If idim3 >= 0 And idim3 <= 298 Then valid = True
                ''        If idim3 = 385 Then valid = True
                ''        If idim3 = 800 Then valid = False
                ''        If Not valid Then
                ''            errorval = dim5
                ''            errorphase = "2"
                ''            errordescr = "Program valid for proj 000-298 & 385."
                ''            GoTo Errorhandle
                ''        End If
                ''    Case 800
                ''        valid = True
                ''    Case 900
                ''        valid = False
                ''        If idim3 <> 385 Then valid = True
                ''        If idim3 >= 0 And idim3 <= 298 Then valid = False
                ''        If Not valid Then
                ''            errorval = dim5
                ''            errorphase = "2"
                ''            errordescr = "Program invalid for proj 000-298 & 385."
                ''            GoTo Errorhandle
                ''        End If
                ''    Case Else
                ''        valid = False
                ''        errorval = dim5
                ''        errorphase = "2"
                ''        errordescr = "Error: Program invalid for fund 60."
                ''        GoTo Errorhandle
                ''End Select

                ''''''''''''''''''''''''''''''''''''''''
                '''validate the site
                ''''''''''''''''''''''''''''''''''''''''

                ''Dim mysite As String = Me.DistrictId
                ''Dim myopunit As Char
                ''myopunit = GetChar(mysite, 1)

                ''Select Case idim6
                ''    Case idim6
                ''        valid = True
                ''    Case Else
                ''        valid = False
                ''        errorval = dim6
                ''        errorphase = "2"
                ''        errordescr = "Error: Site invalid for fund 60."
                ''        GoTo Errorhandle
                ''End Select

Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    '    Private Function ValidateDim2FundExpense(ByVal expendcode As String) As Boolean
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        'Mark 04212017 not in production yet
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
    '        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
    '        Dim boldcode, boldcodefmt As String
    '        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
    '        Dim currow, rowindex As Int32
    '        Dim valid As Boolean
    '        '3.29.2017, Mark;  errorpha

    '        dim1 = expendcode.Substring(0, 1)
    '        dim2 = expendcode.Substring(1, 2)
    '        dim3 = expendcode.Substring(3, 3)
    '        dim4 = expendcode.Substring(6, 4)
    '        dim5 = expendcode.Substring(10, 3)
    '        dim6 = expendcode.Substring(13, 3)
    '        dim7 = expendcode.Substring(16, 4)
    '        dim8 = expendcode.Substring(20, 3)
    '        dim9 = expendcode.Substring(23, 3)
    '        'convert to ints
    '        idim1 = CInt(dim1)
    '        idim2 = CInt(dim2)
    '        idim3 = CInt(dim3)
    '        idim4 = CInt(dim4)
    '        idim5 = CInt(dim5)
    '        idim6 = CInt(dim6)
    '        idim7 = CInt(dim7)
    '        idim8 = CInt(dim8)
    '        idim9 = CInt(dim9)


    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        'validate the fund DIM 2
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        'Me.ExpDim2Fund_EditCheck()--for future application - split Dim Functions

    '        Select Case idim2
    '                    '****Mark added - set default - we are addng other funds so we can incorporate code in merge Program**
    '                    'Added Fund checks 4.10.2017, Mark;

    '            Case 11
    '                valid = True
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim4
    '                    GoTo Errorhandle
    '                End If
    '                        'Added 4.10.2017, Mark;
    '            Case 21
    '                valid = True
    '                If idim4 = 2700 Then
    '                    'hulbert
    '                    If SchoolNumber = "337" Then
    '                        valid = True
    '                    Else
    '                        valid = False
    '                    End If
    '                End If
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 22
    '                valid = True
    '                Select Case idim4
    '                    Case 3100 To 3199, 5200, 5300, 5400, 5600, 5700, 5800, 8000 To 8999
    '                    Case Else
    '                        valid = False
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 22
    '                valid = True
    '                Select Case idim6
    '                    Case 239, 700
    '                        If idim6 = 293 Then
    '                            If idim3 = 456 Then
    '                                valid = True
    '                            Else
    '                                valid = False
    '                            End If
    '                        End If
    '                    Case Else
    '                        valid = False
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim6
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 41
    '                valid = True
    '                Select Case idim5
    '                    Case 310, 833
    '                        valid = False
    '                    Case Else
    '                        valid = True
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim5
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 41
    '                valid = True
    '                Select Case idim4
    '                    Case 5100, 5200, 5600
    '                    Case Else
    '                        valid = False
    '                End Select
    '                If Not valid Then
    '                    errorval = dim5
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
    '                    GoTo Errorhandle
    '                End If



    '                        'Added 4.10.2017, Mark;
    '            Case 60
    '                valid = True
    '                If dim6.Length < 3 Then valid = False
    '                If idim6 = 0 Then
    '                    Select Case idim4
    '                        Case 2321, 2410
    '                            valid = True
    '                        Case Else
    '                            valid = False
    '                    End Select
    '                End If

    '                Select Case idim3
    '                    Case 421 To 799
    '                        valid = False
    '                    Case Else
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim6
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 82
    '                valid = True
    '                Select Case idim4
    '                    Case 2317, 2511, 2572, 7600, 7710, 7720, 7800
    '                    Case Else
    '                        valid = False
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 83
    '                valid = True
    '                Select Case idim4
    '                    Case 7400
    '                    Case Else
    '                        valid = False
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 84
    '                valid = True
    '                Select Case idim4
    '                    Case 7500
    '                    Case Else
    '                        valid = False
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 85
    '                valid = True
    '                Select Case idim4
    '                    Case 7710, 7720, 7730, 7740
    '                    Case Else
    '                        valid = False
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 87
    '                valid = True
    '                Select Case idim4
    '                    Case 7400
    '                    Case Else
    '                        valid = False
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                    GoTo Errorhandle
    '                End If

    '                        'Added 4.10.2017, Mark;
    '            Case 88
    '                valid = True
    '                Select Case idim4
    '                    Case 5900
    '                    Case Else
    '                        valid = False
    '                End Select
    '                If dim4.Length < 4 Then valid = False
    '                If idim4 = 0 Then valid = False
    '                If dim5.Length < 3 Then valid = False
    '                If idim3 = 0 Then valid = False
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                    GoTo Errorhandle
    '                End If
    '            Case Else

    '                valid = False
    '                'we did not find a code
    '                If Not valid Then
    '                    errorval = dim4
    '                    errorphase = "2"
    '                    errordescr = "Error: Fund " & dim2 & " Invalid"
    '                    GoTo Errorhandle
    '                End If
    '        End Select



    'Errorhandle:
    '        'added this part to handle the warning on objects 100-299
    '        ' errorphase = "4" pec 04-26-11

    '        If errorphase = "4" Then
    '            valid = True
    '            With Me.GridDetail
    '                .SetData(currow, 11, errorphase)
    '                .SetData(currow, 14, errorval)
    '                .SetData(currow, 15, errordescr)
    '            End With
    '        Else
    '            If valid = False Then
    '                Me.HasErrors = True
    '                With Me.GridDetail
    '                    .SetData(currow, 11, errorphase)
    '                    .SetData(currow, 14, errorval)
    '                    .SetData(currow, 15, errordescr)
    '                End With
    '            End If
    '        End If

    '        'clear the vars
    '        errorphase = "0"
    '        errorval = ""
    '        errordescr = ""
    'Skiprecord:




    '    End Function







    '     Future Function - split dim check: Public Function ExpDim2Fund_EditCheck() As Boolean
    '        'phase 2 performs the edit checks for the dimensions used. at this
    '        'point, the codes have already been rolled to the bold.  Note: the 
    '        'phaseerror will be accessed to determine if this item should run 
    '        'thru the edit checks.  If an item failed in phase 1, then it will
    '        'be skipped in this phase.


    '        '****Mark added - set default - we are addng other funds and all coding, so we can incorporate code in merge Program**
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        '     0           1         2        3        4        5   
    '        '   bank       fisyr    docnumber   amt    count   revenuecode
    '        '     6           7         8        9       10
    '        '   descr     remarks   created    ttype -- NOT USED --
    '        '    11          12        13       14       15   
    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
    '        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
    '        Dim expendcode, boldcode, boldcodefmt As String
    '        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
    '        Dim currow, rowindex As Int32
    '        Dim valid As Boolean
    '        '3.29.2017, Mark;  errorphase = "2"   - error caught in phase2 checking


    '        valid = True 'mark added - set default
    '        Try

    '            For currow = 0 To Me.GridDetail.Rows.Count - 1
    '                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
    '                If phaseerror <> "0" Then GoTo Skiprecord

    '                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
    '                dim1 = expendcode.Substring(0, 1)
    '                dim2 = expendcode.Substring(1, 2)
    '                dim3 = expendcode.Substring(3, 3)
    '                dim4 = expendcode.Substring(6, 4)
    '                dim5 = expendcode.Substring(10, 3)
    '                dim6 = expendcode.Substring(13, 3)
    '                dim7 = expendcode.Substring(16, 4)
    '                dim8 = expendcode.Substring(20, 3)
    '                dim9 = expendcode.Substring(23, 3)
    '                'convert to ints
    '                idim1 = CInt(dim1)
    '                idim2 = CInt(dim2)
    '                idim3 = CInt(dim3)
    '                idim4 = CInt(dim4)
    '                idim5 = CInt(dim5)
    '                idim6 = CInt(dim6)
    '                idim7 = CInt(dim7)
    '                idim8 = CInt(dim8)
    '                idim9 = CInt(dim9)

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the fund DIM 2
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim2
    '                    '****Mark added - set default - we are addng other funds so we can incorporate code in merge Program**
    '                    'Added Fund checks 4.10.2017, Mark;
    '                Case 11, 12, 21, 22, 24, 25, 26, 30 To 39, 41, 50, 60, 80 To 89
    '                        valid = True
    '                        If dim4.Length < 4 Then valid = False
    '                        If idim4 = 0 Then valid = False
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If
    '                        'Added 4.10.2017, Mark;
    '                    Case 11, 12, 21, 22, 24, 25, 26, 30 To 39, 41, 50, 60, 80 To 89
    '                        valid = True
    '                        If dim5.Length < 3 Then valid = False
    '                        If idim3 = 0 Then valid = False
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim4
    '                            GoTo Errorhandle
    '                        End If
    '                        'Added 4.10.2017, Mark;
    '                    Case 21
    '                        valid = True
    '                        If idim4 = 2700 Then
    '                            'hulbert
    '                            If SchoolNumber = "337" Then
    '                                valid = True
    '                            Else
    '                                valid = False
    '                            End If
    '                        End If
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 22
    '                        valid = True
    '                        Select Case idim4
    '                            Case 3100 To 3199, 5200, 5300, 5400, 5600, 5700, 5800, 8000 To 8999
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 22
    '                        valid = True
    '                        Select Case idim6
    '                            Case 239, 700
    '                                If idim6 = 293 Then
    '                                    If idim3 = 456 Then
    '                                        valid = True
    '                                    Else
    '                                        valid = False
    '                                    End If
    '                                End If
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim6
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 41
    '                        valid = True
    '                        Select Case idim5
    '                            Case 310, 833
    '                                valid = False
    '                            Case Else
    '                                valid = True
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 41
    '                        valid = True
    '                        Select Case idim4
    '                            Case 5100, 5200, 5600
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 60
    '                        valid = True
    '                        Select Case idim3
    '                            Case 421 To 799
    '                                valid = False
    '                            Case Else
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim3
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Project " & dim3
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 60
    '                        valid = True
    '                        If dim6.Length < 3 Then valid = False
    '                        If idim6 = 0 Then
    '                            Select Case idim4
    '                                Case 2321, 2410
    '                                    valid = True
    '                                Case Else
    '                                    valid = False
    '                            End Select
    '                        End If
    '                        If Not valid Then
    '                            errorval = dim6
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 82
    '                        valid = True
    '                        Select Case idim4
    '                            Case 2317, 2511, 2572, 7600, 7710, 7720, 7800
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 83
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7400
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 84
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7500
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 85
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7710, 7720, 7730, 7740
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 87
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7400
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 88
    '                        valid = True
    '                        Select Case idim4
    '                            Case 5900
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If
    '                    Case Else
    '                        valid = True
    '                End Select

    'Errorhandle:
    '                If valid = False Then
    '                    Me.HasErrors = True
    '                    With Me.GridDetail
    '                        .SetData(currow, 11, errorphase)
    '                        .SetData(currow, 14, errorval)
    '                        .SetData(currow, 15, errordescr)
    '                    End With
    '                End If
    '                'clear the vars
    '                errorphase = "0"
    '                errorval = ""
    '                errordescr = ""
    'Skiprecord:
    '            Next

    '        Catch ex As Exception
    '            Throw
    '        End Try

    '    End Function


#End Region

#Region "  Methods 2019 Edit Checks "

    Private Function Expenditure2019_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt As Double
        Dim tcount, currow, rowindex, amt As Int32

        Dim tempx As String

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""

            Try
                expendcode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                'temp = DirectCast(Me.GridDetail.GetData(currow, 9), String).ToUpper
                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)
            Catch ex As Exception
                Throw
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 0) And (temp3 <= 298) Then
                dim3 = "000"
            Else
                dim3 = "800"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the function
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)
            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Function not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the object
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim5 As String = ValidateEDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Object not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp6 As Int32 = CInt(dim6)
            If (temp6 >= 100) And (temp6 <= 199) Then
                dim6 = "100"
            End If
            If (temp6 >= 700) And (temp6 <= 799) Then
                dim6 = "700"
            End If
            If (temp6 >= 800) And (temp6 <= 899) Then
                dim6 = "800"
            End If
            If (temp6 >= 900) And (temp6 <= 999) Then
                dim6 = "900"
            End If
            Dim testdim6 As String = ValidateDim6(dim6)
            Select Case testdim6
                Case "-1"
                    'error
                    errorval = dim6
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim6 = testdim6 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the subject
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim7 As String = ValidateDim7(dim7)
            Select Case testdim7
                Case "-1"
                    'error
                    errorval = dim7
                    errordescr = "Error: Subject not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim7 = testdim7 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the jobclass
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim8 As String = ValidateDim8(dim8)
            Select Case testdim8
                Case "-1"
                    'error
                    errorval = dim8
                    errordescr = "Error: Job class not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim8 = testdim8 'get the rolled code
            End Select
            ''''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)

            Dim testdim9 As String = ValidateDim9(dim9)
            Select Case testdim9
                Case "-1"
                    'error
                    errorval = dim9
                    errordescr = "Error: Site code not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'roll to the site code
                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010

                    If myopunit = "C" And dim9 > "051" And dim9 < "009" Then
                        errorval = dim9
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        dim9 = testdim9
                    End If
            End Select

Errorcatch:

            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6 + dim7 + dim8 + dim9
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6 + "-" + dim7 + "-" + dim8 + "-" + dim9
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next

    End Function

    Private Function Expenditure2019_Phase2_EditCheck() As Boolean
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.


        '****Mark added - Set default - we are Adding other funds and Complete coding, in order to Incorporate code in Merge Program**
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim expendcode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean
        '3.29.2017, Mark;  errorphase = "2"   - error caught in phase2 checking


        valid = True 'mark added - set default
        Try
            For currow = 0 To Me.GridDetail.Rows.Count - 1
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
                If Me._editchk = True Then
                    expendcode = _expendcode
                    _ExpenseCodeFlag = True
                    currow = Me.GridDetail.Rows.Count - 1
                End If


                dim1 = expendcode.Substring(0, 1)
                dim2 = expendcode.Substring(1, 2)
                dim3 = expendcode.Substring(3, 3)
                dim4 = expendcode.Substring(6, 4)
                dim5 = expendcode.Substring(10, 3)
                dim6 = expendcode.Substring(13, 3)
                dim7 = expendcode.Substring(16, 4)
                dim8 = expendcode.Substring(20, 3)
                dim9 = expendcode.Substring(23, 3)

                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)
                idim7 = CInt(dim7)
                idim8 = CInt(dim8)
                idim9 = CInt(dim9)


                'check fund
                ' ValidateDim2FundExpense(expendcode)
                'ValidateDim3Project(expendcode)

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the fund DIM 2
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'Me.ExpDim2Fund_EditCheck()--for future application - split Dim Functions

                Select Case idim2
                    '****Mark added - set default - we are addng other funds so we can incorporate code in merge Program**
                    'Added Fund checks 4.10.2017, Mark;

                    Case 11
                        valid = True
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim4
                            GoTo Errorhandle
                        End If
                        'Added 4.10.2017, Mark;
                    Case 21
                        valid = True
                        If idim4 = 2700 Then
                            'hulbert
                            If SchoolNumber = "337" Then
                                valid = True
                            Else
                                valid = False
                            End If
                        End If
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 22
                        valid = True
                        Select Case idim4
                            Case 3100 To 3199, 5200, 5300, 5400, 5600, 5700, 5800, 8000 To 8999
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        valid = True
                        Select Case idim6
                            Case 239, 700
                                If idim6 = 293 Then
                                    If idim3 = 456 Then
                                        valid = True
                                    Else
                                        valid = False
                                    End If
                                End If
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 41
                        valid = True
                        Select Case idim5
                            Case 310, 833
                                valid = False
                            Case Else
                                valid = True
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 41
                        valid = True
                        Select Case idim4
                            Case 5100, 5200, 5600
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If
              'Added 4.10.2017, Mark;
                    Case 60
                        valid = True

                        Select Case idim3
                            Case 421 To 799
                                valid = False
                                errordescr = "Error: Fund " & dim2 & " Invalid with Project " & dim3
                            Case Else

                        End Select

                        Select Case idim4
                            Case 0
                                valid = False
                                errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            Case Else

                        End Select

                        Select Case idim6
                            Case 0
                                Select Case idim4
                                    Case 2321, 2410
                                        '
                                    Case Else
                                        valid = False
                                        errordescr = "Error: Program " & dim6 & " Invalid with Function " & dim4
                                End Select
                            Case Else
                                '
                        End Select

                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            GoTo Errorhandle
                        End If


                        'Added 4.10.2017, Mark;
                    Case 82
                        valid = True
                        Select Case idim4
                            Case 2317, 2511, 2572, 7600, 7710, 7720, 7800
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 83
                        valid = True
                        Select Case idim4
                            Case 7400
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 84
                        valid = True
                        Select Case idim4
                            Case 7500
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 85
                        valid = True
                        Select Case idim4
                            Case 7710, 7720, 7730, 7740
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 87
                        valid = True
                        Select Case idim4
                            Case 7400
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 88
                        valid = True
                        Select Case idim4
                            Case 5900
                            Case Else
                                valid = False
                        End Select
                        If dim4.Length < 4 Then valid = False
                        If idim4 = 0 Then valid = False
                        If dim5.Length < 3 Then valid = False
                        If idim3 = 0 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                    Case Else

                        valid = False
                        'we did not find a code
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Fund " & dim2 & " Invalid"
                            GoTo Errorhandle
                        End If
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the project DIM 3
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
#Region " Dim 3 PROJECT"

                'Added 4.10.2017, Mark;
                Select Case idim3

                    'Added 4.10.2017, Mark;
                    Case 301
                        valid = True
                        Select Case idim5
                            Case 172, 182, 200
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 308
                        valid = True
                        Select Case idim6
                            Case 277
                            Case Else
                                valid = False
                        End Select

                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        Select Case idim4
                            Case 2213, 2544, 2573
                            Case Else
                                valid = False
                        End Select

                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 312
                        valid = True
                        Select Case idim4
                            Case 1000, 2120, 2140, 2152, 2153, 2220, 5600
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 316
                        valid = True
                        Select Case idim4
                            Case 2213, 2573, 5600, 8100
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        Select Case idim5
                            Case 170, 200 To 299, 890, 930
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 317
                        valid = True
                        Select Case idim4
                            Case 1000, 5600, 8100
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 319
                        valid = True
                        Select Case idim6
                            Case 500 To 599
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 326
                        valid = False
                        If SchoolNumber = "134" Then valid = True ''134 - Cushing
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with District Number "
                            GoTo Errorhandle
                        End If

                        'Added 4.10.2017, Mark;
                    Case 331, 332, 334, 335
                        valid = True

                        Select Case idim4
                            Case 2321
                                Select Case idim8
                                    Case 101, 106, 107, 609, 612, 613, 690
                                        valid = True
                                    Case Else
                                        errorval = dim4
                                        errorphase = "2"
                                        errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                                        GoTo Errorhandle
                                End Select
                        End Select

                        If idim3 = 331 Then
                            Select Case idim5
                                Case 115, 231, 232, 273
                                Case Else
                                    errorval = dim3
                                    errorphase = "2"
                                    errordescr = "Error: Project " & dim3 & " Invalid with Object"
                                    GoTo Errorhandle
                            End Select
                        End If

                        If idim3 = 332 Then
                            Select Case idim5
                                Case 125, 241, 242, 283, 930
                                Case Else
                                    errorval = dim3
                                    errorphase = "2"
                                    errordescr = "Error: Project " & dim3 & " Invalid with Object"
                                    GoTo Errorhandle
                            End Select
                        End If

                        If idim3 = 334 Then
                            Select Case idim5
                                Case 115, 212 To 218, 231, 232, 273
                                Case Else
                                    errorval = dim3
                                    errorphase = "2"
                                    errordescr = "Error: Project " & dim3 & " Invalid with Object"
                                    GoTo Errorhandle
                            End Select
                        End If

                        If idim3 = 335 Then
                            Select Case idim5
                                Case 125, 222 To 228, 241, 242, 283, 930
                                Case Else
                                    errorval = dim3
                                    errorphase = "2"
                                    errordescr = "Error: Project " & dim3 & " Invalid with Object"
                                    GoTo Errorhandle
                            End Select
                        End If

                        'Added 4.11.2017, Mark;
                    Case 338
                        valid = True
                        Select Case idim4
                            Case 2194, 5600, 8100
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 360
                        valid = True
                        Select Case idim6
                            Case 260 To 269
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 361, 362
                        valid = True
                        Select Case idim6
                            Case 426, 441, 442
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 367
                        valid = True
                        Select Case idim6
                            Case 427, 441
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 385
                        valid = True

                        Select Case idim4
                            Case 3120, 3130, 3140, 3150, 3160, 3180, 3190, 3200, 5200, 5300, 5600, 5700, 5800, 8100
                            Case Else
                                valid = False
                                errorval = dim4
                                errorphase = "2"
                                errordescr = "Error: Project " & dim3 & " Invalid with Function"
                                GoTo Errorhandle
                        End Select

                        Select Case idim6
                            Case 700
                            Case Else
                                valid = False
                                errorval = dim6
                                errorphase = "2"
                                errordescr = "Error: Project " & dim3 & " Invalid with Program"
                                GoTo Errorhandle
                        End Select

                        'Added 4.11.2017, Mark;
                    Case 388
                        valid = True
                        Select Case idim6
                            Case 430
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        Select Case idim8
                            Case 700
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Job Code " & dim8
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 397
                        valid = True
                        Select Case idim4
                            Case 2132, 5600, 8100
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 398
                        valid = True
                        Select Case idim5
                            Case 170, 171, 200 To 299
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                    ''Case 0 To 310, 312 To 317, 320 To 398
                    ''    valid = True
                    ''    Select Case idim4
                    ''        Case 1000, 2120, 2213, 2220, 2400 To 2499
                    ''            Select Case dim9
                    ''                Case "050"
                    ''                    errorval = dim9
                    ''                    errorphase = "2"
                    ''                    errordescr = "Error: Project " & dim3 & " Invalid with Oper Unit"
                    ''                Case Else

                    ''            End Select

                    ''        Case Else
                    ''    End Select

                    ''    If Not valid Then
                    ''        errorval = dim9
                    ''        errorphase = "2"
                    ''        errordescr = "Error: Project " & dim3 & " Invalid with Oper Unit "
                    ''        GoTo Errorhandle
                    ''    End If


                    'Added 4.11.2017, Mark;
                    Case 400 To 495
                        valid = True

                        Select Case idim6
                            Case 300 To 399
                            Case 500 To 599
                            Case Else
                                If idim3 = 456 Then
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        valid = True
                        Select Case idim7
                            Case 0, 4400, 5000
                            Case 8000 To 9999
                            Case Else
                                If idim3 = 456 Then
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Subject " & dim7
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark;
                    Case 421, 422, 423, 424
                        valid = True
                        Select Case idim6
                            Case 330 To 390
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark (Exceptions for Sile and Silina not included);
                    Case 423
                        valid = True
                        Select Case idim2
                            Case 12
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 456
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark FOR MIDEWEST only;
                    Case 485
                        valid = False
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with your District"
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 502, 503, 504, 515, 516, 518, 519
                        valid = True
                        Select Case idim6
                            Case 424, 429, 441, 442, 494
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 511
                        valid = True
                        Select Case idim6
                            Case 425, 429, 441, 442, 494, 495
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        valid = True
                        Select Case idim8
                            Case 0, 101, 106, 108, 110, 112, 202, 203, 204, 206, 207, 210, 211, 214, 315, 321, 322, 350, 341, 352, 354
                            Case 356, 359, 401, 402, 406, 410, 411, 413, 414, 415, 615, 801, 803, 951, 954, 961
                            Case Else
                                If idim4 = 2213 Or idim4 = 2573 Then
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Job Code " & dim8
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 517, 531, 532
                        valid = True
                        Select Case idim6
                            Case 424, 429, 494
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 521
                        valid = True
                        Select Case idim6
                            Case 429, 494
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark (Exceptions for Sile and Silina not included);
                    Case 542, 544
                        valid = True
                        Select Case idim2
                            Case 11, 12
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 553
                        valid = True
                        Select Case idim4
                            Case 1000 To 3190, 5400
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        valid = True
                        Select Case idim6
                            Case 500 To 799
                                valid = False
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    ''Case 553, 554
                    ''    valid = True
                    ''    Select Case idim6
                    ''        Case 490
                    ''        Case Else
                    ''            valid = False
                    ''    End Select
                    ''    If Not valid Then
                    ''        errorval = dim6
                    ''        errorphase = "2"
                    ''        errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                    ''        GoTo Errorhandle
                    ''    End If

                        'Added 4.11.2017, Mark 'Waynoka exception;
                    Case 563, 691
                        valid = True
                        Select Case idim6
                            Case 700
                                If SchoolNumber = "870" Then
                                Else
                                    valid = False
                                End If
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 571, 572
                        valid = True
                        Select Case idim6
                            Case 410
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 592, 613, 615, 621, 625, 641, 642, 651
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 593
                        valid = True
                        Select Case idim4
                            Case 4000 To 4999
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 596
                        valid = True
                        Select Case idim6
                            Case 425, 495
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 610 To 619, 621, 625, 626, 640 To 649
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 623
                        valid = True
                        Select Case idim6
                            Case 100, 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 627
                        valid = True
                        Select Case idim6
                            Case 239
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 641
                        valid = True
                        Select Case idim7
                            Case 1010 To 1019, 1020 To 1029, 1041
                            Case Else
                                Select Case idim4
                                    Case 2132, 2135, 2140, 2152, 2153, 2170, 2180, 2720, 5400
                                    Case Else
                                        valid = False
                                End Select
                        End Select
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Subject " & dim7
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 642
                        valid = True
                        Select Case idim7
                            Case 1010 To 1019
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Subject " & dim7
                            GoTo Errorhandle
                        End If

                    Case 711 'Added by Dan 
                        valid = True
                        Select Case idim6
                            Case 491
                            Case Else
                                errorval = dim6
                                errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                                valid = False
                        End Select

                        If Not valid Then
                            errorphase = "2"
                            GoTo Errorhandle
                        End If


                    Case 712 'Added by Dan 
                        valid = True
                        Select Case idim6
                            Case 499
                            Case Else
                                errorval = dim6
                                errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                                valid = False
                        End Select

                        If Not valid Then
                            errorphase = "2"
                            GoTo Errorhandle
                        End If

                    Case 713 'Added by Dan 
                        valid = True
                        Select Case idim6
                            Case 428
                            Case Else
                                errorval = dim6
                                errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                                valid = False
                        End Select

                        If Not valid Then
                            errorphase = "2"
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark Union Exception;
                    Case 731, 732, 733, 734, 735
                        valid = True
                        Select Case idim4
                            Case 1000 To 3300, 7000 To 8999
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark ;
                    Case 731 To 734
                        valid = True
                        Select Case idim6
                            Case 500 To 599
                            Case 900
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                    Case 760 To 769, 791
                        valid = True
                        Select Case idim6
                            Case 700
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        valid = True
                        Select Case idim4
                            Case 2199, 3110, 3155
                                valid = False
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 763, 764
                        valid = True
                        Select Case idim2
                            Case 11, 12
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 763, 764, 765, 766, 768, 769, 791
                        valid = True
                        Select Case idim4
                            Case 3120, 3130, 3140, 3150, 3160, 3180, 3190, 5200, 5300, 5400, 5600, 5700, 8000 To 8999
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark;
                    Case 767
                        valid = True
                        Select Case idim6
                            Case 700
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                        Select Case idim4
                            Case 3180
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 4.11.2017, Mark;
                    Case 768
                        valid = True
                        Select Case idim9
                            Case 50
                                If idim4 = 3140 Then
                                Else
                                    valid = False
                                End If
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Oper Unit " & dim9
                            GoTo Errorhandle
                        End If

                    Case 782 'Added by Dan
                        valid = True
                        Select Case idim6
                            Case 481
                            Case Else
                                errorval = dim6
                                errorphase = "2"
                                errordescr = "Error: Project " & dim3 & " Invalid with Program " & dim6
                        End Select
                        If Not valid Then
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark;
                    Case 799
                        valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Project " & dim3 & " Invalid with Expenditures"
                            GoTo Errorhandle
                        End If


                        'Added 4.11.2017, Mark;
                    Case 800 To 998
                        valid = True
                        Select Case idim2
                            Case 60
                            Case Else
                                errorval = dim2
                                errorphase = "2"
                                errordescr = "Error: Project " & dim3 & " Invalid with Fund " & dim2
                                GoTo Errorhandle
                        End Select
                End Select



#End Region

#Region " Dim 4 FUNCTION"


                'idim4 = 2573
                'dim4 = "2573" --test
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the function  DIM 4
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim4

                    Case 1000
                        valid = True
                        '4.11.2017 Custom Edit Mark;

                        Select Case idim5
                            Case 100 To 199, 641, 642, 643, 644, 645
                                Select Case idim5
                                    Case 130 To 139, 140 To 149
                                        Select Case idim8
                                            Case 214, 315, 328, 405, 413, 415
                                            Case Else
                                                If idim7 = 0 Then valid = False
                                        End Select
                                        Select Case idim6
                                            Case 421, 511 To 590
                                            Case Else
                                                If idim7 = 0 Then valid = False
                                        End Select
                                        Select Case idim3
                                            Case 731 To 735
                                            Case Else
                                                If idim7 = 0 Then valid = False
                                        End Select
                                End Select
                            Case Else
                        End Select

                        Select Case idim5
                            Case 110 'line5
                                If idim8 = 214 Then
                                    If idim7 = 0 Then valid = False
                                End If
                            Case 100 To 110, 200 To 299
                                If idim5 <> 130 Or idim5 <> 140 Then
                                    If idim9 <> 50 Then valid = False
                                End If
                                Select Case idim6
                                    Case 511 To 590, 441442, 490 To 499
                                    Case Else
                                        If idim9 <> 50 Then valid = False
                                End Select
                                Select Case idim8
                                    Case 213, 214, 328, 346, 406, 409, 413, 414, 415, 963
                                    Case Else
                                        If idim9 <> 50 Then valid = False
                                End Select
                        End Select

                        Select Case idim9
                            Case 50
                                Select Case idim6
                                    Case 441, 442, 495, 510, 511, 512, 519
                                        'Good
                                    Case Else
                                        valid = False
                                        errordescr = "Error: Function " & dim4 & " Invalid With Site 050."
                                End Select

                            Case Else
                                'Site code not 050.
                        End Select

                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            If errordescr.Length = 0 Then errordescr = "Error: Function " & dim4 & " Invalid per Custom Edit Check Line 2-7"
                            GoTo Errorhandle
                        End If

                    Case 1500
                        valid = False 'Only true for Mid-Del mark 3.22.2017
                        'validate the object with this function
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 1500 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2112 'Added Dan 3.22.2017
                        valid = True

                        If idim5 >= 100 And idim5 <= 199 Then
                            Select Case dim8 'Corrected to dim 8,was Dim9 Mark, 3.29.2017
                                Case "000", "109", "214", "304", "308", "348", "356", "604", "609", "614", "615"
                                Case Else
                                    valid = False
                            End Select
                        End If

                        'validate the site with this function 'Error discription, Mark update 3.29.2017
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2113
                        valid = True
                        'removed 3.29.2017, Mark;
                        'If idim9 = 50 Then
                        '    valid = False
                        'End If
                        'validate the site with this function

                        'added 3.29.2017, Mark;
                        Select Case idim8
                            Case 0, 109, 214, 313, 322, 352, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2120
                        valid = True

                        'added 3.29.2017, Mark;
                        Select Case idim8
                            Case 0, 109, 110, 202, 203, 214, 348, 401, 404, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 3.29.2017, Mark
                    Case 2132
                        valid = True

                        Select Case idim8
                            Case 0, 109, 110, 214, 328, 333, 339, 347, 360, 409, 507, 609, 614, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2135
                        valid = False
                        'validate the program with this function Dan commented out 240
                        If idim6 = 239 Then valid = True
                        'If idim6 = 240 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program invalid for function 2135."
                            GoTo Errorhandle
                        End If

                        'added 3.29.2017, Mark
                        Select Case idim8
                            Case 0, 214, 334, 416, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                    Case 2140
                        valid = False
                        If idim6 = 239 Then valid = True
                        If idim6 = 430 Then valid = True
                        If idim6 = 497 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Programs 239, 430 or 497."
                            GoTo Errorhandle
                        End If
                        'added 3.29.2017, Mark
                        valid = True
                        Select Case idim8
                            Case 0, 205, 214, 343, 412, 510, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2152
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If
                        'added 3.29.2017, Mark
                        valid = True
                        Select Case idim8
                            Case 0, 110, 214, 215, 216, 351, 353, 512, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2153
                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function can only use Program 239."
                            GoTo Errorhandle
                        End If

                        'added 3.29.2017, Mark
                        valid = True
                        Select Case idim8
                            Case 0, 110, 214, 309, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 3.29.2017, Mark
                    Case 2170
                        valid = True
                        Select Case idim8
                            Case 0, 214, 338, 417, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 2192
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2192 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2194
                        valid = True
                        Select Case idim8
                            Case 0, 110, 214, 322, 328, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2212
                        valid = True
                        Select Case idim8
                            Case 0, 101, 107 To 110, 204, 210 To 212, 214, 305, 354, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'added 4.11.2017, Custom Edit, Mark
                    Case 2213
                        valid = True
                        Select Case idim5
                            Case 110
                                Select Case idim8
                                    Case 210, 214, 413, 414
                                        If idim7 = 0 Then valid = False
                                    Case Else
                                End Select
                            Case Else

                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error Custom: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2220
                        valid = True
                        'removed 4.1.2017, Mark
                        'If idim9 = 50 Then valid = False
                        Select Case idim8
                            Case 0, 109, 110, 206, 214, 410, 411, 508, 609, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2230
                        valid = True
                        Select Case idim8
                            Case 0, 109, 214, 315, 324, 332, 406, 502, 603
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2240
                        valid = True
                        Select Case idim8
                            Case 0, 108, 214, 321, 409, 615
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.11.2017, Custom Edit, Mark
                    Case 2312
                        valid = True
                        Select Case idim5
                            Case 100 To 299, 525 'custom conflict
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error Custom: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'added 4.1.2017, Mark
                    Case 2313, 2318
                        valid = True
                        Select Case idim5
                            Case 100 To 299, 310, 525
                            Case 320
                                valid = False
                            Case Else
                                If idim4 = 2313 And idim5 = 525 Then
                                    valid = True
                                Else
                                    valid = False
                                End If
                        End Select
                        Select Case idim6 'Prog
                            Case 0, 251, 426, 800, 900
                                If idim4 = 2321 Then
                                    valid = True
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'added 4.1.2017, Mark
                    Case 2317
                        valid = True
                        Select Case idim5
                            Case 3330
                                valid = False
                            Case Else
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2321
                        valid = True
                        Select Case idim5
                            Case 100 To 299, 310, 525
                            Case Else
                                errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                        End Select
                        If idim5 = 320 Then
                            valid = False
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                        End If

                        Select Case idim6 ' prog
                            Case 0, 251, 426, 800, 900
                            Case Else
                                valid = False
                                errordescr = "Error: Program Code " & dim6 & " Invalid with Function " & dim4
                        End Select

                        Select Case idim8 ' prog
                            Case 0, 101, 106, 107, 115, 214, 609, 612, 613, 690
                            Case Else
                                valid = False
                                errordescr = "Error: Object Code " & dim8 & " Invalid with Function " & dim4
                        End Select

                        Select Case idim3
                            Case 421 To 589, 592 To 799
                                valid = False
                                errordescr = "Error: Project Code " & dim3 & " Invalid with Function " & dim4
                            Case Else
                                valid = True
                        End Select
                        If idim3 = 591 Then
                            If idim5 = 525 Then
                                valid = True
                            Else
                                valid = False
                                errordescr = "Error: Project Code " & dim3 & " Invalid with Function " & dim4
                            End If
                        End If
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If



                        'added 4.11.2017, Custom Edit, Mark


                        'removed 4.1.2017, Mark
                        'Case 2410
                        'valid = True
                        'If idim6 = 100 Then valid = False
                        'If idim9 = 50 Then valid = False
                        'If Not valid Then
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Site 050 or program 100 not valid for function."
                        '    GoTo Errorhandle
                        'End If

                    Case 2420
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2420 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2430
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2430 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                    Case 2440
                        valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function 2440 can be used by Mid-Del."
                            GoTo Errorhandle
                        End If

                        'removed 4.1.2017, Mark
                        ' Case 2490
                        'valid = True
                        'If idim9 = 50 Then valid = False
                        'If Not valid Then
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Site 050 not valid for function."
                        '    GoTo Errorhandle
                        'End If

                        'added 4.11.2017, Custom Edit, Mark
                    Case 2511
                        valid = True
                        Select Case idim5
                            Case 100 To 299
                                Select Case idim5
                                    Case 301, 601
                                    Case Else
                                        valid = False
                                        errordescr = "Error Custom: Object Code " & idim5 & " Invalid with Function " & dim4
                                End Select
                            Case Else 'conflicts with  custom code
                                'If idim4 = 2511 And idim5 = 525 Then
                                '    valid = True
                                'Else
                                '    valid = False
                                '    errordescr = "Error Custom: Object Code " & idim5 & " Invalid with Function " & dim4

                                'End If
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = errordescr
                            GoTo Errorhandle
                        End If


                    Case 2518
                        valid = True
                        If idim5 = 870 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object not valid for function."
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2573
                        valid = True
                        Select Case idim8
                            Case 210, 213
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.11.2017, Custom Edit, Mark
                        'Case 2573
                        valid = True
                        Select Case idim5
                            Case 110
                                Select Case idim8
                                    Case 210, 214, 413, 414
                                        If idim7 = 0 Then valid = False
                                    Case Else
                                End Select
                            Case Else
                                ' valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error Custom: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2580
                        valid = True
                        Select Case idim8
                            Case 0, 109, 110, 214, 314, 315, 324, 332, 406, 502, 513, 603, 604, 615
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2660
                        valid = True
                        Select Case idim8
                            Case 0, 109, 409, 513, 605, 607, 615, 959, 961, 964
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2670
                        valid = True
                        Select Case idim8
                            Case 0, 109, 110, 409, 506, 607, 951, 957, 959, 964
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2720
                        valid = True
                        Select Case idim8
                            Case 0, 109, 110, 513, 605, 609, 615, 801 To 803
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 2730
                        valid = True
                        Select Case idim8
                            Case 0, 951
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        'replaced 4.1.2017, Mark
                        'Case 3100 To 3199
                        '    valid = False
                        '    If idim3 = 0 And idim6 = 700 Then valid = True
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Function invalid for fund 60."
                        '    GoTo Errorhandle

                        'added 4.1.2017, Mark
                    Case 3100 To 3199
                        valid = True
                        If idim6 = 700 Then
                            If idim3 = 456 Or idim3 = 553 Or idim3 = 691 Then
                                valid = False
                            End If
                        Else
                            valid = False
                        End If
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim6 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    'Case 3110
                    '    valid = True
                    '    Select Case idim3
                    '        Case 385, 760 To 769, 791
                    '            valid = False
                    '    End Select
                    '    If Not valid Then
                    '        errorval = dim6
                    '        errorphase = "2"
                    '        errordescr = "Error: Project Code " & dim3 & " Invalid with Function " & dim4
                    '        GoTo Errorhandle
                    '    End If

                        'added 4.1.2017, Mark
                    'Case 3120
                    '    valid = True
                    '    Select Case idim8
                    '        Case 0, 109, 110, 214, 319, 511, 513, 602, 609, 612, 614, 615, 953, 955, 958, 964
                    '        Case Else
                    '            valid = True
                    '    End Select
                    '    If Not valid Then
                    '        errorval = dim8
                    '        errorphase = "2"
                    '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                    '        GoTo Errorhandle
                    '    End If

                        'Added by Dan4/3/19
                    'Case 3150
                    '    valid = False
                    '    Select Case idim2
                    '        Case <> 50
                    '            valid = False
                    '    End Select
                    '    If Not valid Then
                    '        errorval = dim3
                    '        errorphase = "2"
                    '        'errordescr = "Error: Project Code " & dim3 & " Invalid with Function " & dim4
                    '        GoTo Errorhandle
                    '    End If

                        'added 5.15.2018, Dan
                    'Case 3155
                    '    valid = True
                    '    Select Case idim3
                    '        Case < 0
                    '            '385, 760 To 769, 791
                    '            valid = False
                    '    End Select
                    '    If Not valid Then
                    '        errorval = dim3
                    '        errorphase = "2"
                    '        'errordescr = "Error: Project Code " & dim3 & " Invalid with Function " & dim4
                    '        GoTo Errorhandle
                    '    End If

                        'removed 4.1.2017, Mark
                        'changed 05-22-13 state took edit check off function 3200
                    'Case 3200
                    '    valid = False
                    '    ''validate the object with this function
                    '    'If idim5 = 660 Then valid = True
                    '    'If idim5 = 670 Then valid = True
                    '    'If idim5 = 981 Then valid = True
                    '    'If idim5 = 982 Then valid = True
                    '    If Not valid Then
                    '        errorval = dim5
                    '        errorphase = "2"
                    '        errordescr = "Child nutrition programs should not be charged here"
                    '        GoTo Errorhandle
                    '    End If

                        'added 4.1.2017, Mark
                    Case 3300
                        valid = True
                        Select Case idim3
                            Case 790
                                Select Case idim8
                                    Case 790
                                    Case Else
                                        valid = False
                                End Select

                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: " & "Function " & dim4 & " Can Only Use Job Code 405 When Using Project 790"
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 4200
                        valid = True
                        If idim5 = 440 Or idim5 = 710 Or idim5 = 834 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        'added 4.1.2017, Mark
                    Case 5100
                        valid = True
                        Select Case idim2
                            Case 41, 21
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Fund  " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        Select Case idim5
                            Case 810, 820, 831, 832, 920
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object  " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed 4.1.2017, Mark
                        'Case 5200 To 5299
                        'valid = False
                        ''validate the object with this function
                        'If idim5 = 930 Then valid = True
                        'If idim5 = 950 Then valid = True
                        'If idim5 = 960 Then valid = True
                        'If idim5 = 970 Then valid = True
                        'If idim5 = 981 Then valid = True
                        'If idim5 = 982 Then valid = True
                        'If Not valid Then
                        '    errorval = dim5
                        '    errorphase = "2"
                        '    errordescr = "Error: Object invalid for function 5200."
                        '    GoTo Errorhandle
                        'End If

                        'added 4.1.2017, Mark
                    Case 5200
                        valid = True
                        Select Case idim5
                            Case 930, 950, 960, 970, 981, 982
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code  " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 5300
                        valid = False
                        If idim5 = 290 Then valid = True
                        If idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code  " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 5400
                        valid = False
                        If idim5 = 642 Then valid = True Else valid = False
                        If idim5 = 970 Then valid = True Else valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code  " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    'Case 5400, 5500
                    '    valid = True
                    '    If idim9 < 50 Then valid = False
                    '    If dim9.Length < 3 Then valid = False
                    '    If Not valid Then
                    '        errorval = dim5
                    '        errorphase = "2"
                    '        errordescr = "Error: Site Code  Required with Function " & dim4
                    '        GoTo Errorhandle
                    '    End If

                        'added 4.1.2017, Mark
                    'Case 5400, 5500
                    '    valid = True
                    '    Select Case idim2
                    '        Case 11, 22, 22
                    '        Case Else
                    '            valid = False
                    '    End Select
                    '    If Not valid Then
                    '        errorval = dim2
                    '        errorphase = "2"
                    '        errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                    '        GoTo Errorhandle
                    '    End If



                        'added 4.1.2017, Mark
                    Case 5600 '/ remove series condition Mark 4.1.2017 'To 5699
                        valid = False
                        If idim5 = 930 Or idim5 = 960 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed /updated  4.1.2017, Mark;
                    Case 5700
                        valid = True
                        If idim5 = 990 Then
                        Else
                            valid = False
                        End If
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed /updated  4.1.2017, Mark;
                    Case 5800 ' To 5899
                        valid = False
                        If idim5 = 970 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        'removed mark 4.1.2017;
                        'Case 5900 To 5999
                        '    valid = False
                        '    errorval = dim4
                        '    errorphase = "2"
                        '    errordescr = "Error: Function invalid for fund 60."
                        '    GoTo Errorhandle
                    Case 5900
                        valid = True
                        If idim2 <> 88 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7400
                        valid = True
                        Select Case idim2
                            Case 83, 87
                            Case Else
                                valid = False
                                If Not valid Then
                                    errorval = dim5
                                    errorphase = "2"
                                    errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                                    GoTo Errorhandle
                                End If
                        End Select

                        If dim5.Substring(0, 1) = "2" Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        'added 4.1.2017, Mark
                    Case 7400, 7500, 7600, 7700
                        valid = True
                        If idim5 = 100 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    'Case 7500
                    '    valid = True
                    '    If idim2 <> 84 Then valid = False
                    '    If Not valid Then
                    '        errorval = dim5
                    '        errorphase = "2"
                    '        errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                    '        GoTo Errorhandle
                    '    End If


                        'Case 7000 To 7999
                        '    valid = False
                        '    errorphase = "2"
                        '    errordescr = "Error: Function invalid for fund 60."
                        '    GoTo Errorhandle

                        'added 4.1.2017, Mark
                    'Case 7600, 7800
                    '    valid = True
                    '    If idim2 <> 82 Then valid = False
                    '    If Not valid Then
                    '        errorval = dim5
                    '        errorphase = "2"
                    '        errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                    '        GoTo Errorhandle
                    '    End If

                        'added 4.1.2017, Mark
                    Case 7710, 7720
                        valid = True
                        If idim2 <> 82 Or idim2 <> 85 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7730, 7740
                        valid = True
                        If idim2 <> 85 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7740
                        valid = True
                        If dim8.Length < 3 Then valid = False
                        If Not valid Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code  Required with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'added 4.1.2017, Mark
                    Case 7800
                        valid = True
                        If idim2 <> 82 Then valid = False
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Fund Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                        Select Case idim5
                            Case 195, 200 To 299, 336
                            Case Else
                                valid = False
                                If Not valid Then
                                    errorval = dim5
                                    errorphase = "2"
                                    errordescr = "Error: Object Code " & dim2 & " Invalid with Function " & dim4
                                    GoTo Errorhandle
                                End If
                        End Select

                        'added 4.1.2017, Mark
                    Case 8100
                        valid = False
                        'validate the object with this function
                        If idim5 = 890 Then valid = True
                        'If idim5 = 930 Then valid = True
                        If Not valid Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim2 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed 4.1.2017 Mark;
                        'Case 8900
                        '    valid = False
                        '    If Not valid Then
                        '        errorval = dim5
                        '        errorphase = "2"
                        '        errordescr = "Error: Object invalid for function 8900."
                        '        GoTo Errorhandle
                        '    End If

                    Case Else
                        valid = True
                End Select

#End Region

#Region " Dim 5 OBJECT"


                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the Object DIM 5
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'If & Select Statement Added 4.2.2017 Mark

                Select Case idim5


                    'Added 4.2.2017 Mark
                    Case 110
                        valid = True
                        If dim9.Length < 3 Then
                            Select Case idim4
                                Case 2212, 2213
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If dim9.Length < 3 Then
                            Select Case idim6
                                Case 276
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If valid = False Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site Code Required with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.2.2017 Mark
                    Case 110, 114, 115, 116, 131, 133, 139, 160, 170, 171, 172, 192, 210 To 219, 230 To 232, 251 To 253, 271, 273
                        valid = True
                        Select Case idim8
                            Case 100 To 115, 201 To 215, 217, 301 To 322, 324 To 348, 350, 351 To 359, 409, 414, 415, 510, 605, 954
                            Case Else
                                valid = False
                                If valid = False Then
                                    errorval = dim8
                                    errorphase = "2"
                                    errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                                    GoTo Errorhandle
                                End If
                        End Select

                        'Added 4.2.2017 Mark
                    Case 114
                        valid = True

                        If dim3.Substring(0, 1) = "5" Or dim3.Substring(0, 1) = "6" Or dim3.Substring(0, 1) = "7" Then
                            valid = False
                        End If
                        If valid = False Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.6.2017 Mark
                    Case 120, 124, 125, 141, 142, 143, 149, 150, 180 To 182, 193, 220 To 229, 240 To 242, 260 To 263, 280 To 283
                        valid = True
                        If idim2 = 83 Then
                            Select Case idim8
                                Case 102, 107, 109, 201 To 204, 214, 216, 301 To 332, 334 To 346, 348, 350, 352, 353 To 360, 400 To 999
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If valid = False Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.6.2017 Mark
                    Case 124
                        valid = True
                        If dim3.Substring(0, 1) = "5" Or dim3.Substring(0, 1) = "6" Or dim3.Substring(0, 1) = "7" Then
                            valid = False
                        End If
                        If valid = False Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Project Code " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.7.2017 Mark
                    Case 172, 182
                        valid = True
                        If idim3 = 301 Then valid = False
                        If valid = False Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Project Code " & dim3 & " Invalid with Object " & dim5
                            GoTo Errorhandle
                        End If

                        'Added 4.7.2017 Mark
                    Case 100 To 299
                        valid = True
                        'custom
                        If idim5 = 239 Then
                            Select Case idim4
                                Case 1000
                                    Select Case idim5
                                        Case 131, 141, 142, 200 To 299, 320, 360, 400 To 499, 530, 560 To 569, 580 To 599, 610 To 619, 641, 642, 645, 646, 647, 648, 650 To 659, 680 To 689, 730 To 739
                                        Case Else
                                            If idim7 = 0 Then valid = False
                                    End Select
                                    Select Case idim8
                                        Case 110, 213, 413, 414, 415, 963
                                        Case Else
                                            If idim7 = 0 Then valid = False
                                    End Select
                                    If idim7 = 0 And idim3 = 456 Then valid = False

                                    If idim7 = 0 And idim8 = 110 Then valid = True
                                Case 2113, 2120, 2132, 2135, 2140, 2152, 2153, 2170, 2180, 2194, 2199
                                Case 2212, 2213, 2330, 2340, 2410, 2511, 2560, 2573, 2620, 2640, 2660, 2700 To 2799, 5500
                                Case Else
                                    If idim7 = 0 Then valid = False
                                    If idim3 = 456 Then
                                        Select Case idim5
                                            Case 110, 114, 115, 120, 124, 125, 150, 160, 170, 171, 180, 191, 192, 193, 195, 196, 197, 198, 199
                                            Case Else
                                                If idim7 = 0 Then valid = False
                                        End Select
                                    End If
                            End Select
                            Select Case idim8
                                Case 110, 213, 322, 413, 414, 415, 502, 963
                                    If idim7 = 0 Then valid = False
                                Case Else
                            End Select
                        End If

                        Select Case idim5
                            Case 200 To 299
                                'custom
                                If idim7 = 0 Then
                                    Select Case idim8
                                        Case 108, 208, 213, 214, 346, 402, 409, 413, 414, 415, 963
                                        Case Else
                                            valid = False
                                    End Select
                                    Select Case idim6
                                        Case 500 To 599, 421
                                        Case Else
                                            valid = False
                                    End Select
                                End If
                                Select Case idim4
                                    Case 2213, 2573, 5300, 7400
                                    Case Else
                                        If dim8.Length < 3 Or idim8 = 0 Then
                                            valid = False
                                        End If
                                End Select
                        End Select
                        Select Case idim5
                            Case 100 To 299
                                valid = True
                                If idim5 = 290 Then
                                    If idim4 <> 5300 Then
                                        valid = False
                                        errorval = dim4
                                        errorphase = "2"
                                        errordescr = "Error: Function Code 5300 Only Valid with " & dim5
                                        GoTo Errorhandle
                                    End If
                                End If
                                If dim8.Length < 3 Then
                                    If idim2 = 83 Then
                                        Select Case idim5
                                            Case 219, 229, 290
                                            Case Else
                                                valid = False
                                        End Select
                                    End If
                                End If
                        End Select
                        If valid = False Then
                            errorval = dim8
                            errorphase = "2"
                            errordescr = "Error Cust: Object Code " & dim5 & " Requires a Job Code"
                            GoTo Errorhandle
                        End If

                        'Added 4.7.2017 Mark
                    Case 310
                        Select Case idim4
                            Case 2321
                                Select Case idim8
                                    Case 115, 690
                                    Case Else
                                        valid = False
                                End Select
                            Case 2300 To 2399
                                 '2310, 2312 To 2319, 2321, 2323, 2330, 2340 '2300 series
                            Case 2541, 2542, 2543, 2544, 2511
                            Case Else
                                valid = False
                                If valid = False Then
                                    errorval = dim4
                                    errorphase = "2"
                                    errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5
                                    GoTo Errorhandle
                                End If
                        End Select


                    Case 320
                        Select Case idim4
                            Case 1000, 2100 To 2199, 2544, 2200 To 2299, 5500 'Added 2330 5.15.2017 Dan
                            Case Else
                                valid = False
                                errorval = dim4
                                errorphase = "2"
                                errordescr = "Error: Function invalid for this object."
                                GoTo Errorhandle
                        End Select

                        If idim9 < 50 Then valid = False 'update from < 100 4.7.2017 Mark

                        If valid = False Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Requires an Operational Unit Code "
                            GoTo Errorhandle
                        End If


                        'Added 4.7.2017 Mark
                    Case 340
                        valid = False

                        If valid = False Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Is Not BOLD"
                            GoTo Errorhandle
                        End If

                          'Added 4.7.2017 Mark
                    Case 341 To 346
                        valid = True

                        If valid = False Then
                            errorval = dim5
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid "
                            GoTo Errorhandle
                        End If

                        'Added 4.7.2017 Mark
                    Case 350
                        valid = True
                        Select Case idim4
                            Case 2317, 3190
                            Case Else
                                valid = False
                        End Select
                        If valid = False Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5
                            GoTo Errorhandle
                        End If

                    Case 360
                        valid = False
                        'validate the function with this object
                        If idim4 = 2194 Then valid = True
                        If idim4 = 2213 Then valid = True
                        If idim4 = 2573 Then valid = True
                        If idim4 = 3180 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 410
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = True 'fix bool val Mark 4.7.2017
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 428
                        valid = False
                        If idim4 = 0 Then valid = True
                        If idim4 = 331 Then valid = True
                        If idim4 = 332 Then valid = True
                        If idim4 = 334 Then valid = True
                        If idim4 = 335 Then valid = True
                        If idim4 = 713 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: project Code " & dim4 & " Invalid with " & dim5 'updated Dan 4.3.2019
                            GoTo Errorhandle
                        End If

                    Case 450
                        valid = False
                        If idim4 >= 2600 Or idim4 <= 2699 Then valid = True
                        'If idim4 >= 3190 Or idim4 <= 3199 Then valid = True 'fix not for entire series Mark 4.7.2017
                        If idim4 = 3190 Then valid = True 'Cfix not for entire series
                        If idim4 >= 4000 Or idim4 <= 4999 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 481
                        valid = False
                        If idim4 = 0 Then valid = True
                        If idim4 = 331 Then valid = True
                        If idim4 = 332 Then valid = True
                        If idim4 = 334 Then valid = True
                        If idim4 = 335 Then valid = True
                        If idim4 = 782 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: project Code " & dim4 & " Invalid with " & dim5 'updated Dan 4.3.2019
                            GoTo Errorhandle
                        End If

                    Case 491
                        valid = False

                        If idim4 = 0 Then valid = True
                        If idim4 = 331 Then valid = True
                        If idim4 = 332 Then valid = True
                        If idim4 = 334 Then valid = True
                        If idim4 = 335 Then valid = True
                        If idim4 = 711 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: project Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 428
                        valid = False

                        If idim4 = 0 Then valid = True
                        If idim4 = 331 Then valid = True
                        If idim4 = 332 Then valid = True
                        If idim4 = 334 Then valid = True
                        If idim4 = 335 Then valid = True
                        If idim4 = 712 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: project Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 511, 512, 513, 515, 516
                        valid = False
                        'validate the function with this object
                        If idim4 = 2720 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 522
                        valid = False
                        If idim4 = 2319 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 3300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 523
                        valid = False
                        'validate the function with this object
                        If idim4 = 2620 Then valid = True
                        If idim4 = 3140 Then valid = True
                        If idim4 = 3160 Then valid = True
                        If idim4 = 5500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 524
                        valid = False
                        If idim4 = 2720 Then valid = True
                        If idim4 = 1000 Then valid = True
                        errorval = dim4
                        errorphase = "2"
                        errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5 'updated Mark 4.7.2017
                        GoTo Errorhandle

                    Case 540
                        valid = False
                        'validate the function with this object

                        Select Case idim4
                            Case 2194, 2199, 2314, 2560, 2571, 3140, 3300
                                valid = True
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with Object " & dim5 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                        'Added Mark 4.7.2017
                    Case 560
                        valid = False
                        If idim4 = 1000 Then valid = True
                        If idim4 = 1500 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Function Code " & dim4 & " Invalid with " & dim5
                            GoTo Errorhandle
                        End If

                    Case 561, 562, 566 'Corrected condition 04.07.2017 Mark;
                        valid = False
                        'If idim4 = 1000 Then valid = True
                        If idim2 = 11 Then valid = True
                        If idim2 = 12 Then valid = True
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Fund" & dim2 'updated Mark 4.7.2017
                            GoTo Errorhandle
                        End If

                    Case 570
                        valid = True

                        Select Case idim6
                            Case 700
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 580
                        valid = True
                        If idim4 >= 4000 And idim4 <= 4999 Then valid = False

                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 620
                        valid = True
                        Select Case idim4
                            Case 1000, 2620, 2630, 2640, 2650, 2720, 2730, 2740, 3140
                            Case 3300
                                If dim6.Substring(0, 1) = "6" Then valid = True
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 630
                        valid = False
                        If idim6 = 700 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        valid = False
                        If idim4 = 3110 And idim6 = 700 Then valid = True
                        If idim4 = 3150 And idim6 = 700 Then valid = True
                        If idim4 = 3155 And idim6 = 700 Then valid = True

                        Select Case idim9
                            Case 50
                                valid = False
                                If idim4 = 3110 And idim6 = 700 Then valid = True
                                If idim4 = 3150 And idim6 = 700 Then valid = True
                                If idim4 = 3155 And idim6 = 700 Then valid = True
                                '
                                errordescr = "Error: Object Code " & dim5 & " Invalid with Site " & dim9
                            Case Else

                        End Select

                        errorval = dim4
                        errorphase = "2"
                        If errordescr.Length = 0 Then errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                        GoTo Errorhandle

                        'Added 04.09.2017 Mark;
                    Case 641 To 648, 651 To 659, 660, 670, 681

                        valid = True
                        If dim9.Length < 3 Then valid = False
                        If idim9 < 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Unit " & dim9
                            GoTo Errorhandle
                        End If

                        Select Case idim5
                            Case 660, 670
                                If idim4 <> 3200 Then
                                    valid = False
                                    errorval = dim4
                                    errorphase = "2"
                                    errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4 'update 4.9.17 Mark
                                    GoTo Errorhandle
                                End If
                        End Select

                    'Case 643, 644
                    '    valid = False
                    '    If idim4 = 1000 Then valid = True
                    '    If idim4 = 5500 Then valid = True
                    '    If Not valid Then
                    '        errorval = dim4
                    '        errorphase = "2"
                    '        errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4 'update 4.9.17 Mark
                    '        GoTo Errorhandle
                    '    End If

                    Case 658
                        valid = False ' correction Mark
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim6 'update 4.9.17 Mark
                            GoTo Errorhandle
                        End If

                    Case 683
                        valid = False ' correction Mark

                        Select Case idim4
                            Case 2199, 3300
                                valid = True
                            Case Else
                                valid = False
                        End Select

                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4 'update 4.9.17 Mark
                            GoTo Errorhandle
                        End If

                    Case 710
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2630 Then valid = True
                        If idim4 = 4200 Then valid = True
                        If idim4 = 4300 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4 'update 4.9.17 Mark
                            GoTo Errorhandle
                        End If

                    Case 720
                        valid = False
                        If idim4 = 2544 Then valid = True
                        If idim4 = 2620 Then valid = True
                        If idim4 >= 4600 Or idim4 <= 4699 Then valid = True
                        If idim4 >= 4700 Or idim4 <= 4799 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4 'update 4.9.17 Mark
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 733, 735, 738
                        valid = True
                        If dim9.Length < 3 Then valid = False
                        If idim9 < 50 Then valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Unit " & dim9
                            GoTo Errorhandle
                        End If

                        valid = False
                        If idim6 = 239 Then valid = True
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 760
                        valid = True
                        Select Case idim4
                            Case 1000, 2650, 2720, 3190
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 820, 831, 832
                        valid = False
                        Select Case idim2
                            Case 12, 21, 41
                                valid = True
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 831, 832
                        valid = False
                        If idim4 = 5100 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017 Mark;
                    Case 833, 834
                        valid = False
                        If idim2 = 41 Then valid = True
                        If Not valid Then
                            errorval = dim2
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Fund " & dim2
                            GoTo Errorhandle
                        End If

                    Case 870
                        valid = False
                        'If idim4 <> 2518 Then valid = True ' upated 4.9.2017 Mark to;
                        If idim4 = 2518 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 880
                        valid = False 'added Mark
                        If idim4 = 2199 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'removed 04.09.2017, Mark;
                        'Case 890
                        '    valid = False
                        '    '    If idim4 = 5200 Then valid = True
                        '    '    If idim4 = 5600 Then valid = True
                        '    '    If idim4 = 5900 Then valid = True
                        '    '    If idim4 = 7400 Then valid = False
                        '    If idim4 = 8100 Then valid = True
                        '    'If idim4 = 8900 Then valid = True
                        '    If Not valid Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Function invalid for this object."
                        '        GoTo Errorhandle
                        '    End If


                        'Added 04.09.2017, Mark;

                    Case 920
                        valid = False
                        If idim4 = 5100 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If


                        ' taken out 06-25-14 -error will always throw - Mark removed 4.09.2017
                        'Case 930
                        '    valid = False
                        '    '    If idim4 = 5200 Then valid = True
                        '    '    If idim4 = 5600 Then valid = True
                        '    '    If idim4 = 5900 Then valid = True
                        '    '    If idim4 = 7400 Then valid = False
                        '    'If idim4 = 8100 Then valid = True
                        '    'If idim4 = 8900 Then valid = True
                        '    If Not valid Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Function invalid for this object."
                        '        GoTo Errorhandle
                        '    End If

                    Case 950
                        valid = True
                        If idim4 <> 5200 Then
                            valid = False
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 960
                        valid = False
                        If idim4 = 5200 Then valid = True
                        'If idim4 = 5300 Then valid = True
                        If idim4 = 5600 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 970
                        valid = False
                        If idim4 = 5200 Then valid = True
                        If idim4 = 5400 Then valid = True
                        If idim4 = 5500 Then valid = True ' corrected 4.9.2017 Mark
                        If idim4 = 5800 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case 981, 982
                        valid = False
                        If idim4 = 3200 Then valid = True
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Object Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                    Case Else
                        valid = True
                End Select


#End Region

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the program dim6 
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'Added 04.09.2017, Mark;
                Select Case idim6
                    Case 277
                        valid = True
                        Select Case idim4
                            Case 2213, 2544, 2573
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        valid = True
                        Select Case idim6
                            Case 0, 308, 311, 332, 334, 335
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 311 To 320
                        valid = True
                        Select Case idim7
                            Case 0
                            Case 5000
                            Case 8000 To 9999
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim7
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Subject " & dim7
                            GoTo Errorhandle
                        End If


                        'Added 04.09.2017, Mark;
                    Case 330 To 390
                        valid = True
                        If idim4 = 1000 Then
                            Select Case idim3
                                Case 0, 331 To 332, 334, 335, 421, 422, 423, 424, 426
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        valid = True
                        If idim4 = 1000 Then
                            Select Case idim7
                                Case 4400, 5000
                                Case 8000 To 9999
                                Case Else
                                    valid = False
                            End Select
                        End If
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 426
                        valid = True
                        Select Case idim3
                            Case 0, 331 To 335, 361, 362
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 427
                        valid = True
                        Select Case idim3
                            Case 0, 331 To 335, 367
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 492
                        valid = True
                        Select Case idim3
                            Case 0, 331 To 335, 553, 554
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 495
                        valid = True
                        Select Case idim3
                            Case 331 To 335, 511 To 791
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 500, 510, 511, 512, 530, 540, 550, 560, 570, 580, 590
                        valid = True
                        Select Case idim3
                            Case 0, 319, 331, 332, 334, 335, 731, 732, 733, 734, 735, 800
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 610
                        valid = True
                        If idim4 <> 3300 Then valid = False
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 620, 630, 640, 650, 690
                        valid = True
                        Select Case idim4
                            Case 3300, 5200, 7800
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim6 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 660
                        valid = True
                        Select Case idim4
                            Case 1000 To 2999
                            Case 3200
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If

                        'Added 04.09.2017, Mark;
                    Case 700
                        valid = True
                        Select Case idim3
                            Case 0, 331, 332, 333, 334, 335, 385, 563, 591, 691, 760 To 769, 770, 791, 799, 800 To 899
                            Case Else
                                valid = False
                        End Select
                        If Not valid Then
                            errorval = dim3
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Project " & dim3
                            GoTo Errorhandle
                        End If

                        valid = True
                        Select Case idim4
                            Case 2318, 3100 To 3199, 5200, 5300, 5400, 5600, 5700, 5900
                            Case 8000 To 8999
                            Case 2199, 2600 To 2699
                                valid = False
                            Case Else
                                valid = True
                        End Select
                        If Not valid Then
                            errorval = dim4
                            errorphase = "2"
                            errordescr = "Error: Program Code " & dim5 & " Invalid with Function " & dim4
                            GoTo Errorhandle
                        End If
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the subject  DIM 7
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                Select Case idim7
                    'removed for now 4.9.201, Mark;

                    Case 0
                        'If idim4 = 1000 And idim5 = 1 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 2 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 130 And idim7 = 0 Then valid = True
                        'If idim4 = 1000 And idim5 = 140 And idim7 = 0 Then valid = True
                        'If idim4 = 1000 And idim5 = 641 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 642 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 643 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 644 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 645 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 731 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 732 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 733 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 734 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 735 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 736 And idim7 = 0 Then valid = False
                        'If idim4 = 1000 And idim5 = 739 And idim7 = 0 Then valid = False
                        'errorval = dim7
                        'errorphase = "2"
                        'errordescr = "Error: Subject is required for function 1000."
                        'GoTo Errorhandle
                    Case 1060
                        valid = False
                        If idim6 = 239 Then valid = True
                        If valid = False Then ' updated 4.9.2017, Mark;
                            errorval = dim6
                            errorphase = "2"
                            errordescr = "Error: Subject Code " & dim7 & " Invalid with Program " & dim6
                            GoTo Errorhandle
                        End If
                        'Case 6000 To 7999
                        '        valid = False
                        '        If Not valid Then
                        '            errorval = dim7
                        '            errorphase = "2"
                        '            errordescr = "Error: subject invalid."
                        '            GoTo Errorhandle
                        '        End If
                    Case Else
                        valid = True
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the jobclass DIM 8 All new added 4/9/2017 no prior entries
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                ' Added 4.9.2017, Mark;
                Select Case idim8
                    Case 0
                        valid = True

                    Case Else
                        valid = False
                        errorval = dim5
                        errorphase = "2"
                        errordescr = "Error: Job Code " & dim8 & " Invalid With Activity Fund"
                        GoTo Errorhandle

                        ' Added 4.9.2017, Mark;
                        'Case 101
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2212, 2321, 2330, 2340, 2410, 2490, 2511, 2520, 2542, 2571, 2575, 2620
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        ' Added 4.9.2017, Mark;
                        'Case 102
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2312, 2319
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 103
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 104
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2490
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 105
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2410, 2571
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 106
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2321
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If
                        '    ' Added 4.9.2017, Mark;
                        '    '   Case 106
                        '    valid = True
                        '    Select Case idim5
                        '        Case 252, 262
                        '            valid = False
                        '        Case Else
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim5
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 107
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2212, 2321, 2330, 2340, 2410, 2490, 2511, 2541, 2560, 2572
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 108
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2212, 2240, 2330, 2340, 2430
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 109
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2112, 2113, 2120, 2132, 2212, 2220, 2230, 2330, 2340, 2490
                        '        Case 2511, 2520, 2530, 2560, 2571, 2572, 2580, 2620, 2660, 2670, 2720
                        '        Case 3120, 3160, 3180, 3190
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 110
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1500, 2112, 2120, 2332, 2140, 2152, 2194, 2199, 2212, 2220, 2330, 2340, 2410, 2430, 2410, 2430, 2490, 2511, 2520
                        '        Case 2542, 2543, 2571, 2580, 2620, 2670, 2720, 3120, 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 112
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2410, 2571, 2573, 2575
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 115
                        '    valid = True
                        '    Select Case idim5
                        '        Case 120, 125, 252, 262
                        '            valid = False
                        '        Case Else
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim5
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Object " & dim5
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 115, 690
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2321, 2573
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 115, 690
                        '    valid = True
                        '    Select Case idim3
                        '        Case 331, 334, 421 To 799
                        '            valid = False
                        '        Case Else
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim3
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Project " & dim3
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 115, 690
                        '    valid = True
                        '    Select Case idim2
                        '        Case 11, 21
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim2
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Fund " & dim2
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 201
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2199
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 202, 203
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2120
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 204
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2212
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 205
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2140, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 206
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2220
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 207
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 208
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2199
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 209
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 210
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 1500, 2192, 2212, 2213, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 211
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2212, 2213
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 212
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2212
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If


                        '    ' Added 4.9.2017, Mark;
                        'Case 213
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If
                        '    ' Added 4.9.2017, Mark;
                        'Case 213
                        '    valid = True
                        '    Select Case idim6
                        '        Case 239, 429, 494
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim6
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Progam " & dim6
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 214
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2112 To 2180, 2194 To 2313, 2316 To 2410, 2490 To 2511, 2520 To 2720, 2740, 3120, 2330 To 3190, 3300, 4400, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If
                        'Case 214
                        '    valid = True
                        '    Select Case idim5
                        '        Case 110, 120
                        '            Select Case idim9
                        '                Case 0
                        '                    valid = False
                        '                    If dim9.Length < 3 Then
                        '                        valid = False
                        '                    End If
                        '            End Select
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim9
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Unit " & dim9
                        '        GoTo Errorhandle
                        '    End If
                        'Case 214
                        '    valid = True
                        '    Select Case idim5
                        '        Case 110, 120
                        '            Select Case idim7
                        '                Case 0
                        '                    valid = False
                        '                    If dim9.Length < 4 Then
                        '                        valid = False
                        '                    End If
                        '            End Select
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim7
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Subject " & dim7
                        '        GoTo Errorhandle
                        '    End If

                        ' Added 4.9.2017, Mark;
                        'Case 215, 216
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2152
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 301
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2313, 2511
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 303
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2410
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 304
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2112
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 305
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2212, 2240, 2511
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 306
                        '    valid = True
                        '    Select Case idim4
                        '        Case 4400
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If


                        '    ' Added 4.9.2017, Mark;
                        'Case 307
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2199, 2575
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 308
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2112
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 309
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2153
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 311
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2572
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If


                        '    ' Added 4.9.2017, Mark;
                        'Case 312
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2511, 2572
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 313
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2113
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If


                        '    ' Added 4.9.2017, Mark;
                        'Case 311
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2572
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 314, 315
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2230, 2580
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 319
                        '    valid = True
                        '    Select Case idim4
                        '        Case 3120, 3180
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 321
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2240, 2544
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 322
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2113, 2194, 2199, 2323, 300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 324
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2230, 2580
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 325
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2330, 2340, 2541
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 327
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2511
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 328
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2332, 2194, 2323, 2340, 2490, 3100 To 3199
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 329
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2317
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 331
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2316
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 332
                        '    valid = True
                        '    Select Case idim4
                        '        Case 230, 2580
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 333
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2132, 2574
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 334
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2135
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 337
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2571, 2572
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 338
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2170, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 339
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2132, 2574
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 341
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2490, 2541
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 343
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2140, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 344
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2323, 2560
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 346
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2199, 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 347
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2132, 2574
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 348
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2112, 2120, 2199, 2410
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 350
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2542, 2543
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 351
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2152
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 352
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2113
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 353
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2152, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 354
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2212, 2213
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 356
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2112
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 358
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 358
                        '    valid = True
                        '    Select Case idim6
                        '        Case 239
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim6
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Program " & dim6
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 351
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2199, 2560, 2572
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 360
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2132, 2573
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 401
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2120
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 402, 403
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        ' Added 4.9.2017, Mark;
                        'Case 403
                        '    valid = True
                        '    Select Case idim6
                        '        Case 239
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim6
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Program " & dim6
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 404
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2120
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 405
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 406
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2230, 2580
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 407
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2199, 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 409
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2132, 2199, 2240, 2660, 2670, 3190
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 410, 411
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2220
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 412
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2140
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 413
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2213, 2192
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 413, 414
                        '    valid = True
                        '    Select Case idim9
                        '        Case 0
                        '            valid = False
                        '        Case Else
                        '            If idim9 < 50 Then
                        '                valid = False
                        '            End If
                        '            valid = True
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim9
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Unit " & dim9
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 414
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 1500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 415
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2213, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 416
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2135, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 417
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2170, 5500
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 502
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2230, 2580, 3190
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 505
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2560
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 506
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2670
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 507
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2132, 2574
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 508
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2220, 2560, 2640
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 510
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2140
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 511
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2511, 2520, 3120
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 513
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2199, 2330, 2500 To 2799, 3100 To 3199, 3300 To 3399, 4700 To 4799
                        '        Case 4610
                        '            If SchoolNumber = "399" Then valid = True
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 601
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2313, 2330, 2511, 3140, 3190, 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 602
                        '    valid = True
                        '    Select Case idim4
                        '        Case 3120, 2511, 2199
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 603
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2230, 2580
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 604
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2112, 2511, 2580, 3190
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 605
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2650, 2660, 2720
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 606
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 2410, 2530
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 607
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2600 To 2699
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 608
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2410, 2511
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 609
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2112, 2120, 2132, 2140, 2194, 2212, 2220, 2321, 2330, 2340, 2410, 2420, 2511, 2520, 2530, 2544, 2560
                        '        Case 2571, 2572, 2620, 2720, 3120, 3150, 3300, 7800
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 610
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2511, 2520, 2573
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 612
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2321, 2410, 2511, 2520, 2620, 3120
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 613
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2321, 2410, 2511, 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 614
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2112, 2332, 2312, 2410, 2511, 2572, 2572, 3120, 3180
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 615
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000, 4000 To 5999, 7000 To 8999
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 617
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2520, 2620, 3130
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 690
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2321, 2573
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 701
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2620, 3140, 3160, 4600 To 4699
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 702
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2620, 2330, 3140, 3160, 4600 To 4699
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 703
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2520, 2530, 3140, 3160, 4600 To 4699
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 704, 705, 706
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2620, 3140, 3160, 4600 To 4699
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 707
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2620, 2630, 2640, 2740, 3140, 3160
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 708
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2620, 3140, 3160
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 710
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2620, 3140, 3160, 4600 To 4799
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 711
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2530
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 712
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2650, 2740
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 801
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2574, 2720, 3190
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 802
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2520, 2620, 2720, 3130
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 803
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2720, 3190
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 901
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2620, 4300, 4600 To 4799
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 902
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2520, 3130
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 905
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2630
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 907
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2640, 2740
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 951
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2199, 2670, 2730
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 952
                        '    valid = True
                        '    Select Case idim4
                        '        Case 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 953
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2199, 3120, 3130, 3160, 3180, 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 954
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2620, 3140, 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 955
                        '    valid = True
                        '    Select Case idim4
                        '        Case 3120, 3150, 3180
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 957
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2620, 2670
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 958
                        '    valid = True
                        '    Select Case idim4
                        '        Case 3120, 3180, 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 959
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2660, 2670
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 961
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2660, 3190
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 962
                        '    valid = True
                        '    Select Case idim4
                        '        Case 3300
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 963
                        '    valid = True
                        '    Select Case idim4
                        '        Case 1000
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 963
                        '    valid = True
                        '    Select Case idim3
                        '        Case 0, 456
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim3
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Project " & dim3
                        '        GoTo Errorhandle
                        '    End If

                        '    ' Added 4.9.2017, Mark;
                        'Case 964
                        '    valid = True
                        '    Select Case idim4
                        '        Case 2600 To 2699, 3120
                        '        Case Else
                        '            valid = False
                        '    End Select
                        '    If valid = False Then
                        '        errorval = dim4
                        '        errorphase = "2"
                        '        errordescr = "Error: Job Code " & dim8 & " Invalid with Function " & dim4
                        '        GoTo Errorhandle
                        '    End If

                        'Case Else
                        '    valid = True
                        '    'valid = False
                End Select

                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'validate the site DIM 9
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

                Select Case idim9
                    ' Added 4.9.2017, Mark;
                    Case 0
                        valid = False
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site Code " & dim9 & " Invalid"
                            GoTo Errorhandle
                        End If

                    Case 50
                        valid = True

                        'Project
                        Select Case idim3
                            Case 0 To 310, 312 To 316, 318, 320 To 328, 333, 336 To 398
                                Select Case idim4
                                    Case 1000, 2120, 2213, 2220, 2400 To 2499
                                        Select Case idim6
                                            Case 511 To 590
                                                valid = True
                                            Case Else
                                                valid = False
                                        End Select
                                        Select Case idim8
                                            Case 110, 211, 405, 415, 615
                                                valid = True
                                            Case Else
                                                valid = False
                                        End Select
                                        valid = False
                                End Select

                            Case 425, 458, 459, 516, 533, 534, 536, 573, 538, 549, 597, 622, 624, 643, 692, 693, 694, 695, 696, 697, 782, 783, 784, 789, 790
                                Select Case idim4
                                    Case 1000, 2132, 2135, 2140, 2194, 2199, 2213, 2330, 2573, 2720, 2730, 5500
                                    Case 5400, 8100
                                        Select Case idim6
                                            Case 239, 429, 494, 495
                                            Case Else
                                                valid = False
                                        End Select
                                    Case Else
                                        valid = False
                                End Select
                                If idim5 = 653 And idim6 = 239 Then valid = True
                                If idim8 = 207 Or idim8 = 211 Then valid = True
                                If idim5 >= 610 And idim5 <= 619 And idim6 = 495 Then valid = True
                                If idim3 = 597 And idim6 = 425 Then valid = True
                                If idim3 = 790 And idim6 = 700 Then valid = True

                        End Select

                        Select Case idim4
                            Case 1000 'Function 1000 invalid with site 050.
                                valid = False
                            Case Else

                        End Select

                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site Code " & dim9 & " Invalid"
                            GoTo Errorhandle
                        End If


                        ' Added 4.9.2017, Mark;
                    Case 998    'Site 998 ????
                        valid = True

                        Select Case idim2
                            Case 12, 21
                            Case Else
                                If SchoolNumber = "134" Then
                                    valid = True
                                Else
                                    valid = False
                                End If
                        End Select
                        If Not valid Then
                            errorval = dim9
                            errorphase = "2"
                            errordescr = "Error: Site Code " & dim9 & " Invalid"
                            GoTo Errorhandle
                        End If


                    Case Else
                        'it should already be rolled to 050 so error if not true
                        valid = True
                End Select

Errorhandle:
                'added this part to handle the warning on objects 100-299
                ' errorphase = "4" pec 04-26-11

                If errorphase = "4" Then
                    valid = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                Else
                    If valid = False Then
                        Me.HasErrors = True
                        With Me.GridDetail
                            .SetData(currow, 11, errorphase)
                            .SetData(currow, 14, errorval)
                            .SetData(currow, 15, errordescr)
                        End With
                    End If
                End If

                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function Revenue2019_Phase1_EditCheck() As Boolean
        'phase 1 rolls the detail codes to the bold.  if a code will not
        'roll, error values (error flag, error message) are inserted
        'into the row for later access.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode As String
        Dim tamt, amt As Double
        Dim tcount, currow, rowindex As Int32

        For currow = 0 To Me.GridDetail.Rows.Count - 1
            errordescr = ""
            errorphase = "0"
            errorval = ""
            revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
            dim1 = revenuecode.Substring(0, 1)
            dim2 = revenuecode.Substring(1, 2)
            dim3 = revenuecode.Substring(3, 3)
            dim4 = revenuecode.Substring(6, 4)
            dim5 = revenuecode.Substring(10, 3)
            dim6 = revenuecode.Substring(13, 3)

            '''''''''''''''''''''''''''''''''''''''''''''
            'year has no validation
            '''''''''''''''''''''''''''''''''''''''''''''

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the fund
            '''''''''''''''''''''''''''''''''''''''''''''
            Select Case dim2
                Case "60"
                    'good
                Case Else
                    'error
                    errorval = dim2
                    errordescr = "Error: Fund 60 required."
                    errorphase = "1"
                    GoTo Errorcatch
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the project
            '''''''''''''''''''''''''''''''''''''''''''''
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp3 As Int32 = CInt(dim3)
            If (temp3 >= 1) And (temp3 <= 298) Then
                dim3 = "000"
            End If
            Dim testdim3 As String = ValidateDim3(dim3)
            Select Case testdim3
                Case "-1"
                    'error
                    errorval = dim3
                    errordescr = "Error: Project not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim3 = testdim3 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the source
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim testdim4 As String = ValidateDim4(dim4)

            Select Case testdim4
                Case "-1"
                    'error
                    errorval = dim4
                    errordescr = "Error: Source not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim4 = testdim4 'get the rolled code
            End Select
            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the program
            '''''''''''''''''''''''''''''''''''''''''''''
            Dim temp5 As Int32 = CInt(dim5)
            If (temp5 >= 700) And (temp5 <= 799) Then
                dim5 = "700"
            End If
            If (temp5 >= 800) And (temp5 <= 899) Then
                dim5 = "800"
            End If
            If (temp5 >= 900) And (temp5 <= 999) Then
                dim5 = "900"
            End If
            Dim testdim5 As String = ValidateRDim5(dim5)
            Select Case testdim5
                Case "-1"
                    'error
                    errorval = dim5
                    errordescr = "Error: Program not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else
                    'good
                    dim5 = testdim5 'get the rolled code
            End Select

            '''''''''''''''''''''''''''''''''''''''''''''
            'roll the site
            '''''''''''''''''''''''''''''''''''''''''''''

            Dim testdim6 As String = ValidateDim6(dim6)

            Dim mysite As String = Me.DistrictId
            Dim myopunit As Char
            myopunit = GetChar(mysite, 1)


            Select Case dim6
                Case "-1"
                    errorval = dim6
                    errordescr = "Error: Site not bold and cannot roll backwards."
                    errorphase = "1"
                    GoTo Errorcatch
                Case Else

                    'if district code = "C" and site = (050) this is invalid as of fiscal year 2010
                    If myopunit = "C" And dim6 > "051" And dim6 < "009" Then
                        errorval = dim6
                        errordescr = "Error: Site code not valid for this district."
                        errorphase = "1"
                        GoTo Errorcatch
                    Else
                        'roll to 050
                        dim6 = dim6
                    End If
            End Select

Errorcatch:
            If errorphase <> "0" Then Me.HasErrors = True
            boldcode = dim1 + dim2 + dim3 + dim4 + dim5 + dim6
            boldcodefmt = dim1 + "-" + dim2 + "-" + dim3 + "-" + dim4 + "-" + dim5 + "-" + dim6
            With Me.GridDetail
                .SetData(currow, 11, errorphase)        'phase
                .SetData(currow, 12, boldcodefmt)       'boldcodefmt
                .SetData(currow, 13, boldcode)          'boldcode
                .SetData(currow, 14, errorval)          'badval 
                .SetData(currow, 15, errordescr)        'error descr
            End With
        Next
    End Function

    Private Function Revenue2019_Phase2_EditCheck() As Boolean
        'Complete Rewrite Mark 4.12.2017
        'phase 2 performs the edit checks for the dimensions used. at this
        'point, the codes have already been rolled to the bold.  Note: the 
        'phaseerror will be accessed to determine if this item should run 
        'thru the edit checks.  If an item failed in phase 1, then it will
        'be skipped in this phase.
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     errordescrs   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, amt As Int32
        Dim revenuecode, boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean
        Dim RecordCount As Double

        valid = True

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1

                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord

                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 13), String)

                If Me._editchk = True Then
                    revenuecode = Me._Revenuecode
                    _ExpenseCodeFlag = False
                    currow = Me.GridDetail.Rows.Count - 1
                End If

                dim1 = revenuecode.Substring(0, 1)
                dim2 = revenuecode.Substring(1, 2)
                dim3 = revenuecode.Substring(3, 3)
                dim4 = revenuecode.Substring(6, 4)
                dim5 = revenuecode.Substring(10, 3)
                dim6 = revenuecode.Substring(13, 3)

                'convert to ints
                idim1 = CInt(dim1)
                idim2 = CInt(dim2)
                idim3 = CInt(dim3)
                idim4 = CInt(dim4)
                idim5 = CInt(dim5)
                idim6 = CInt(dim6)

                'New Project to Perform OCAS Edit Checks, Mark 3.21.2017;

                '===============================FUND CODE======================================================================================
                '                                  IDIM 2
                '=================================================================================================================================
                valid = True

                Select Case idim2

                    'Fund Code 11, 12, 21, 22, 24, 25, 26, 30 Series, 41, 50, 60, 80 Series Requires A Source Code
                'Case 11, 12, 21, 22, 24, 25, 26, 30 To 39, 41, 50, 60, 80
                '        Select Case idim4
                '            Case 0
                '                If idim4 = 0 Then valid = False
                '                errordescr = "ERROR: Fund " & idim2 & " Requires A Source Code"
                '                errorphase = "2"
                '                errorval = dim2
                '                valid = False
                '                valid = False
                '                GoTo Errorhandle
                '        End Select

                    Case 11
                        If idim4 = 0 Then valid = False
                        If valid = False Then
                            errordescr = "ERROR: Fund " & idim2 & " Requires a Source code"
                            errorphase = "2"
                            errorval = dim2
                            valid = False
                            GoTo Errorhandle
                        End If


                        'Fund Code 21 Can Only Use Source Code 1100 Series, 1310, 1320, 1350, 1390, 1410, 1420, 1430, 1440, 1450, 1460, 1490 Series, 1510, 1530,
                        '1550, 1570, 1590, 1610, 1630, 1650, 1660, 1670, 1680, 1690, 2000 Series, 3160, 3190, 3250, 3480, 3610, 3620, 3690, 3890, 4120, 4130, 4131,
                        '4161, 4162, 4163, 4164, 4165, 4689, 4890, 5000 Series, 6000 Series
                        'Except When Using Project Code 431 Only When Using District 55I052 (midwest) --ignored


                    Case 21
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 1100 To 1199
                            Case 1310, 1320, 1350, 1390, 1410, 1420, 1430, 1440, 1450, 1460
                            Case 1490 To 1499
                            Case 1510, 1530, 1550, 1570, 1590, 1610, 1630, 1650, 1660, 1670, 1680, 1690
                            Case 2000 To 2999
                            Case 3160, 3190, 3250, 3480, 3610, 3620, 3690, 3890, 4120, 4130, 4131, 4161, 4162, 4163, 4164, 4165, 4689, 4890
                            Case 5000 To 6999

                            Case Else
                                errordescr = "ERROR: Fund " & dim2 & " Not Valid Against Source: " & idim4
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Fund Code 21 Cannot Use Source Code 3833 Except When Using District 55I052 (midwest) Only When Using Project Code 431
                    Case 21
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 3833
                                errordescr = "ERROR: Fund " & idim2 & " Cannot Use Source Code 3833"
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                valid = False
                                GoTo Errorhandle

                        End Select

                        'Fund Code 22 Can Only Use Program Code 700 Except When Using Project Code 456
                    Case 22
                        If idim4 = 0 Then valid = False
                        RecordCount = RecordCount + 1
                        Select Case idim5
                            Case 700
                                If idim3 = 456 Then
                                Else
                                    valid = False
                                    errordescr = "ERROR: Fund " & idim2 & " Cannot Use Program 700 with Project " & idim3
                                    errorphase = "2"
                                    errorval = dim2
                                    valid = False
                                    GoTo Errorhandle
                                End If
                        End Select

                        'Fund Code 30 Series Can Only Use Source Code 1310, 1340, 1430, 1440, 1590, 1670, 1680, 6110, 6130, 6140, 5111, 5112, 5190, 5600
                    Case 30 To 39
                        If idim4 = 0 Then valid = False
                        RecordCount = RecordCount + 1
                        Select Case idim4
                            Case 1310, 1340, 1430, 1440, 1590, 1670, 1680, 6110, 6130, 6140, 5111, 5112, 5190, 5600
                            Case Else
                                valid = False
                                errordescr = "ERROR: Fund " & idim2 & " Cannot Use Source Code " & idim4
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Fund Code 41 Can Only Use Source Code 1100 Series, 1310, 1340, 1350, 1390, 1410, 1430, 1670, 1680, 2000 Series, 3160, 3190, 3610, 3620,
                        '4161, 5111, 5160, 5190, 5600, 6110, 6130, 6140, 6200
                    Case 41
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 1100 To 1199
                            Case 1310, 1340, 1350, 1390, 1410, 1430, 1670, 1680
                            Case 2000 To 2999
                            Case 3160, 3190, 3610, 3620, 4161, 5111, 5160, 5190, 5600, 6110, 6130, 6140, 6200
                            Case Else
                                valid = False
                                errordescr = "ERROR: Fund " & idim2 & " Cannot Use Source Code " & idim4
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle

                        End Select

                        'Fund Code 50, 60, 80 Series Cannot Use Source Code 4000 Series
                    Case 50 To 69, 80 To 89
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 4000 To 4999
                                errordescr = "ERROR: Fund" & idim2 & " Cannot Use Source Code 4000 Series"
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                GoTo Errorhandle

                        End Select

                        'Fund Code 88 Can Only Use Source Code 1310, 5113, 5600, 6110
                    Case 88
                        RecordCount = RecordCount + 1
                        If idim4 = 0 Then valid = False
                        Select Case idim4
                            Case 1310, 5113, 5600, 6110
                            Case Else
                                errordescr = "ERROR: Fund " & idim2 & " Can Only Use Source Code 1310, 5113, 5600, 6110"
                                errorphase = "2"
                                errorval = dim2
                                valid = False
                                GoTo Errorhandle

                        End Select
                End Select


                '===============================FUND CODE=====================================================================================
                '                                   end idim2 
                '===============================================================================================================================



                '===============================PROJECT CODE======================================================================================
                '                                 Start idim3
                '=================================================================================================================================

                Select Case idim3
                    Case 301 To 319, 333, 337 To 384, 386 To 399
                        If idim2 = 60 Then
                            errordescr = "ERROR: Project Code " + dim3 + " Not Allowed For Activity Fund 60"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                End Select


                Select Case idim3
                    Case 306
                        RecordCount = RecordCount + 1
                        Select Case idim4
                            Case 3490, 6110
                                'Good
                            Case Else
                                errordescr = "ERROR: Project Code " + dim3 + " Invalid For Source Code"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                        End Select


                    Case 307 To 309, 370
                        RecordCount = RecordCount + 1
                        Select Case idim4
                            Case 3690, 6110
                                'Good
                            Case Else
                                errordescr = "ERROR: Project Code " + dim3 + " Invalid For Source Code"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                        End Select

                        If idim3 = 308 Then
                            If idim5 = 277 Then
                                'Good
                            Else
                                errordescr = "ERROR: Project Code 308 Can Only Use Program Code 277"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                            End If
                        End If

                    Case 311
                        RecordCount = RecordCount + 1
                        If idim4 = 3411 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 311 Can Only Use Source Code 3411, 5800,6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 312
                        RecordCount = RecordCount + 1
                        If idim4 = 3412 Or idim4 = 5600 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 312 Can Only Use Source Code 3412, 5600, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 313
                        RecordCount = RecordCount + 1
                        If idim4 = 3480 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 313 Can Only Use Source Code 3480, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 314
                        RecordCount = RecordCount + 1
                        If idim4 = 3450 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 314 Can Only Use Source Code 3450, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 315
                        RecordCount = RecordCount + 1
                        If idim4 = 3360 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 315 Can Only Use Source Code 3360, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 316
                        RecordCount = RecordCount + 1
                        If idim4 = 3411 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 316 Can Only Use Source Code 3411, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 317
                        RecordCount = RecordCount + 1
                        If idim4 = 3440 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 317 Can Only Use Source Code 3440, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 319
                        RecordCount = RecordCount + 1
                        If idim4 = 3430 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 319 Can Only Use Source Code 3430, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        'Project Code 326 Can Only Use District 60I067 -Cushing


                    Case 326, 388
                        RecordCount = RecordCount + 1

                        Select Case idim4
                            Case 3310, 6110, 6200
                                'Good
                            Case Else
                                errordescr = "ERROR: Project Code " + dim3 + " Invalid For Source Code"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 331 To 332, 334 To 335
                        RecordCount = RecordCount + 1
                        If idim4 = 3250 Or idim4 = 6110 Or idim4 = 5150 Or idim4 = 5800 Or idim4 = 6200 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3250, 6110, 5150, 5800, 6200"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 333
                        RecordCount = RecordCount + 1
                        If idim2 = 11 Then
                        Else
                            errordescr = "ERROR: Project Code 333 Can Only Use Fund Code 11"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        If idim4 = 3420 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code 333 Can Only Use Source Code 3420, 5800, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 337, 386, 391, 397, 398
                        RecordCount = RecordCount + 1
                        If idim4 = 3310 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3310, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 338
                        RecordCount = RecordCount + 1
                        If idim4 = 3570 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3570, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 339
                        RecordCount = RecordCount + 1
                        If idim4 = 3650 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3650, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 353
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3650, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 360, 361, 363
                        If idim4 = 3690 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3690, 5800, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        'Project Code 362 Can Only Use Source Code 3690, 5800, 6110 Except When Using Source Code 6140 Only When Using District 36I071 - Ponca City
                    Case 362
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3650, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 365, 368, 369, 396
                        RecordCount = RecordCount + 1
                        If idim4 = 3470 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3470, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 367
                        RecordCount = RecordCount + 1
                        If idim4 = 3415 Or idim4 = 5800 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only Use Source Code 3415, 5800, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 371, 372, 373
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 385
                        RecordCount = RecordCount + 1

                        If dim4.Substring(0, 2) = "37" Or idim4 = 5150 Or idim4 = 6110 Then

                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3700 Series, 5150, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & "  Can Only UseProgram Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 397
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 398
                        RecordCount = RecordCount + 1
                        If idim4 = 3690 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3690, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 411
                        RecordCount = RecordCount + 1
                        If idim4 = 3811 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3811"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 412
                        RecordCount = RecordCount + 1
                        If idim4 = 3812 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3812, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 413
                        RecordCount = RecordCount + 1
                        If idim4 = 3813 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 418
                        RecordCount = RecordCount + 1
                        If idim4 = 3836 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 419
                        RecordCount = RecordCount + 1
                        If idim4 = 3819 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3813"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 421, 422, 423, 424, 426, 427, 429
                        RecordCount = RecordCount + 1
                        If idim4 = 4821 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4821"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 431
                        RecordCount = RecordCount + 1
                        If idim4 = 3833 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3833"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 432
                        RecordCount = RecordCount + 1
                        If idim4 = 3832 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3832"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 433
                        RecordCount = RecordCount + 1
                        If idim4 = 3819 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3819"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 434
                        RecordCount = RecordCount + 1
                        If idim4 = 3834 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3834"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 435
                        RecordCount = RecordCount + 1
                        If idim4 = 3834 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3819"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 436
                        RecordCount = RecordCount + 1
                        If idim4 = 4836 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4836"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 437
                        RecordCount = RecordCount + 1
                        If idim4 = 3837 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3837"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '
                    Case 438
                        RecordCount = RecordCount + 1
                        If idim4 = 3838 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3838"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 441
                        RecordCount = RecordCount + 1
                        If idim4 = 3841 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3841"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 442
                        RecordCount = RecordCount + 1
                        If idim4 = 3842 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3842"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 443
                        RecordCount = RecordCount + 1
                        If idim4 = 3843 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3843"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 444
                        RecordCount = RecordCount + 1
                        If idim4 = 3844 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3844"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 447
                        RecordCount = RecordCount + 1
                        If idim4 = 4847 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4847"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 448
                        RecordCount = RecordCount + 1
                        If idim4 = 3848 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3848"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 451
                        If idim4 = 4850 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4850"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 452
                        RecordCount = RecordCount + 1
                        If idim4 = 4852 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4852"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 454
                        RecordCount = RecordCount + 1
                        If idim4 = 4616 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4616"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        'Except When Using District 16I008(lawton, 52I004
                    Case 456
                        RecordCount = RecordCount + 1
                        If idim4 = 4617 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4617"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 457
                        RecordCount = RecordCount + 1
                        If idim4 = 4618 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4618"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 461
                        If idim4 = 3861 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3861"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 462
                        If idim4 = 3862 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3862"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 463
                        If idim4 = 3852 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3852"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 464
                        If idim4 = 3864 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3864"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 466
                        RecordCount = RecordCount + 1
                        If idim4 = 3866 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3866"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 467
                        RecordCount = RecordCount + 1
                        If idim4 = 4867 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4867"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 468
                        RecordCount = RecordCount + 1
                        If idim4 = 4868 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4868"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 469
                        RecordCount = RecordCount + 1
                        If idim4 = 3892 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3892"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 474
                        RecordCount = RecordCount + 1
                        If idim4 = 4874 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4874"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 475
                        RecordCount = RecordCount + 1
                        If idim4 = 3875 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3875"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 476
                        RecordCount = RecordCount + 1
                        If idim4 = 4876 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4876"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 477
                        RecordCount = RecordCount + 1
                        If idim4 = 4877 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4877"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 478
                        RecordCount = RecordCount + 1
                        If idim4 = 3820 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3820"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 479
                        RecordCount = RecordCount + 1
                        If idim4 = 3879 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3879"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 481
                        RecordCount = RecordCount + 1
                        If idim4 = 4881 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4881"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 483
                        RecordCount = RecordCount + 1
                        If idim4 = 3839 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3839"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 484
                        RecordCount = RecordCount + 1
                        If idim4 = 4882 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4882"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        'Project Code 485 Can Only Use District 55I052 (MIDWEST), 55I041 (WESTERN HeIGHTS  - 880)
                        'READ AS RESERVED FOR THESE TWO SCHOOLS
                    Case 485
                        RecordCount = RecordCount + 1
                        If SchoolNumber = "880" Then
                            If idim4 = 3856 Then
                            Else
                                errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3856"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                            End If
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use District 55I052, 55I041"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 486
                        RecordCount = RecordCount + 1
                        If idim4 = 4886 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4886"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 489
                        RecordCount = RecordCount + 1
                        If idim4 = 3889 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3889"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 491 To 495
                        RecordCount = RecordCount + 1
                        If idim4 = 3890 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 3890"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 511
                        RecordCount = RecordCount + 1
                        If idim4 = 4210 Or idim4 = 4271 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4210, 4271"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 515
                        RecordCount = RecordCount + 1
                        If idim4 = 4210 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4210"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 516, 519
                        RecordCount = RecordCount + 1
                        If idim4 = 4213 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4213"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 517, 518
                        RecordCount = RecordCount + 1
                        If idim4 = 4210 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4210"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 521
                        RecordCount = RecordCount + 1
                        If idim4 = 4230 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4230"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 531, 532
                        RecordCount = RecordCount + 1
                        If idim4 = 4240 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4240"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 541
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Or idim4 = 4441 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271, 4441"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 542, 544, 545
                        RecordCount = RecordCount + 1
                        If idim4 = 4273 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4273"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 543
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 546
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Or idim4 = 4441 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271, 4441"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 548
                        RecordCount = RecordCount + 1
                        If idim4 = 4271 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4271"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 552
                        RecordCount = RecordCount + 1
                        If idim4 = 444 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4443"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 553, 554
                        RecordCount = RecordCount + 1
                        If idim4 = 4443 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4443"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 558
                        RecordCount = RecordCount + 1
                        If idim4 = 4462 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4462"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 559
                        RecordCount = RecordCount + 1
                        If idim4 = 4689 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4689"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 561
                        RecordCount = RecordCount + 1
                        If idim4 = 4140 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4140"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                    Case 563, 564
                        RecordCount = RecordCount + 1
                        If idim4 = 4550 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4550"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 571, 572
                        RecordCount = RecordCount + 1
                        If idim4 = 4281 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4281"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 586
                        RecordCount = RecordCount + 1
                        If idim4 = 271 Or idim4 = 4441 Or idim4 = 4461 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 44271, 4441, 4461"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 587
                        RecordCount = RecordCount + 1
                        If idim4 = 4470 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4470"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 588
                        RecordCount = RecordCount + 1
                        If idim4 = 4180 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4180, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 591, 592, 593
                        RecordCount = RecordCount + 1
                        If idim4 = 4130 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4130, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 594
                        RecordCount = RecordCount + 1
                        If idim4 = 4120 Or idim4 = 6110 Then

                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4120"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 596
                        RecordCount = RecordCount + 1
                        If idim4 = 4480 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4480"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 613, 615, 621, 623, 625, 626, 627 Can Only Use Source Code 4310, 5600 Only When Using District 25I038 (Wynnewood)
                        '               commented out as it passed upload test from state on another district  4.12.2017 Mark
                        ' Case 613, 615, 621, 623, 625, 626, 627
                        'Only for Wynnewood
                        '     errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Only When Using District 25I038 "
                        '        errorphase = "2"
                        '        errorval = dim3 
                        valid = False

                        '                    If idim4 = "4130" Or "5600" Then
                        '                    Else
                        '                        errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4310, 5600"
                        '                        errorphase = "2"
                        '                        errorval = dim3 
                        valid = False

                        '                    End If

                    Case 641, 642
                        RecordCount = RecordCount + 1
                        If idim4 = 4340 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4340"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 651
                        RecordCount = RecordCount + 1
                        If idim4 = 4350 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4350"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 691
                        RecordCount = RecordCount + 1
                        If idim4 = 4560 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4560"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 698
                        RecordCount = RecordCount + 1
                        If idim4 = 4580 Or idim4 = 5600 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4580, 5600, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 731, 732, 733, 734
                        RecordCount = RecordCount + 1
                        If idim4 = 4611 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4611, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 735
                        RecordCount = RecordCount + 1
                        If idim4 = 4613 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4613"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 763, 764, 765, 766, 768, 769, 791
                        RecordCount = RecordCount + 1
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Program Code 700"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                        If idim3 = 763 Then
                            If idim4 = 4710 Or idim4 = 5150 Or idim4 = 6110 Or idim4 = 6200 Then
                            Else
                                errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4710, 5150, 6110, 6200"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                            End If
                        End If

                        If idim3 = 764 Then
                            If idim4 = 4720 Or idim4 = 5150 Or idim4 = 6110 Or idim4 = 6200 Then
                            Else
                                errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4720, 5150, 6110, 6200"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                            End If
                        End If

                    Case 765
                        RecordCount = RecordCount + 1
                        If idim4 = 4730 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4730, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 766
                        RecordCount = RecordCount + 1
                        If idim4 = 4740 Or idim4 = 5150 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4740, 6110, 5150"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 767
                        RecordCount = RecordCount + 1

                        Select Case idim4
                            Case 4770, 4790, 6110
                            Case Else
                                errordescr = "ERROR: Project Code " & idim3 & " Invalid With Source Code"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                        End Select

                        Select Case idim6
                            Case 700
                            Case Else
                                errordescr = "ERROR: Project Code " & idim3 & " Invalid With Program Code"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 768
                        RecordCount = RecordCount + 1
                        If idim4 = 4760 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4760, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 769
                        RecordCount = RecordCount + 1
                        If idim4 = 4750 Or idim4 = 6110 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4750, 6110"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 770 Can Only Use Source Code 6110, 4000 Series Except When Using District 16I008 - Lawton Exception
                    Case 770
                        RecordCount = RecordCount + 1
                        If dim4.Substring(0, 1) = "4" Or idim4 = 6100 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 6110, 4000 Series"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 781
                        RecordCount = RecordCount + 1
                        If idim4 = 4685 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4685"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 790
                        RecordCount = RecordCount + 1
                        If idim4 = 4790 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code 4790"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 791
                        RecordCount = RecordCount + 1
                        If idim4 = 4780 Or idim4 = 5600 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Project Code 799 Can Only Use Source Code 4000 Series
                    Case 799
                        RecordCount = RecordCount + 1

                        Select Case idim4
                            Case 4000 To 4999
                            Case Else
                                errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Source Code"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                        End Select

                        Select Case idim6
                            Case 700
                            Case Else
                                errordescr = "ERROR: Project Code " & idim3 & " Can Only Use Program Code"
                                errorphase = "2"
                                errorval = dim3
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 800 To 899
                        RecordCount = RecordCount + 1
                        If idim2 = 60 Then
                        Else
                            errordescr = "ERROR: Project Code " & idim3 & " Can only use FUND 60"
                            errorphase = "2"
                            errorval = dim3
                            valid = False
                            GoTo Errorhandle
                        End If


                End Select

                '===============================PROJECT CODE=====================================================================================
                '                                  END
                '================================================================================================================================


                '===============================SOURCE CODE=====================================================================================
                '                                  Start
                '================================================================================================================================

                Select Case idim4
                    Case 1000 To 6200
                        If idim6 = 0 Then
                            errordescr = "ERROR: Source Code " & dim4 & " Cannot Use Site Code 000"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If
                    Case Else
                        'Good
                End Select


                Select Case idim4
                    '                   Source Code 1100 Series Can Only Use Fund Code 11, 21, 24, 25, 41
                    Case 1100 To 1199
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11, 21, 24, 25, 41
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 21, 24, 25, 41"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 1310
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 0, 299, 800, 900
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Invalid with Project " & dim3
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 1430
                        RecordCount = RecordCount + 1
                        If idim2 = 41 Then
                        Else
                            errordescr = "Error: Source Code " & idim4 & " Can Only Use Fund 41"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 1700
                        RecordCount = RecordCount + 1
                        If idim5 = 700 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                        If idim3 = 0 Or idim3 = 800 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 000, 800"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 1900
                        RecordCount = RecordCount + 1
                        If idim2 = 60 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 60"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 2000
                        RecordCount = RecordCount + 1
                        If idim2 = 11 Or idim2 = 21 Or idim2 = 25 Or idim2 = 41 Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 11, 21, 25, 41"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If
                        '                Source Code 3000 Series, 4000 Series Cannot Use Fund Code 60
                    Case 3000 To 4999
                        RecordCount = RecordCount + 1

                        If idim2 = 60 Then
                            errordescr = "ERROR: Source Code " & idim4 & " Cannot Use Fund Code 60"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                        '                    Source Code 3110, 3120 Cannot Use District Prefix C - uncoded for now (maple darlington banner greenvile..)

                        '                    Source Code 3111 Can Only Use District 57I002 - Pawhuska[600], 57I011- Shidler, 57I029 - Barnsdall ,
                        '57I030- wayona, 57I038 - Hominy, 57I050 - Prue, 57I090 - Woodland[894], 72I008 -tipton
                    ''Case 3111
                    ''    RecordCount = RecordCount + 1
                    ''    If SchoolNumber = "600" Or SchoolNumber = "894" Then
                    ''        errordescr = "ERROR: Source Code " & idim4 & " Source Code 3111 Can Only Use Specified Districts"
                    ''        errorphase = "2"
                    ''        errorval = dim4
                    ''        valid = False
                    ''        GoTo Errorhandle
                    ''    End If

                    Case 3140
                        RecordCount = RecordCount + 1
                        If dim2 = "11" Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 11"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 3210, 3120
                        RecordCount = RecordCount + 1
                        If dim2 = "11" Then
                        Else
                            errordescr = "ERROR: Source Code " & idim4 & " Can only use Fund 11"
                            errorphase = "2"
                            errorval = dim4
                            valid = False
                            GoTo Errorhandle
                        End If

                    Case 3250
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 331, 332, 334, 335
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 331, 332, 334, 335"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        Select Case idim2
                            Case 11, 12, 21, 22, 26
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 12, 21, 22, 26"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3310
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 326, 381, 388
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 326, 381, 388"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3360
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 315
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 315"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3411
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 311, 316
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 311, 316"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3412
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 312
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 312"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3415
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 367
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 367"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3420
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund 11"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim3
                            Case 333
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 333"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3430
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 319
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 319"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3440
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 317
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 317"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3450
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 314
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 314"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3470
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 365, 368, 369, 396
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 365, 368, 369, 396"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3480
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 313
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 313"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3490
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 306
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 306"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3570
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 338
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 338"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3650
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 339
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 339"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3700 To 3799
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11, 22
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 22"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim5
                            Case 700
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim3
                            Case 385
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 385"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3811
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 411
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 411"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3812
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 412
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 412"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3813
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 413
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 413"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3819
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 419, 433, 435
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 419, 433, 435"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3820
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 478
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 478"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3832
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 432
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 432"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3833
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 431
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 431"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3834
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 434
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 434"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3836
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 418
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 418"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3837
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 437
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 437"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3838
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 438
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 438"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3839
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 483
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 483"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3841
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 441
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 441"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3842
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 442
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 442"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3843
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 443
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 443"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3844
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 444
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 444"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3848
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 448
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 448"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3852
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 463
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 463"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 3856 Can Only Use Project Code 485 Only When Using District 55I052 (MIDWEST CITY-DEL City)
                    Case 3856
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 485
                                '                        Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " District 55I052 Reserved Project Code 485"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3861
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 461
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 461"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3862
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 462
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 462"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3864
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 464
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 464"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3866
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 466
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 466"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3875
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 475
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 475"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3879
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 479
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 479"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3889
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 489
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 489"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3890
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 491, 492, 493, 494, 495
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 491, 492, 493, 494, 495"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 3892
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 469
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 469"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Source Code 4000 Series Cannot Use Project Code 000, 299, 300 Series
                    Case 4000 To 4999
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 0, 299, 300 To 399
                                errordescr = "ERROR: Source Code " & idim4 & " Cannot Use Project Code 000, 299, 300 Series"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4120
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 594, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 594, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4130
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 591, 592, 593, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 591, 592, 593, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim2
                            Case 11, 21
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 21"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4140
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 561, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 561, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4150, 4161, 4162, 4163, 4164, 4165, 4166, 4170
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 770, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 770, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4180
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 588, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 588, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4210
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 511, 515, 517, 518, 785, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 511, 515, 517, 518, 785, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4213
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 502, 503, 504, 516, 519, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 502, 503, 504, 516, 519, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4230
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 521, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 521, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4240
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 531, 532, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 531, 532, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4271
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 511, 541, 543, 546, 548, 586, 785, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 511, 541, 543, 546, 548, 586, 785, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4273
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 542, 544, 545, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 542, 544, 545, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4281
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 571, 572, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 571, 572, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4310
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 613, 615, 621, 623, 625, 626, 627, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 613, 615, 621, 623, 625, 626, 627, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4340
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 641, 642, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 641, 642, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4350
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 651, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 651, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4441
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 541, 546, 586, 786, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 541, 546, 586, 786, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4443
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 553, 554, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 553, 554, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4461
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 586, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 586, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4462
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 558, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 558, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4470
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 587, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 587, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4480
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 596, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 596, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4550
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 563, 564, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 563, 564, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4560
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 691, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 691, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                    Case 4570
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 782, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 698, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select


                    Case 4580
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 698, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 698, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4611
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 731, 732, 733, 734, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 731, 732, 733, 734, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4613
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 735, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 735, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4616
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 454, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 454, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4617
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 456, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 456, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4618
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 457, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 457, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4685
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 781, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 781, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Source Code 4700 Series Can Only Use Fund Code 11, 12, 22
                    Case 4700 To 4799
                        RecordCount = RecordCount + 1
                        Select Case idim2
                            Case 11, 12, 22
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund Code 11, 12, 22"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim5
                            Case 700
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4710
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 763
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 763"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4720
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 764
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 764"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4730
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 765
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 765"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4740
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 766
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 766"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4750
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 769
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 769"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4760
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 768
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 768"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4770
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 767
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 767"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        Select Case idim5
                            Case 700
                                RecordCount = RecordCount + 1
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Program Code 700"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4780
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 791
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 791"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4790
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 790
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 790"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4821
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 421, 422, 423, 424, 426, 427, 429, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 421, 422, 423, 424, 426, 427, 429, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4836
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 436, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 436, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4847
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 447, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 447, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4850
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 451, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 451, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4852
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 452, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 452, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4867
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 467, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 467, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4868
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 468, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 468, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                    Case 4874
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 474, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 474, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4876 Can Only Use Project Code 476, 799
                    Case 4876
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 476, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 476, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'Source Code 4877 Can Only Use Project Code 477, 799
                    Case 4877
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 477, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 477, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4881 Can Only Use Project Code 481, 799
                    Case 4881
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 790
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 481, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4882 Can Only Use Project Code 484, 799
                    Case 4882
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 484, 799
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 484, 799"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Source Code 4886 Can Only Use Project Code 486
                    Case 4886
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 486
                            Case Else
                                errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Project Code 486"
                                errorphase = "2"
                                errorval = dim4
                                valid = False
                                GoTo Errorhandle
                        End Select

                        'commented out by Dan4/2/19
                        'Source Code 5200 Can Only Use Fund Code 11
                        '' Case 5200
                        ''  RecordCount = RecordCount + 1
                        '' Select Case idim2
                        ''Case 11
                        ''Case Else
                        ''errordescr = "ERROR: Source Code " & idim4 & " Can Only Use Fund 11"
                        ''errorphase = "2"
                        ''errorval = dim4
                        ''valid = False
                        ''GoTo Errorhandle
                        ''End Select

                        'todo 3.22.2017 12:45am  Mark
                        'Source Code 5200 Must Be 0 Balance Fund Code!
                        'Source Code 5300 Must Be 0 Balance Fund Code !

                End Select
                '===============================SOURCE CODE=====================================================================================
                '                                  END
                '===============================================================================================================================


                '===============================PROGRAM CODE=====================================================================================
                '                                  START
                '===============================================================================================================================
                Select Case idim5
                    Case 277
                        RecordCount = RecordCount + 1
                        Select Case idim3
                            Case 308
                            Case Else
                                errordescr = "ERROR: Program Code " & idim5 & " Can Only Use Project Code 308"
                                errorphase = "2"
                                errorval = dim5
                                valid = False
                                GoTo Errorhandle
                        End Select
                End Select

                'Program Code 700 Can Only Use Source Code 1310, 1510, 1550, 1590, 1670, 1680, 1700 Series, 3250, 6000 Series, 3700 Series, 4130, 4700
                'Series, 5000 Series
                Select Case idim5
                    Case 700
                        RecordCount = RecordCount + 1
                        Select Case idim4
                            Case 1310, 1510, 1550, 1590, 1670, 1680
                            Case 1700 To 1799
                            Case 3250
                            Case 3700 To 3799
                            Case 4130
                            Case 4700 To 4799
                            Case 5000 To 6999

                            Case Else
                                errordescr = "ERROR: Program Code " & idim5 & " Not Valid Against Source: " & idim4
                                errorphase = "2"
                                errorval = dim5
                                valid = False
                                GoTo Errorhandle
                        End Select
                        'Program Code 700 Can Only Use Project Code 000, 331, 332, 334, 335, 385, 591, 791, 760 Series, 800 Series
                        Select Case idim3
                            Case 0
                            Case 331, 332, 334, 335, 385, 591, 791
                            Case 3250
                            Case 760 To 769
                            Case 800 To 899
                            Case Else
                                errordescr = "ERROR: Program Code " & idim5 & " Not Valid Against Project: " & idim3
                                errorphase = "2"
                                errorval = dim5
                                valid = False
                                GoTo Errorhandle
                        End Select
                End Select

                '===============================PROGRAM CODE=====================================================================================
                '                                  END
                '===============================================================================================================================


                'idim2 & idim3 & idim4 & idim5 & idim6    If SchoolNumber = 880 Then
                ' Case (Left$(idim4, 1) = "3") Or (Left$(idim4, 1) = "4")


                'If idim3 = "385" And (idim2 <> "11" And idim2 <> "22") Then
                '    errordescr = "ERROR: PROJECT 385 MUST BE USED IN FUND 11 OR 22"
                '    errorphase = "2"
                '    errorval = dim4 

                'End If

                'cONDITION CAHNGED RE: pAT 04-2012
                'If Left(idim4, 2) = "17" Then
                '    If idim3 <> "385" And idim3 <> "766" And idim3 <> "769" Then
                '       errordescr = "ERROR: SOURCES IN 1700''s MUST USE PROJECT 385 OR 766 OR 769"
                '       errorphase = "2"
                '       errorval = dim4 


                '   End If
                'End If


                '  If idim2 = "22" And idim4 = "6110" And idim5 = "000" Then
                '      errordescr = "ERROR: FUND 22 MUST USE PROGRAM CODE 700"
                '      errorphase = "2"
                '      errorval = dim4 


                '  End If

                If idim6 = 0 Then
                    RecordCount = RecordCount + 1
                    errordescr = "ERROR: UNIT CANNOT BE 000"
                    errorphase = "2"
                    errorval = dim6
                    valid = False
                    GoTo Errorhandle
                End If


Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function ValidateDim2FundExpense(ByVal expendcode As String) As Boolean
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        'Mark 04212017 not in production yet
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
        Dim boldcode, boldcodefmt As String
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean
        '3.29.2017, Mark;  errorpha

        dim1 = expendcode.Substring(0, 1)
        dim2 = expendcode.Substring(1, 2)
        dim3 = expendcode.Substring(3, 3)
        dim4 = expendcode.Substring(6, 4)
        dim5 = expendcode.Substring(10, 3)
        dim6 = expendcode.Substring(13, 3)
        dim7 = expendcode.Substring(16, 4)
        dim8 = expendcode.Substring(20, 3)
        dim9 = expendcode.Substring(23, 3)
        'convert to ints
        idim1 = CInt(dim1)
        idim2 = CInt(dim2)
        idim3 = CInt(dim3)
        idim4 = CInt(dim4)
        idim5 = CInt(dim5)
        idim6 = CInt(dim6)
        idim7 = CInt(dim7)
        idim8 = CInt(dim8)
        idim9 = CInt(dim9)


        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        'validate the fund DIM 2
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        'Me.ExpDim2Fund_EditCheck()--for future application - split Dim Functions

        Select Case idim2
                    '****Mark added - set default - we are addng other funds so we can incorporate code in merge Program**
                    'Added Fund checks 4.10.2017, Mark;

            Case 11
                valid = True
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim4
                    GoTo Errorhandle
                End If
                        'Added 4.10.2017, Mark;
            Case 21
                valid = True
                If idim4 = 2700 Then
                    'hulbert
                    If SchoolNumber = "337" Then
                        valid = True
                    Else
                        valid = False
                    End If
                End If
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 22
                valid = True
                Select Case idim4
                    Case 3100 To 3199, 5200, 5300, 5400, 5600, 5700, 5800, 8000 To 8999
                    Case Else
                        valid = False
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 22
                valid = True
                Select Case idim6
                    Case 239, 700
                        If idim6 = 293 Then
                            If idim3 = 456 Then
                                valid = True
                            Else
                                valid = False
                            End If
                        End If
                    Case Else
                        valid = False
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim6
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 41
                valid = True
                Select Case idim5
                    Case 310, 833
                        valid = False
                    Case Else
                        valid = True
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 41
                valid = True
                Select Case idim4
                    Case 5100, 5200, 5600
                    Case Else
                        valid = False
                End Select
                If Not valid Then
                    errorval = dim5
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
                    GoTo Errorhandle
                End If



                        'Added 4.10.2017, Mark;
            Case 60
                valid = True
                If dim6.Length < 3 Then valid = False
                If idim6 = 0 Then
                    Select Case idim4
                        Case 2321, 2410
                            valid = True
                        Case Else
                            valid = False
                    End Select
                End If

                Select Case idim3
                    Case 421 To 799
                        valid = False
                    Case Else
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim6
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 82
                valid = True
                Select Case idim4
                    Case 2317, 2511, 2572, 7600, 7710, 7720, 7800
                    Case Else
                        valid = False
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 83
                valid = True
                Select Case idim4
                    Case 7400
                    Case Else
                        valid = False
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 84
                valid = True
                Select Case idim4
                    Case 7500
                    Case Else
                        valid = False
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 85
                valid = True
                Select Case idim4
                    Case 7710, 7720, 7730, 7740
                    Case Else
                        valid = False
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 87
                valid = True
                Select Case idim4
                    Case 7400
                    Case Else
                        valid = False
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                    GoTo Errorhandle
                End If

                        'Added 4.10.2017, Mark;
            Case 88
                valid = True
                Select Case idim4
                    Case 5900
                    Case Else
                        valid = False
                End Select
                If dim4.Length < 4 Then valid = False
                If idim4 = 0 Then valid = False
                If dim5.Length < 3 Then valid = False
                If idim3 = 0 Then valid = False
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
                    GoTo Errorhandle
                End If
            Case Else

                valid = False
                'we did not find a code
                If Not valid Then
                    errorval = dim4
                    errorphase = "2"
                    errordescr = "Error: Fund " & dim2 & " Invalid"
                    GoTo Errorhandle
                End If
        End Select



Errorhandle:
        'added this part to handle the warning on objects 100-299
        ' errorphase = "4" pec 04-26-11

        If errorphase = "4" Then
            valid = True
            With Me.GridDetail
                .SetData(currow, 11, errorphase)
                .SetData(currow, 14, errorval)
                .SetData(currow, 15, errordescr)
            End With
        Else
            If valid = False Then
                Me.HasErrors = True
                With Me.GridDetail
                    .SetData(currow, 11, errorphase)
                    .SetData(currow, 14, errorval)
                    .SetData(currow, 15, errordescr)
                End With
            End If
        End If

        'clear the vars
        errorphase = "0"
        errorval = ""
        errordescr = ""
Skiprecord:




    End Function







    '     Future Function - split dim check: Public Function ExpDim2Fund_EditCheck() As Boolean
    '        'phase 2 performs the edit checks for the dimensions used. at this
    '        'point, the codes have already been rolled to the bold.  Note: the 
    '        'phaseerror will be accessed to determine if this item should run 
    '        'thru the edit checks.  If an item failed in phase 1, then it will
    '        'be skipped in this phase.


    '        '****Mark added - set default - we are addng other funds and all coding, so we can incorporate code in merge Program**
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        '     0           1         2        3        4        5   
    '        '   bank       fisyr    docnumber   amt    count   revenuecode
    '        '     6           7         8        9       10
    '        '   descr     remarks   created    ttype -- NOT USED --
    '        '    11          12        13       14       15   
    '        '  phaseerror boldfmt  boldunfmt errorval errordescr
    '        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '        Dim dim1, dim2, dim3, dim4, dim5, dim6, dim7, dim8, dim9 As String
    '        Dim idim1, idim2, idim3, idim4, idim5, idim6, idim7, idim8, idim9, amt As Int32
    '        Dim expendcode, boldcode, boldcodefmt As String
    '        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
    '        Dim currow, rowindex As Int32
    '        Dim valid As Boolean
    '        '3.29.2017, Mark;  errorphase = "2"   - error caught in phase2 checking


    '        valid = True 'mark added - set default
    '        Try

    '            For currow = 0 To Me.GridDetail.Rows.Count - 1
    '                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
    '                If phaseerror <> "0" Then GoTo Skiprecord

    '                expendcode = DirectCast(Me.GridDetail.GetData(currow, 13), String)
    '                dim1 = expendcode.Substring(0, 1)
    '                dim2 = expendcode.Substring(1, 2)
    '                dim3 = expendcode.Substring(3, 3)
    '                dim4 = expendcode.Substring(6, 4)
    '                dim5 = expendcode.Substring(10, 3)
    '                dim6 = expendcode.Substring(13, 3)
    '                dim7 = expendcode.Substring(16, 4)
    '                dim8 = expendcode.Substring(20, 3)
    '                dim9 = expendcode.Substring(23, 3)
    '                'convert to ints
    '                idim1 = CInt(dim1)
    '                idim2 = CInt(dim2)
    '                idim3 = CInt(dim3)
    '                idim4 = CInt(dim4)
    '                idim5 = CInt(dim5)
    '                idim6 = CInt(dim6)
    '                idim7 = CInt(dim7)
    '                idim8 = CInt(dim8)
    '                idim9 = CInt(dim9)

    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                'validate the fund DIM 2
    '                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    '                Select Case idim2
    '                    '****Mark added - set default - we are addng other funds so we can incorporate code in merge Program**
    '                    'Added Fund checks 4.10.2017, Mark;
    '                Case 11, 12, 21, 22, 24, 25, 26, 30 To 39, 41, 50, 60, 80 To 89
    '                        valid = True
    '                        If dim4.Length < 4 Then valid = False
    '                        If idim4 = 0 Then valid = False
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If
    '                        'Added 4.10.2017, Mark;
    '                    Case 11, 12, 21, 22, 24, 25, 26, 30 To 39, 41, 50, 60, 80 To 89
    '                        valid = True
    '                        If dim5.Length < 3 Then valid = False
    '                        If idim3 = 0 Then valid = False
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim4
    '                            GoTo Errorhandle
    '                        End If
    '                        'Added 4.10.2017, Mark;
    '                    Case 21
    '                        valid = True
    '                        If idim4 = 2700 Then
    '                            'hulbert
    '                            If SchoolNumber = "337" Then
    '                                valid = True
    '                            Else
    '                                valid = False
    '                            End If
    '                        End If
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 22
    '                        valid = True
    '                        Select Case idim4
    '                            Case 3100 To 3199, 5200, 5300, 5400, 5600, 5700, 5800, 8000 To 8999
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 22
    '                        valid = True
    '                        Select Case idim6
    '                            Case 239, 700
    '                                If idim6 = 293 Then
    '                                    If idim3 = 456 Then
    '                                        valid = True
    '                                    Else
    '                                        valid = False
    '                                    End If
    '                                End If
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim6
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 41
    '                        valid = True
    '                        Select Case idim5
    '                            Case 310, 833
    '                                valid = False
    '                            Case Else
    '                                valid = True
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 41
    '                        valid = True
    '                        Select Case idim4
    '                            Case 5100, 5200, 5600
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim5
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Object " & dim5
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 60
    '                        valid = True
    '                        Select Case idim3
    '                            Case 421 To 799
    '                                valid = False
    '                            Case Else
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim3
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Project " & dim3
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 60
    '                        valid = True
    '                        If dim6.Length < 3 Then valid = False
    '                        If idim6 = 0 Then
    '                            Select Case idim4
    '                                Case 2321, 2410
    '                                    valid = True
    '                                Case Else
    '                                    valid = False
    '                            End Select
    '                        End If
    '                        If Not valid Then
    '                            errorval = dim6
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Program " & dim6
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 82
    '                        valid = True
    '                        Select Case idim4
    '                            Case 2317, 2511, 2572, 7600, 7710, 7720, 7800
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 83
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7400
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 84
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7500
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 85
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7710, 7720, 7730, 7740
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 87
    '                        valid = True
    '                        Select Case idim4
    '                            Case 7400
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If

    '                        'Added 4.10.2017, Mark;
    '                    Case 88
    '                        valid = True
    '                        Select Case idim4
    '                            Case 5900
    '                            Case Else
    '                                valid = False
    '                        End Select
    '                        If Not valid Then
    '                            errorval = dim4
    '                            errorphase = "2"
    '                            errordescr = "Error: Fund " & dim2 & " Invalid with Function " & dim4
    '                            GoTo Errorhandle
    '                        End If
    '                    Case Else
    '                        valid = True
    '                End Select

    'Errorhandle:
    '                If valid = False Then
    '                    Me.HasErrors = True
    '                    With Me.GridDetail
    '                        .SetData(currow, 11, errorphase)
    '                        .SetData(currow, 14, errorval)
    '                        .SetData(currow, 15, errordescr)
    '                    End With
    '                End If
    '                'clear the vars
    '                errorphase = "0"
    '                errorval = ""
    '                errordescr = ""
    'Skiprecord:
    '            Next

    '        Catch ex As Exception
    '            Throw
    '        End Try

    '    End Function


#End Region

#Region "  Method Validate Dimensions "

    Private Function ValidateDim3(ByVal edim3code As String) As String
        Dim rowindex, currow, tvalue As Int32
        Dim code, type, valid As String
        Try
            With Me.GridDim3
                rowindex = .FindRow(edim3code, 0, 0, True, True, False)
                'code not found
                If rowindex < 0 Then Return "-1"
                'code found so roll to bold
                For currow = rowindex To 0 Step -1
                    code = DirectCast(.GetData(currow, 0), String)
                    type = DirectCast(.GetData(currow, 1), String).ToUpper
                    valid = DirectCast(.GetData(currow, 2), String).ToUpper
                    '
                    tvalue = CInt(code)
                    Select Case tvalue
                        Case 800 To 998
                            Return "800"
                    End Select
                    If valid <> "Y" Then Return "-1"
                    If type = "B" Or type = "D" Then Return code
                Next
                'if we get this far, then no bold code was found so return garbage
                Return "-1"
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

    Private Function ValidateDim4(ByVal edim4code As String) As String
        Dim rowindex, currow, tvalue As Int32
        Dim code, type, valid As String
        Try
            With Me.GridDim4
                rowindex = .FindRow(edim4code, 0, 0, True, True, False)
                'code not found
                If rowindex < 0 Then Return "-1"
                'code found so roll to bold
                For currow = rowindex To 0 Step -1
                    code = DirectCast(.GetData(currow, 0), String)
                    type = DirectCast(.GetData(currow, 1), String).ToUpper
                    valid = DirectCast(.GetData(currow, 2), String).ToUpper
                    '
                    tvalue = CInt(code)
                    Select Case tvalue
                        Case 1120 To 1122
                            Return "1120"
                        Case 1350 To 1353
                            Return "1350"
                        Case 1690 To 1692
                            Return "1690"
                        Case 1790 To 1796
                            Return "1790"
                        Case 1810 To 1813
                            Return "1810"
                        Case 1910 To 1919
                            Return "1910"
                        Case 1970 To 1972
                            Return "1970"
                    End Select

                    If valid <> "Y" Then Return "-1"
                    If type = "B" Or type = "D" Then Return code
                Next
                'if we get this far, then no bold code was found so return garbage
                Return "-1"
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

    'NEW 2016.07.28 (NOT YET IMPLEMENTED);
    Private Function GetDim5Bold(ByVal evalue As String) As String
        'NOTE: THIS WILL REPLACE THE VALIDATEEDIM5() FUNCTION;
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        'Gets the bold code for the argument dimension value; Note: The
        'respective grid for each dimension is collected at an earlier 
        'point; Fred, 2016.07.28;
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Try
            Dim index, rowindex As Int32
            Dim boldsw, dimvalue, validsw As String
            With Me.GridDim5
                rowindex = .FindRow(evalue, 0, 0, True, True, False)
                'code not found so return invalid flag;
                If rowindex < 0 Then Return "-1"
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                'Start at the occurrence of the dimension, and step backwards
                'thru the grid until a bold code is found;
                ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                For index = rowindex To 0 Step -1
                    dimvalue = CType(.GetData(index, 0), String)
                    boldsw = CType(.GetData(index, 1), String).ToUpper
                    validsw = CType(.GetData(index, 2), String).ToUpper
                    'If bold and valid, then return value;
                    If boldsw = "B" And validsw = "Y" Then Return dimvalue
                    'If invalid then return invalid flag;
                    If validsw <> "Y" Then Return "-1"
                Next
                'If we get this far, then no valid dimension found, so return invalid;
                Return "-1"
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

    Private Function ValidateEDim5(ByVal edim5code As String) As String
        Dim rowindex, currow, tvalue As Int32
        Dim code, type, valid As String
        Try
            With Me.GridDim5
                rowindex = .FindRow(edim5code, 0, 0, True, True, False)
                'code not found
                If rowindex < 0 Then Return "-1"
                'code found so roll to bold
                For currow = rowindex To 0 Step -1
                    code = DirectCast(.GetData(currow, 0), String)
                    type = DirectCast(.GetData(currow, 1), String).ToUpper
                    valid = DirectCast(.GetData(currow, 2), String).ToUpper
                    '
                    tvalue = CInt(code)
                    Select Case tvalue
                        Case 310 To 312
                            Return "310"
                        Case 320 To 323
                            Return "320"
                        'Case 341 To 346
                        '    Return "340"
                        Case 410 To 411
                            Return "410"
                        Case 420 To 429
                            Return "420"
                        Case 430 To 439
                            Return "430"
                        Case 440 To 449
                            Return "440"
                        Case 450 To 459
                            Return "450"
                        Case 580 To 582
                            Return "580"
                        Case 630 To 639
                            Return "630"
                        Case 660 To 669
                            Return "660"
                        Case 670 To 679
                            Return "670"
                        Case 710 To 719
                            Return "710"
                        Case 720 To 729
                            Return "720"
                        Case 760 To 769
                            Return "760"
                    End Select

                    If valid <> "Y" Then Return "-1"
                    If type = "B" Or type = "D" Then Return code
                Next
                'if we get this far, then no bold code was found so return garbage
                Return "-1"
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

    Private Function ValidateRDim5(ByVal edim5code As String) As String
        Dim rowindex, currow, tvalue As Int32
        Dim code, type, valid As String
        Try
            With Me.GridDim5
                rowindex = .FindRow(edim5code, 0, 0, True, True, False)
                'code not found
                If rowindex < 0 Then Return "-1"
                'code found so roll to bold
                For currow = rowindex To 0 Step -1
                    code = DirectCast(.GetData(currow, 0), String)
                    type = DirectCast(.GetData(currow, 1), String).ToUpper
                    valid = DirectCast(.GetData(currow, 2), String).ToUpper
                    '
                    tvalue = CInt(code)
                    Select Case tvalue
                        Case 100 To 199
                            Return "100"
                        Case 700 To 799
                            Return "700"
                        Case 800 To 899
                            Return "800"
                        Case 900 To 999
                            Return "900"
                    End Select
                    If valid <> "Y" Then Return "-1"
                    If type = "B" Or type = "D" Then Return code
                Next
                'if we get this far, then no bold code was found so return garbage
                Return "-1"
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

    Private Function ValidateDim6(ByVal edim6code As String) As String
        Dim rowindex, currow, tvalue As Int32
        Dim code, type, valid As String
        Try
            With Me.GridDim6
                rowindex = .FindRow(edim6code, 0, 0, True, True, False)
                'code not found
                If rowindex < 0 Then Return "-1"
                'code found so roll to bold
                For currow = rowindex To 0 Step -1
                    code = DirectCast(.GetData(currow, 0), String)
                    type = DirectCast(.GetData(currow, 1), String).ToUpper
                    valid = DirectCast(.GetData(currow, 2), String).ToUpper
                    '
                    tvalue = CInt(code)
                    Select Case tvalue
                        Case 100 To 199
                            Return "100"
                        Case 700 To 799
                            Return "700"
                        Case 800 To 899
                            Return "800"
                        Case 900 To 999
                            Return "900"
                    End Select
                    If valid <> "Y" Then Return "-1"
                    If type = "B" Or type = "D" Then Return code
                Next
                'if we get this far, then no bold code was found so return garbage
                Return "-1"
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

    Private Function ValidateDim7(ByVal edim7code As String) As String
        Dim rowindex, currow, tvalue As Int32
        Dim code, type, valid As String
        Try
            With Me.GridDim7
                rowindex = .FindRow(edim7code, 0, 0, True, True, False)
                'code not found
                If rowindex < 0 Then Return "-1"
                'code found so roll to bold
                For currow = rowindex To 0 Step -1
                    code = DirectCast(.GetData(currow, 0), String)
                    type = DirectCast(.GetData(currow, 1), String).ToUpper
                    valid = DirectCast(.GetData(currow, 2), String).ToUpper

                    'The ValidateDim? methods need to be looked at since this isn't
                    'using the dimension tables properly;
                    'Added on 2016.07.28, Fred;
                    'The code is bold and valid, so return;
                    If type = "B" And valid = "Y" Then Return code

                    tvalue = CInt(code)

                    Select Case tvalue
                        Case 1050 To 1059
                            Return "1050"
                        Case 1060 To 1069
                            Return "1060"
                        Case 1110 To 1119
                            Return "1110"
                        Case 1120 To 1129
                            Return "1120"
                        Case 1130 To 1139
                            Return "1130"
                        Case 1140 To 1149
                            Return "1140"
                        Case 1150 To 1159
                            Return "1150"
                        Case 1164 To 1169
                            Return "1164"
                        Case 1170 To 1199
                            Return "1170"
                        Case 1200 To 1209
                            Return "1200"
                        Case 1220 To 1229
                            Return "1220"
                        Case 1230 To 1239
                            Return "1230"
                        Case 1310 To 1319
                            Return "1310"
                        Case 1320 To 1329
                            Return "1320"
                        Case 1330 To 1339
                            Return "1330"
                        Case 1340 To 1349
                            Return "1340"
                        Case 1350 To 1359
                            Return "1350"
                        Case 1360 To 1370
                            Return "1360"
                        Case 1450 To 1459
                            Return "1450"
                        Case 2100 To 2199
                            Return "2100"
                        Case 2200 To 2234
                            Return "2200"
                        Case 2250 To 2299
                            Return "2250"
                        Case 2300 To 2399
                            Return "2300"
                        Case 2400 To 2499
                            Return "2400"
                        Case 2500 To 2599
                            Return "2500"
                        Case 2600 To 2699
                            Return "2600"
                        Case 2700 To 2799
                            Return "2700"
                        Case 2800 To 2911
                            Return "2800"
                        Case 2950 To 2955
                            Return "2950"
                        Case 3000 To 3083
                            Return "3000"
                        Case 3100 To 3227
                            Return "3100"
                        Case 3300 To 3330
                            Return "3300"
                        Case 3400 To 3424
                            Return "3400"
                        Case 3500 To 3790
                            Return "3500"
                        Case 4000 To 4302
                            Return "4000"
                        Case 4400 To 4820
                            Return "4400"
                        Case 5000 To 5350
                            Return "5000"
                        Case 5400 To 5799
                            Return "5400"
                        Case 8000 To 8031
                            Return "8000"
                        Case 8100 To 8252
                            Return "8100"
                        Case 8400 To 8499
                            Return "8400"
                        Case 8550 To 8597
                            Return "8550"
                        Case 8600 To 8627
                            Return "8600"
                        Case 8700 To 8854
                            Return "8700"
                        Case 8900 To 8999
                            Return "8900"
                        Case 9000 To 9020
                            Return "9000"
                        Case 9050 To 9103
                            Return "9050"
                        Case 9125 To 9199
                            Return "9125"
                        Case 9200 To 9233
                            Return "9200"
                        Case 9240 To 9243
                            Return "9240"
                        Case 9250 To 9289
                            Return "9250"
                        Case 9300 To 9399
                            Return "9300"
                        Case 9425 To 9443
                            Return "9425"
                        Case 9475 To 9499
                            Return "9475"
                        Case 9525 To 9563
                            Return "9525"
                        Case 9625 To 9648
                            Return "9625"
                        Case 9675 To 9733
                            Return "9675"
                        Case 9775 To 9813
                            Return "9775"
                        Case 9850 To 9875
                            Return "9850"
                        Case 9900 To 9938
                            Return "9900"
                        Case 9995 To 9998
                            Return "9995"
                    End Select
                    If valid <> "Y" Then Return "-1"
                    If type = "B" Or type = "D" Then Return code
                Next
                'if we get this far, then no bold code was found so return garbage
                Return "-1"
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

    Private Function ValidateDim8(ByVal edim8code As String) As String
        Dim rowindex, currow As Int32
        Dim code, type, valid As String
        Try
            With Me.GridDim8
                rowindex = .FindRow(edim8code, 0, 0, True, True, False)
                'code not found
                If rowindex < 0 Then Return "-1"
                'code found so roll to bold
                For currow = rowindex To 0 Step -1
                    code = DirectCast(.GetData(currow, 0), String)
                    type = DirectCast(.GetData(currow, 1), String).ToUpper
                    valid = DirectCast(.GetData(currow, 2), String).ToUpper
                    If valid <> "Y" Then Return "-1"
                    If type = "B" Or type = "D" Then Return code
                Next
                'if we get this far, then no bold code was found so return garbage
                Return "-1"
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

    Private Function ValidateDim9(ByVal edim9code As String) As String
        Dim rowindex, currow As Int32
        Dim code, type, valid As String

        Try
            With Me.griddim9
                rowindex = .FindRow(edim9code, 0, 0, True, True, False)
                'code(Not found)
                If rowindex < 0 Then Return "-1"
                'code found so roll to bold
                For currow = rowindex To 0 Step -1
                    code = DirectCast(.GetData(currow, 0), String)
                    type = DirectCast(.GetData(currow, 1), String).ToUpper
                    valid = DirectCast(.GetData(currow, 2), String).ToUpper
                    If valid <> "Y" Then Return "-1"
                    If type = "B" Or type = "D" Then Return code
                Next
                'if we get this far, then no bold code was found so return garbage
                Return "-1"
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

    Private Function SummariseGrid() As Boolean
        Dim currow, tcount, rowindex As Int32
        Dim tamt As Decimal
        Dim tboldcode, tprevcode As String
        Try
            With Me.GridDetail
                currow = 0
                Do While currow <= .Rows.Count - 1
                    tboldcode = DirectCast(.GetData(currow, 13), String)
                    tamt = CDec(.GetData(currow, 3))
                    tcount = CInt(.GetData(currow, 4))
                    If tboldcode.Compare(tboldcode, tprevcode) = 0 Then
                        'is the cur = prev
                        .RemoveItem(currow)
                        rowindex = .FindRow(tboldcode, 0, 13, True, True, False)
                        currow -= 1     'go back one row since the current row was just deleted
                        If rowindex >= 0 Then
                            .SetData(rowindex, 3, tamt + CDbl(.GetData(rowindex, 3)))
                            .SetData(rowindex, 4, tcount + CInt(.GetData(rowindex, 4)))
                        End If
                    End If
                    tprevcode = tboldcode
                    currow += 1
                Loop
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

#End Region

#Region "  Methods Generation "

    Friend Sub GenerateBoldCodeExpenditure(ByVal eshowerrorsonly As Boolean, ByVal esortbycoding As Boolean, ByVal selectedfisyr As Int32)
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   expendcode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Try
            'get check tables for expenditures
            Me.FiscalYearSelected = selectedfisyr
            Call GetExpenditureDims()
        Catch ex As Exception
            Throw
        End Try

        If eshowerrorsonly = True Then
            'do the error report;
            Call GenerateBoldCodeExpenditureErrorsOnly(eshowerrorsonly, esortbycoding, selectedfisyr)
            Exit Sub
        End If

        Dim SSQL, SSQL1, SSQL2, SSQL3, SSQL4, SSQL5, SSQL6, SSQL7 As String

        'collection of check items grouped by coding;
        SSQL1 = "SELECT ci.bank_acct_num, ci.chks_fisyr, cd.ocex_code," _
        & " SUM(cd.ckdt_amount) AS chksum, COUNT(*) AS chkcount" _
        & " FROM chks_info AS ci, chks_detl AS cd" _
        & " WHERE ci.chks_autoinc_key = cd.chks_autoinc_key" _
        & " AND (ci.chks_status <> 'V')" _
        & " AND ci.chks_fisyr = @p1" _
        & " GROUP BY ci.bank_acct_num, ci.chks_fisyr, cd.ocex_code" _
        & " ORDER BY cd.ocex_code;"

        'collection of bank charge transaction items grouped by coding;
        SSQL2 = "SELECT bank_acct_num, tran_fisyr, ocex_code," _
        & " SUM(tran_amt) AS transum , COUNT(*) AS trancount" _
        & " FROM transactions" _
        & " WHERE ((tran_type = 'B') OR (tran_type = 'K'))" _
        & " AND tran_fisyr = @p1" _
        & " GROUP BY bank_acct_num, tran_fisyr, ocex_code" _
        & " ORDER BY ocex_code;"

        'collection of expenditure transaction items grouped by coding;
        SSQL3 = "SELECT bank_acct_num, tran_fisyr, ocex_code," _
        & " SUM(tran_amt) AS transum , COUNT(*) AS trancount" _
        & " FROM transactions" _
        & " WHERE tran_type = 'E'" _
        & " AND tran_fisyr = @p1" _
        & " AND (tran_descr NOT LIKE '%VOID CHECK%')" _
        & " GROUP BY bank_acct_num, tran_fisyr, ocex_code" _
        & " ORDER BY ocex_code;"

        'the account beginning balance, changed 10-21-2008;
        'problem with the ahst_current_month not always month ** 1 **
        '& " And ahst_current_month = 1;"
        If Me.FiscalYear = selectedfisyr Then
            SSQL4 = "SELECT SUM(af_beg_year_balance) FROM acct_info;"
        Else
            SSQL4 = "SELECT SUM(ahst_beg_year_balance) FROM acct_history where ahst_fisyr = @p1" _
                 & " And ahst_current_month = (select min(ahst_current_month) from acct_history" _
                 & " where ahst_fisyr = @p1);"
        End If

        'sum of the receipts (should this include voids?);
        SSQL5 = "SELECT ISNULL(SUM(rcdt_amount), 0) FROM receipt_info AS ri, receipt_detl AS rd" _
        & " WHERE ri.bank_acct_num = rd.bank_acct_num" _
        & " AND ri.rcpt_fisyr = rd.rcpt_fisyr" _
        & " AND ri.rcpt_num = rd.rcpt_num" _
        & " AND (ri.rcpt_status <> 'V')" _
        & " AND ri.rcpt_fisyr = @p1;"

        'sum of the checks (should this include voids?);
        SSQL6 = "SELECT ISNULL(SUM(ckdt_amount), 0) FROM chks_info AS ci, chks_detl AS cd" _
        & " WHERE ci.chks_autoinc_key = cd.chks_autoinc_key" _
        & " AND (ci.chks_status <> 'V')" _
        & " AND ci.chks_fisyr = @p1;"

        'sum of the adjustment types;
        SSQL7 = "SELECT DISTINCT" _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'B' AND tran_fisyr = @p1) AS bankcharges," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'E' AND (tran_descr NOT LIKE 'VOID CHECK%') AND tran_fisyr = @p1) AS expenditures," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'I' AND tran_fisyr = @p1) AS interest," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'N' AND tran_fisyr = @p1) AS nsfcharges," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'R' AND (tran_descr NOT LIKE 'VOID RECEIPT%') AND tran_fisyr = @p1) AS revenues," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'J' AND tran_fisyr = @p1) AS legacyreceipts," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'K' AND tran_fisyr = @p1) AS legacychecks" _
        & " FROM transactions"
        SSQL = SSQL1 + SSQL2 + SSQL3 + SSQL4 + SSQL5 + SSQL6 + SSQL7
        cn = New SqlConnection(Me.ConnectionString)
        Dim cmd As New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
        Dim da As New SqlDataAdapter(cmd)
        Dim ds As New DataSet("BoldCodeExpenditure")
        Try
            da.Fill(ds)
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Dim currow, index, curtbl, rowindex As Int32
        Dim tbanknumber, texpendcode As String
        Dim tfisyr, tcount As Int32
        Dim tamount As Decimal
        With Me.GridDetail
            currow = 0
            curtbl = 0          'use table 0 (checks)
            .Cols.Count = 16
            .Rows.Count = 0
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                texpendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String)
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                tcount = CInt(ds.Tables(curtbl).Rows(index).Item(4))
                'find a matching entry in the grid for this code
                rowindex = .FindRow(texpendcode, 0, 5, True, True, False)
                If rowindex < 0 Then
                    'no matching row was found so insert into the grid
                    .Rows.Add()
                    .SetData(currow, 0, tbanknumber)
                    .SetData(currow, 1, tfisyr)
                    .SetData(currow, 3, tamount)
                    .SetData(currow, 4, tcount)
                    .SetData(currow, 5, texpendcode)
                    currow += 1
                End If
                If rowindex >= 0 Then
                    'a match was found in the grid so add the values
                    .SetData(rowindex, 3, tamount + CDbl(.GetData(rowindex, 3)))
                    .SetData(rowindex, 4, tcount + CInt(.GetData(rowindex, 4)))
                End If
            Next
        End With

        With Me.GridDetail
            curtbl = 1  'use table 1 (bank charge adjustments)
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                texpendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String)
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                tcount = CInt(ds.Tables(curtbl).Rows(index).Item(4))
                'bank charges are inherently negative so show the sign;
                If tamount < 0 Then Throw New ArgumentException("Bank charge adjustment contains invalid sign...")
                'why are we doing this??????????
                'tamount *= -1
                'find a matching entry in the grid for this code
                rowindex = .FindRow(texpendcode, 0, 5, True, True, False)
                If rowindex < 0 Then
                    'no matching row was found so insert into the grid
                    .Rows.Add()
                    .SetData(currow, 0, tbanknumber)
                    .SetData(currow, 1, tfisyr)
                    .SetData(currow, 3, tamount)
                    .SetData(currow, 4, tcount)
                    .SetData(currow, 5, texpendcode)
                    currow += 1
                End If
                If rowindex >= 0 Then
                    'a match was found in the grid so add the values
                    .SetData(rowindex, 3, tamount + CDec(.GetData(rowindex, 3)))
                    .SetData(rowindex, 4, tcount + CInt(.GetData(rowindex, 4)))
                End If
            Next
        End With

        With Me.GridDetail
            curtbl = 2  'use table 2 (expenditure adjustments);
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                texpendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String)
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                'If tamount < 0 Then tamount *= -1
                'put in 07-09-2008    tamount *= -1 instead of the line above
                tamount *= -1
                tcount = CInt(ds.Tables(curtbl).Rows(index).Item(4))
                'find a matching entry in the grid for this code
                rowindex = .FindRow(texpendcode, 0, 5, True, True, False)
                If rowindex < 0 Then
                    'no matching row was found so insert into the grid
                    .Rows.Add()
                    .SetData(currow, 0, tbanknumber)
                    .SetData(currow, 1, tfisyr)
                    .SetData(currow, 3, tamount)
                    .SetData(currow, 4, tcount)
                    .SetData(currow, 5, texpendcode)
                    currow += 1
                End If
                If rowindex >= 0 Then
                    'a match was found in the grid so add the values
                    .SetData(rowindex, 3, tamount + CDec(.GetData(rowindex, 3)))
                    .SetData(rowindex, 4, tcount + CInt(.GetData(rowindex, 4)))
                End If
            Next
        End With

        'now do the totals;
        With Me.GridTotals
            .Cols.Count = 10
            .Rows.Count = 1
            curtbl = 3  'use table 3 (bank beginning balance)
            Dim value As Decimal
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                value = CDec(ds.Tables(curtbl).Rows(index).Item(0))
                .SetData(0, 0, value)
            Next
            curtbl = 4  'use table 4 (receipt amount)
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                value = CDec(ds.Tables(curtbl).Rows(index).Item(0))
                .SetData(0, 1, value)
            Next
            curtbl = 5  'use table 5 (check amount)
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                value = CDec(ds.Tables(curtbl).Rows(index).Item(0))
                .SetData(0, 2, value)
            Next
            curtbl = 6  'use table 6 (adjustment amounts)
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                value = CDec(ds.Tables(curtbl).Rows(index).Item(0))
                .SetData(0, 3, value)   'bank charge
                value = CDec(ds.Tables(curtbl).Rows(index).Item(1))
                .SetData(0, 4, value)   'expenditure
                value = CDec(ds.Tables(curtbl).Rows(index).Item(2))
                .SetData(0, 5, value)   'interest
                value = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                .SetData(0, 6, value)   'nsf
                value = CDec(ds.Tables(curtbl).Rows(index).Item(4))
                .SetData(0, 7, value)   'revenue
                value = CDec(ds.Tables(curtbl).Rows(index).Item(5))
                .SetData(0, 8, value)   'legacy receipts
                value = CDec(ds.Tables(curtbl).Rows(index).Item(6))
                .SetData(0, 9, value)   'legacy checks
            Next
        End With

        If Me.GridDetail.Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")

        'GetRidOfZeroAmt()
        GetRidOfZeroAmt()


        Try
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            '     0           1         2        3        4        5   
            '   bank       fisyr    docnumber   amt    count   expendcode
            '     6           7         8        9       10
            '   descr     remarks   created    ttype -- NOT USED --
            '    11          12        13       14       15   
            '  phaseerror boldfmt  boldunfmt errorval errordescr
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            'perform the phase 1 checks: rolling the code to the bold
            Select Case selectedfisyr
                ''Case 2005
                ''    Expenditure2005_Phase1_EditCheck()
                ''Case 2006
                ''    Expenditure2005_Phase1_EditCheck()
                ''Case 2007
                ''    Expenditure2007_Phase1_EditCheck()
                ''Case 2008
                ''    Expenditure2008_Phase1_EditCheck()
                ''Case 2009
                ''    Expenditure2009_Phase1_EditCheck()
                ''Case 2010
                ''    Expenditure2010_Phase1_EditCheck()
                ''Case 2011
                ''    Expenditure2011_Phase1_EditCheck()
                ''Case 2012
                ''    Expenditure2012_Phase1_EditCheck()
                ''Case 2013
                ''    Expenditure2013_Phase1_EditCheck()
                ''Case 2014
                ''    Expenditure2014_Phase1_EditCheck()
                Case 2015
                    Expenditure2015_Phase1_EditCheck()
                Case 2016
                    Expenditure2016_Phase1_EditCheck()
                Case 2017
                    '  If Me._editchk = True Then
                    '' MsgBox("The Final edit checks for this fiscal year have not been released from the State Department. " & vbCrLf & " Please note the results will be based on current available edit checks.", MsgBoxStyle.Information, MSGTITLE)
                    '                    Else
                    Expenditure2017_Phase1_EditCheck()
                Case 2018
                    Expenditure2018_Phase1_EditCheck()
                Case 2019
                    Expenditure2019_Phase1_EditCheck()
                    '                   End If
                Case Else

                    Exit Sub
            End Select

            'sort by boldcode;
            Me.GridDetail.Sort(SortFlags.Ascending, 13)
            'remove duplicates since this is a summary;

            'summarize the entries if same code in grid;
            Call SummariseGrid()

            'perform the phase 2 checks: perform edit checks;
            Select Case selectedfisyr
                ''Case 2005
                ''    Expenditure2005_Phase2_EditCheck()
                ''Case 2006
                ''    Expenditure2005_Phase2_EditCheck()
                ''Case 2007
                ''    Expenditure2007_Phase2_EditCheck()
                ''Case 2008
                ''    Expenditure2008_Phase2_EditCheck()
                ''Case 2009
                ''    Expenditure2009_Phase2_EditCheck()
                ''Case 2010
                ''    Expenditure2010_Phase2_EditCheck()
                ''Case 2011
                ''    Expenditure2011_Phase2_EditCheck()
                ''Case 2012
                ''    Expenditure2012_Phase2_EditCheck()
                ''Case 2013
                ''    Expenditure2013_Phase2_EditCheck()
                ''Case 2014
                ''    Expenditure2014_Phase2_EditCheck()
                Case 2015
                    Expenditure2015_Phase2_EditCheck()
                Case 2016
                    Expenditure2016_Phase2_EditCheck()
                Case 2017
                    Expenditure2017_Phase2_EditCheck()
                Case 2018
                    Expenditure2018_Phase2_EditCheck()
                Case 2019
                    Expenditure2019_Phase2_EditCheck()

                Case Else

            End Select

            'sort by boldcode
            Me.GridDetail.Sort(SortFlags.Ascending, 13)
            'display the number of records
            '''''Me.lblRecordCount.Text = Me.GridDetail.Rows.Count.ToString
        Catch ex As Exception
            Throw
        End Try

        Try
            'With Me.GridDetail
            '    .Visible = True
            '    .Cols(3).Width = 250
            '    .Cols(3).Format = "#####0.00"
            '    .Cols(4).Width = 175
            '    .Cols(5).Width = 175
            '    .Cols(12).Width = 200
            '    .Cols(13).Width = 200
            'End With
            ''
            'Me.Prev1.Visible = False
            'Me.ShowDialog()
            'Exit Sub

            Application.DoEvents()
            'render the table
            Call PrintBoldCodeExpenditure()
            Application.DoEvents()
            Me.ShowDialog()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub GenerateBoldCodeExpenditureErrorsOnly(ByVal eshowerrorsonly As Boolean, ByVal esortbycoding As Boolean, ByVal selectedfisyr As Int32)
        Dim SSQL, SSQL1, SSQL2, SSQL3 As String
        'collection of detail check items
        SSQL1 = "SELECT ci.bank_acct_num, ci.chks_fisyr, ci.chks_num, cd.ckdt_amount," _
        & " cd.ocex_code, ci.chks_payee_name, cd.ckdt_descr, ci.chks_datetime" _
        & " FROM chks_info AS ci, chks_detl AS cd" _
        & " WHERE ci.chks_autoinc_key = cd.chks_autoinc_key" _
        & " AND ci.chks_fisyr = @p1" _
        & " ORDER BY ci.bank_acct_num, ci.chks_fisyr, CAST(ci.chks_num AS INT), cd.ocex_code;"
        'collection of detail bank charge transaction items
        SSQL2 = "SELECT bank_acct_num, tran_fisyr, tran_autoinc_key, tran_amt," _
        & " ocex_code, tran_descr, tran_remarks, tran_datetime, tran_type" _
        & " FROM transactions" _
        & " WHERE ((tran_type = 'B') OR (tran_type = 'K'))" _
        & " AND tran_fisyr = @p1" _
        & " ORDER BY tran_autoinc_key;"
        'collection of detail expenditure transaction items
        SSQL3 = "SELECT bank_acct_num, tran_fisyr, tran_autoinc_key, tran_amt," _
        & " ocex_code, tran_descr, tran_remarks, tran_datetime, tran_type" _
        & " FROM transactions" _
        & " WHERE (tran_type = 'E')" _
        & " AND tran_fisyr = @p1" _
        & " ORDER BY tran_autoinc_key"
        SSQL = SSQL1 + SSQL2 + SSQL3
        cn = New SqlConnection(Me.ConnectionString)
        Dim cmd As New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
        Dim da As New SqlDataAdapter(cmd)
        Dim ds As New DataSet("BoldCodeExpenditureErrors")
        Try
            da.Fill(ds)
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Dim currow, index, curtbl, rowindex As Int32
        Dim tbanknumber, tdocnumber, texpendcode, tdescr, tremarks, ttype As String
        Dim tfisyr, tcount, reccount As Int32
        Dim tdate As Date
        Dim tamount As Decimal
        With Me.GridDetail
            currow = 0      'use table 0
            curtbl = 0
            .Cols.Count = 16
            .Rows.Count = 0
            reccount = ds.Tables(curtbl).Rows.Count

            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String).Trim
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                tdocnumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String).Trim
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                texpendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(4), String).Trim
                tdescr = DirectCast(ds.Tables(curtbl).Rows(index).Item(5), String).Trim
                tremarks = DirectCast(ds.Tables(curtbl).Rows(index).Item(6), String).Trim
                tdate = CDate(ds.Tables(curtbl).Rows(index).Item(7))
                .Rows.Add()     'add a row to the grid
                .SetData(currow, 0, tbanknumber)
                .SetData(currow, 1, tfisyr)
                .SetData(currow, 2, tdocnumber)
                .SetData(currow, 3, tamount)
                .SetData(currow, 5, texpendcode)
                .SetData(currow, 6, tdescr)
                .SetData(currow, 7, tremarks)
                .SetData(currow, 8, tdate)
                .SetData(currow, 9, "T")    'designates this as a receipt
                currow += 1
                EventRecordProcessed((index), reccount)
            Next
        End With

        With Me.GridDetail
            curtbl = 1  'use table 1
            reccount = ds.Tables(curtbl).Rows.Count
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                'this is the trankey
                tcount = CInt(ds.Tables(curtbl).Rows(index).Item(2))
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                texpendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(4), String).Trim
                tdescr = DirectCast(ds.Tables(curtbl).Rows(index).Item(5), String).Trim
                tremarks = DirectCast(ds.Tables(curtbl).Rows(index).Item(6), String).Trim
                tdate = CDate(ds.Tables(curtbl).Rows(index).Item(7))
                ttype = DirectCast(ds.Tables(curtbl).Rows(index).Item(8), String).Trim
                'format the autoinc key to a string
                tdocnumber = tcount.ToString.Format("{0:D8}", tcount)
                .Rows.Add()
                .SetData(currow, 0, tbanknumber)
                .SetData(currow, 1, tfisyr)
                .SetData(currow, 2, tdocnumber)
                .SetData(currow, 3, tamount)
                .SetData(currow, 5, texpendcode)
                .SetData(currow, 6, tdescr)
                .SetData(currow, 7, tremarks)
                .SetData(currow, 8, tdate)
                .SetData(currow, 9, ttype)
                currow += 1
                EventRecordProcessed((index), reccount)
            Next
        End With

        With Me.GridDetail
            curtbl = 2  'use table 2
            reccount = ds.Tables(curtbl).Rows.Count
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                'this is the trankey
                tcount = CInt(ds.Tables(curtbl).Rows(index).Item(2))
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                texpendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(4), String).Trim
                tdescr = DirectCast(ds.Tables(curtbl).Rows(index).Item(5), String).Trim
                tremarks = DirectCast(ds.Tables(curtbl).Rows(index).Item(6), String).Trim
                tdate = CDate(ds.Tables(curtbl).Rows(index).Item(7))
                ttype = DirectCast(ds.Tables(curtbl).Rows(index).Item(8), String).Trim
                'format the autoinc key to a string
                tdocnumber = tcount.ToString.Format("{0:D8}", tcount)
                .Rows.Add()
                .SetData(currow, 0, tbanknumber)
                .SetData(currow, 1, tfisyr)
                .SetData(currow, 2, tdocnumber)
                .SetData(currow, 3, tamount)
                .SetData(currow, 5, texpendcode)
                .SetData(currow, 6, tdescr)
                .SetData(currow, 7, tremarks)
                .SetData(currow, 8, tdate)
                .SetData(currow, 9, ttype)
                currow += 1
                EventRecordProcessed((index), reccount)
            Next
        End With

        If Me.GridDetail.Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")

        Try
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            '     0           1         2        3        4        5   
            '   bank       fisyr    docnumber   amt    count   revenuecode
            '     6           7         8        9       10
            '   descr     remarks   created    ttype -- NOT USED --
            '    11          12        13       14       15   
            '  phaseerror boldfmt  boldunfmt errorval errordescr
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            'perform the phase 1 edit checks; rolling the code to the bold
            If selectedfisyr <= 2006 Then
                ''  Expenditure2005_Phase1_EditCheck()
            Else
                ''  Expenditure2007_Phase1_EditCheck()
            End If
            'sort by boldcode
            Me.GridDetail.Sort(SortFlags.Ascending, 13)
            'perform the phase 2 edit checks; perform edit checks
            If selectedfisyr <= 2006 Then
                ''  Expenditure2005_Phase2_EditCheck()
            Else
                ''  Expenditure2007_Phase2_EditCheck()
            End If
            'define the sort chosen by the user
            If esortbycoding Then
                'sort by boldcode
                Me.GridDetail.Sort(SortFlags.Ascending, 13)
            Else
                'sort by date (default)
                Me.GridDetail.Sort(SortFlags.Ascending, 8)
            End If
        Catch ex As Exception
            Throw
        End Try

        Try
            'since this is an error report, no file will be created so
            'hide the box for file creation, and fill the entire client area
            Me.PanelBoldFail.Visible = False
            Me.PanelBoldSuccess.Visible = False
            Me.Prev1.Location = New Point(0, 0)
            Me.Prev1.Size = Me.ClientSize
            Application.DoEvents()
            'render the table
            PrintBoldCodeExpenditureErrorsOnly()
            Application.DoEvents()
            Me.ShowDialog()
        Catch ex As Exception
            Throw
        End Try

    End Sub

    Friend Sub GenerateBoldCodeRevenue(ByVal eshowerrorsonly As Boolean, ByVal esortbycoding As Boolean, ByVal selectedfisyr As Int32)
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Try
            'get check tables for revenue
            Me.FiscalYearSelected = selectedfisyr
            GetRevenueDims()
        Catch ex As Exception
            Throw
        End Try

        If eshowerrorsonly = True Then
            'do the error report
            GenerateBoldCodeRevenueErrorsOnly(eshowerrorsonly, esortbycoding, selectedfisyr)
            Exit Sub
        End If

        Dim SSQL, SSQL1, SSQL2, SSQL3, SSQL4, SSQL5, SSQL6 As String
        'collection of receipt items grouped by coding
        SSQL1 = "SELECT ri.bank_acct_num, ri.rcpt_fisyr, rd.ocrv_code," _
        & " SUM(rd.rcdt_amount) AS rcptsum, COUNT(*) AS rcptcount" _
        & " FROM receipt_info AS ri, receipt_detl AS rd" _
        & " WHERE ri.bank_acct_num = rd.bank_acct_num" _
        & " AND ri.rcpt_fisyr = rd.rcpt_fisyr" _
        & " AND ri.rcpt_num = rd.rcpt_num" _
        & " AND (ri.rcpt_status <> 'V')" _
        & " AND ri.rcpt_fisyr = @p1" _
        & " GROUP BY ri.bank_acct_num, ri.rcpt_fisyr, rd.ocrv_code" _
        & " ORDER BY CAST(rd.ocrv_code AS BIGINT); "

        'collection of revenue transaction items grouped by coding
        SSQL2 = "SELECT bank_acct_num, tran_fisyr, ocrv_code," _
        & " SUM(tran_amt) AS transum , COUNT(*) AS trancount" _
        & " FROM transactions" _
        & " WHERE ((tran_type = 'J') OR (tran_type = 'I') OR (tran_type = 'R') OR (tran_type = 'N'))" _
        & " AND tran_fisyr = @p1" _
        & " AND (tran_descr NOT LIKE 'VOID RECEIPT%')" _
        & " GROUP BY bank_acct_num, tran_fisyr, ocrv_code" _
        & " ORDER BY CAST(ocrv_code AS BIGINT);"

        'the account beginning balance
        'problem with the ahst_current_month not always month ** 1 **
        '& " And ahst_current_month = 5;"
        If Me.FiscalYear = selectedfisyr Then
            SSQL3 = "SELECT SUM(af_beg_year_balance) FROM acct_info;"
        Else
            SSQL3 = "SELECT SUM(ahst_beg_year_balance) FROM acct_history where ahst_fisyr = @p1" _
                 & " And ahst_current_month = (select min(ahst_current_month) from acct_history" _
                 & " where ahst_fisyr = @p1);"
        End If
        'SSQL3 = "SELECT SUM(af_beg_year_balance) FROM acct_info;"

        'sum of the receipts (should this include voids?)
        SSQL4 = "SELECT ISNULL(SUM(rcdt_amount), 0) FROM receipt_info AS ri, receipt_detl AS rd" _
        & " WHERE ri.bank_acct_num = rd.bank_acct_num" _
        & " AND ri.rcpt_fisyr = rd.rcpt_fisyr" _
        & " AND ri.rcpt_num = rd.rcpt_num" _
        & " AND ri.rcpt_status <> 'V'" _
        & " AND ri.rcpt_fisyr = @p1;"

        'sum of the checks (should this include voids?)
        SSQL5 = "SELECT ISNULL(SUM(ckdt_amount), 0) FROM chks_info AS ci, chks_detl AS cd" _
        & " WHERE ci.chks_autoinc_key = cd.chks_autoinc_key" _
        & " AND (ci.chks_status <> 'V')" _
        & " AND ci.chks_fisyr = @p1;"

        'sum of the adjustment types
        SSQL6 = "SELECT DISTINCT" _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'B' AND tran_fisyr = @p1) AS bankcharges," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'E' AND (tran_descr NOT LIKE 'VOID CHECK%') AND tran_fisyr = @p1) AS expenditures," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'I' AND tran_fisyr = @p1) AS interest," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'N' AND tran_fisyr = @p1) AS nsfcharges," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'R' AND (tran_descr NOT LIKE 'VOID RECEIPT%') AND tran_fisyr = @p1) AS revenues," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'J' AND tran_fisyr = @p1) AS legacyreceipt," _
        & " (SELECT ISNULL(SUM(tran_amt), 0) FROM transactions WHERE tran_type = 'K' AND tran_fisyr = @p1) AS legacycheck" _
        & " FROM transactions"
        SSQL = SSQL1 + SSQL2 + SSQL3 + SSQL4 + SSQL5 + SSQL6
        cn = New SqlConnection(Me.ConnectionString)
        Dim cmd As New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
        Dim da As New SqlDataAdapter(cmd)
        Dim ds As New DataSet("BoldCodeRevenue")
        Try
            da.Fill(ds)
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Try
            'this sets the balance forward code, count, & amount properties
            'to be added to the grid below;
            GetBalanceForwardSumAndCount()
        Catch ex As Exception
            Throw
        End Try

        Dim currow, index, curtbl, rowindex As Int32
        Dim tbanknumber, trevenuecode As String
        Dim tfisyr, tcount As Int32
        Dim tamount As Decimal
        With Me.GridDetail
            currow = 0      'use table 0
            curtbl = 0
            .Cols.Count = 16
            .Rows.Count = 0
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                trevenuecode = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String)
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                tcount = CInt(ds.Tables(curtbl).Rows(index).Item(4))
                'find a matching entry in the grid for this code
                rowindex = .FindRow(trevenuecode, 0, 5, True, True, False)
                If rowindex < 0 Then
                    'no matching row was found so insert into the grid
                    .Rows.Add()
                    .SetData(currow, 0, tbanknumber)
                    .SetData(currow, 1, tfisyr)
                    .SetData(currow, 3, tamount)
                    .SetData(currow, 4, tcount)
                    .SetData(currow, 5, trevenuecode)
                    currow += 1
                End If
                If rowindex >= 0 Then
                    'a match was found in the grid so add the values
                    .SetData(rowindex, 3, tamount + CDbl(.GetData(rowindex, 3)))
                    .SetData(rowindex, 4, tcount + CInt(.GetData(rowindex, 4)))
                End If
            Next
        End With

        With Me.GridDetail
            curtbl = 1  'use table 1
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                trevenuecode = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String)
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                tcount = CInt(ds.Tables(curtbl).Rows(index).Item(4))
                'find a matching entry in the grid for this code
                rowindex = .FindRow(trevenuecode, 0, 5, True, True, False)
                If rowindex < 0 Then
                    'no matching row was found so insert into the grid
                    .Rows.Add()
                    .SetData(currow, 0, tbanknumber)
                    .SetData(currow, 1, tfisyr)
                    .SetData(currow, 3, tamount)
                    .SetData(currow, 4, tcount)
                    .SetData(currow, 5, trevenuecode)
                    currow += 1
                End If
                If rowindex >= 0 Then
                    'a match was found in the grid so add the values
                    .SetData(rowindex, 3, tamount + CDec(.GetData(rowindex, 3)))
                    .SetData(rowindex, 4, tcount + CInt(.GetData(rowindex, 4)))
                End If
            Next
        End With

        'add the balance forward amount, count, & code
        With Me.GridDetail
            .Rows.Add()
            .SetData(currow, 0, tbanknumber)
            .SetData(currow, 1, tfisyr)
            .SetData(currow, 3, Me.BalanceForwardAmount)
            .SetData(currow, 4, Me.BalanceForwardCount)
            .SetData(currow, 5, Me.BalanceForwardCode)
        End With


        'now do the totals
        With Me.GridTotals
            .Cols.Count = 10
            .Rows.Count = 1
            curtbl = 2  'use table 2 (sum acct beginning balances)
            Dim value As Decimal
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                value = CDec(ds.Tables(curtbl).Rows(index).Item(0))
                .SetData(0, 0, value)
            Next

            curtbl = 3  'use table 3 (receipt amount)
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                value = CDec(ds.Tables(curtbl).Rows(index).Item(0))
                .SetData(0, 1, value)
            Next

            curtbl = 4  'use table 4 (check amount)
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                value = CDec(ds.Tables(curtbl).Rows(index).Item(0))
                .SetData(0, 2, value)
            Next

            curtbl = 5  'use table 5 (adjustment amounts)
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                value = CDec(ds.Tables(curtbl).Rows(index).Item(0))
                .SetData(0, 3, value)   'bank charge
                value = CDec(ds.Tables(curtbl).Rows(index).Item(1))
                .SetData(0, 4, value)   'expenditure
                value = CDec(ds.Tables(curtbl).Rows(index).Item(2))
                .SetData(0, 5, value)   'interest
                value = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                .SetData(0, 6, value)   'nsf
                value = CDec(ds.Tables(curtbl).Rows(index).Item(4))
                .SetData(0, 7, value)   'revenue
                value = CDec(ds.Tables(curtbl).Rows(index).Item(5))
                .SetData(0, 8, value)   'legacy receipt
                value = CDec(ds.Tables(curtbl).Rows(index).Item(6))
                .SetData(0, 9, value)   'legacy check
            Next
        End With

        If Me.GridDetail.Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")

        Try
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            '     0           1         2        3        4        5   
            '   bank       fisyr    docnumber   amt    count   revenuecode
            '     6           7         8        9       10
            '   descr     remarks   created    ttype -- NOT USED --
            '    11          12        13       14       15   
            '  phaseerror boldfmt  boldunfmt errorval errordescr
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            'perform the phase 1 edit checks; rolling the code to the bold

            Select Case selectedfisyr
                'Case 2005, 2006
                '    Revenue2005_Phase1_EditCheck()
                'Case 2007
                '    Revenue2007_Phase1_EditCheck()
                'Case 2008
                '    Revenue2008_Phase1_EditCheck()
                'Case 2009
                '    Revenue2009_Phase1_EditCheck()
                'Case 2010
                '    Revenue2010_Phase1_EditCheck()
                'Case 2011
                '    Revenue2011_Phase1_EditCheck()
                'Case 2012
                '    Revenue2012_Phase1_EditCheck()
                'Case 2013
                '    Revenue2013_Phase1_EditCheck()
                'Case 2014
                '    Revenue2014_Phase1_EditCheck()
                Case 2015
                    Revenue2015_Phase1_EditCheck()
                Case 2016
                    Revenue2016_Phase1_EditCheck()
                Case 2017
                    Revenue2017_Phase1_EditCheck()
                Case 2018
                    Revenue2018_Phase1_EditCheck()
                Case 2019
                    Revenue2019_Phase1_EditCheck()
                Case Else
                    ''MsgBox("The edit checks for this fiscal year have not been released from the State Department.  You may not run the Bold Code report until further notice.", MsgBoxStyle.Exclamation, MSGTITLE)
                    Exit Sub
            End Select

            'sort by boldcode
            Me.GridDetail.Sort(SortFlags.Ascending, 13)

            'remove duplicates since this is a summary
            SummariseGrid()

            'perform the phase 2 edit checks; perform edit checks

            Select Case selectedfisyr
                ''Case 2005, 2006
                ''    Revenue2005_Phase2_EditCheck()
                ''Case 2007
                ''    Revenue2007_Phase2_EditCheck()
                ''Case 2008
                ''    Revenue2008_Phase2_EditCheck()
                ''Case 2009
                ''    Revenue2009_Phase2_EditCheck()
                ''Case 2010
                ''    Revenue2010_Phase2_EditCheck()
                ''Case 2011
                ''    Revenue2011_Phase2_EditCheck()
                ''Case 2012
                ''    Revenue2012_Phase2_EditCheck()
                ''Case 2013
                ''    Revenue2013_Phase2_EditCheck()
                ''Case 2014
                ''    Revenue2014_Phase2_EditCheck()
                Case 2015
                    Revenue2015_Phase2_EditCheck()
                Case 2016
                    Revenue2016_Phase2_EditCheck()
                Case 2017
                    Revenue2017_Phase2_EditCheck() 'update mark 4.12.17
                Case 2018
                    Revenue2018_Phase2_EditCheck()
                Case 2019
                    Revenue2019_Phase2_EditCheck()
                Case Else

            End Select

            'here's where to put edit checks on amounts less than zero.
            CheckForNegRev()

            'sort by boldcode
            Me.GridDetail.Sort(SortFlags.Ascending, 13)
            'display the number of records
            '''''Me.lblRecordCount.Text = Me.GridDetail.Rows.Count.ToString
        Catch ex As Exception
            Throw
        End Try

        Try
            Application.DoEvents()
            'render the table
            PrintBoldCodeRevenue()
            Application.DoEvents()
            Me.ShowDialog()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub GenerateBoldCodeRevenueErrorsOnly(ByVal eshowerrorsonly As Boolean, ByVal esortbycoding As Boolean, ByVal selectedfisyr As Int32)
        Dim SSQL, SSQL1, SSQL2 As String
        'collection of detail receipt items
        SSQL1 = "SELECT ri.bank_acct_num, ri.rcpt_fisyr, ri.rcpt_num, rd.rcdt_amount," _
        & " rd.ocrv_code, ri.rcpt_rcvd_from, rd.rcdt_remarks, ri.rcpt_datetime" _
        & " FROM receipt_info AS ri, receipt_detl AS rd" _
        & " WHERE ri.bank_acct_num = rd.bank_acct_num" _
        & " AND ri.rcpt_fisyr = rd.rcpt_fisyr" _
        & " AND ri.rcpt_fisyr = @p1" _
        & " AND ri.rcpt_num = rd.rcpt_num" _
        & " ORDER BY ri.bank_acct_num, ri.rcpt_fisyr, CAST(ri.rcpt_num AS INT), CAST(rd.ocrv_code AS BIGINT);"
        'collection of detail revenue transaction items
        SSQL2 = "SELECT bank_acct_num, tran_fisyr, tran_autoinc_key, tran_amt," _
        & " ocrv_code, tran_descr, tran_remarks, tran_datetime, tran_type" _
        & " FROM transactions" _
        & " WHERE ((tran_type = 'I') OR (tran_type = 'J') OR (tran_type = 'N') OR (tran_type = 'R'))" _
        & " AND tran_fisyr = @p1" _
        & " ORDER BY tran_autoinc_key;"

        SSQL = SSQL1 + SSQL2
        cn = New SqlConnection(Me.ConnectionString)
        Dim cmd As New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
        Dim da As New SqlDataAdapter(cmd)
        Dim ds As New DataSet("BoldCodeRevenueErrors")
        Try
            da.Fill(ds)
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Dim currow, index, curtbl, rowindex As Int32
        Dim tbanknumber, tdocnumber, trevenuecode, tdescr, tremarks, ttype As String
        Dim tfisyr, tcount, reccount As Int32
        Dim tdate As Date
        Dim tamount As Decimal

        With Me.GridDetail
            currow = 0      'use table 0
            curtbl = 0
            .Cols.Count = 16
            .Rows.Count = 0

            reccount = ds.Tables(curtbl).Rows.Count
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String).Trim
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                tdocnumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String).Trim
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                trevenuecode = DirectCast(ds.Tables(curtbl).Rows(index).Item(4), String).Trim
                tdescr = DirectCast(ds.Tables(curtbl).Rows(index).Item(5), String).Trim
                tremarks = DirectCast(ds.Tables(curtbl).Rows(index).Item(6), String).Trim
                tdate = CDate(ds.Tables(curtbl).Rows(index).Item(7))
                .Rows.Add()     'add a row to the grid
                .SetData(currow, 0, tbanknumber)
                .SetData(currow, 1, tfisyr)
                .SetData(currow, 2, tdocnumber)
                .SetData(currow, 3, tamount)
                .SetData(currow, 5, trevenuecode)
                .SetData(currow, 6, tdescr)
                .SetData(currow, 7, tremarks)
                .SetData(currow, 8, tdate)
                .SetData(currow, 9, "T")    'designates this as a receipt
                currow += 1
                EventRecordProcessed((index), reccount)
            Next
        End With

        With Me.GridDetail
            curtbl = 1  'use table 1
            reccount = ds.Tables(curtbl).Rows.Count
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                'this is the trankey
                tcount = CInt(ds.Tables(curtbl).Rows(index).Item(2))
                tamount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                trevenuecode = DirectCast(ds.Tables(curtbl).Rows(index).Item(4), String).Trim
                tdescr = DirectCast(ds.Tables(curtbl).Rows(index).Item(5), String).Trim
                tremarks = DirectCast(ds.Tables(curtbl).Rows(index).Item(6), String).Trim
                tdate = CDate(ds.Tables(curtbl).Rows(index).Item(7))
                ttype = DirectCast(ds.Tables(curtbl).Rows(index).Item(8), String).Trim
                'format the autoinc key to a string
                tdocnumber = tcount.ToString.Format("{0:D8}", tcount)
                .Rows.Add()
                .SetData(currow, 0, tbanknumber)
                .SetData(currow, 1, tfisyr)
                .SetData(currow, 2, tdocnumber)
                .SetData(currow, 3, tamount)
                .SetData(currow, 5, trevenuecode)
                .SetData(currow, 6, tdescr)
                .SetData(currow, 7, tremarks)
                .SetData(currow, 8, tdate)
                .SetData(currow, 9, ttype)
                currow += 1
                EventRecordProcessed((index), reccount)
            Next
        End With

        If Me.GridDetail.Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")

        Try
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            '     0           1         2        3        4        5   
            '   bank       fisyr    docnumber   amt    count   revenuecode
            '     6           7         8        9       10
            '   descr     remarks   created    ttype -- NOT USED --
            '    11          12        13       14       15   
            '  phaseerror boldfmt  boldunfmt errorval errordescr
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            'perform the phase 1 edit checks; rolling the code to the bold
            If selectedfisyr <= 2006 Then
                '  Revenue2005_Phase1_EditCheck()
            Else
                '  Revenue2007_Phase1_EditCheck()
            End If

            'sort by boldcode
            Me.GridDetail.Sort(SortFlags.Ascending, 13)

            'perform the phase 2 edit checks; perform edit checks
            If selectedfisyr <= 2006 Then
                '  Revenue2005_Phase2_EditCheck()
            Else
                '  Revenue2007_Phase2_EditCheck()
            End If

            'define the sort chosen by the user
            If esortbycoding Then
                'sort by boldcode
                Me.GridDetail.Sort(SortFlags.Ascending, 13)
            Else
                'sort by date (default)
                Me.GridDetail.Sort(SortFlags.Ascending, 8)
            End If
        Catch ex As Exception
            Throw
        End Try

        Try
            'since this is an error report, no file will be created so
            'hide the box for file creation, and fill the entire client area
            Me.PanelBoldFail.Visible = False
            Me.PanelBoldSuccess.Visible = False
            Me.Prev1.Location = New Point(0, 0)
            Me.Prev1.Size = Me.ClientSize
            Application.DoEvents()
            'render the table
            PrintBoldCodeRevenueErrorsOnly()
            Application.DoEvents()
            Me.ShowDialog()
        Catch ex As Exception
            Throw
        End Try

    End Sub

    Friend Sub GenerateClassificationRevenueDetailListing(ByVal ebankaccountnumber As String, ByVal efiscalyear As Int32, ByVal estartdate As Date, ByVal eenddate As Date, ByVal ereporttype As Int32, ByVal eusefilter As Boolean, ByVal eclassfilter As String)
        '''''''''''''''''''''''''''' GridDetail ''''''''''''''''''''''''''''''
        '     0          1         2         3        4       5       6  
        '   amount    number     class     descr    issued   key   doctype
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Dim SSQL, filter As String
        Dim result As Boolean

        If eusefilter Then
            filter = " AND d.ocrv_code LIKE " & ConvertFilter(eclassfilter)
        End If

        result = CollectRevenueExpendTotals(ebankaccountnumber, efiscalyear)
        If Not result Then
            Throw New ArgumentException("An error has occured while collecting summary totals")
        End If

        'collection of detail receipt items(0);
        SSQL = "SELECT SUM(d.rcdt_amount), r.rcpt_num, d.ocrv_code, r.rcpt_rcvd_from," _
        & " r.rcpt_datetime, r.rcpt_autoinc_key, 'R'" _
        & " FROM receipt_info AS r, receipt_detl AS d" _
        & " WHERE r.bank_acct_num = d.bank_acct_num" _
        & " AND r.rcpt_fisyr = d.rcpt_fisyr" _
        & " AND r.rcpt_num = d.rcpt_num" _
        & " AND r.bank_acct_num = @p1" _
        & " AND r.rcpt_fisyr = @p2" _
        & " AND r.rcpt_applied_date BETWEEN @p3 AND @p4" _
        & filter _
        & " GROUP BY r.rcpt_num, d.ocrv_code, r.rcpt_rcvd_from, r.rcpt_datetime, r.rcpt_autoinc_key" _
        & " ORDER BY r.rcpt_datetime; "

        'collection of interest transaction items(1);
        SSQL &= "SELECT tran_amt, CAST(tran_autoinc_key AS VARCHAR), ocrv_code, tran_remarks," _
        & " tran_datetime, tran_autoinc_key, 'I'" _
        & " FROM transactions AS d" _
        & " WHERE ((tran_type = 'I'))" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2" _
        & " AND tran_applied_date BETWEEN @p3 AND @p4" _
        & filter _
        & " ORDER BY tran_datetime; "

        'collections of legacy receipts(2);
        SSQL &= "SELECT tran_amt, CAST(tran_autoinc_key AS VARCHAR), ocrv_code, tran_remarks," _
        & " tran_datetime, tran_autoinc_key, 'J'" _
        & " FROM transactions AS d" _
        & " WHERE ((tran_type = 'J'))" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2" _
        & " AND tran_applied_date BETWEEN @p3 AND @p4" _
        & filter _
        & " ORDER BY tran_datetime; "

        'collections of nsf(3);
        SSQL &= "SELECT tran_amt, CAST(tran_autoinc_key AS VARCHAR), ocrv_code, tran_remarks," _
        & " tran_datetime, tran_autoinc_key, 'N'" _
        & " FROM transactions AS d" _
        & " WHERE ((tran_type = 'N'))" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2" _
        & " AND tran_applied_date BETWEEN @p3 AND @p4" _
        & filter _
        & " ORDER BY tran_datetime; "

        'collections of revenue adjustments(4);
        SSQL &= "SELECT tran_amt, CAST(tran_autoinc_key AS VARCHAR), ocrv_code, tran_remarks," _
        & " tran_datetime, tran_autoinc_key, 'T'" _
        & " FROM transactions AS d" _
        & " WHERE ((tran_type = 'R'))" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2" _
        & " AND tran_applied_date BETWEEN @p3 AND @p4" _
        & filter _
        & " ORDER BY tran_datetime; "

        ' need to collect all totals here
        ' interest, bank charges, revenue adjustments, nsf, expenditure adjustments, legacy receipts
        ' legacy checks, expenditures

        cn = New SqlConnection(Me.ConnectionString)
        Dim cmd As New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", ebankaccountnumber)
        cmd.Parameters.Add("@p2", efiscalyear)
        cmd.Parameters.Add("@p3", estartdate)
        cmd.Parameters.Add("@p4", eenddate)
        Dim da As New SqlDataAdapter(cmd)
        Dim ds As New DataSet("RevenueListing")
        Try
            da.Fill(ds)
            'load the first table into the detail grid;
            Me.GridDetail.DataSource = ds.Tables(0)
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Dim currow, index, key As Int32
        Dim classcode, docnumber, doctype, descr As String
        Dim ebanknumber As String
        Dim amount As Decimal
        Dim issued As Date
        'ebanknumber = ebankaccountnumber

        With Me.GridDetail
            'add the transaction records to the detail grid(interest);
            With ds.Tables(1)
                For index = 0 To .Rows.Count - 1
                    amount = CDec(.Rows(index).Item(0))
                    docnumber = DirectCast(.Rows(index).Item(1), String)
                    classcode = DirectCast(.Rows(index).Item(2), String)
                    descr = DirectCast(.Rows(index).Item(3), String)
                    issued = CDate(.Rows(index).Item(4))
                    key = CInt(.Rows(index).Item(5))
                    doctype = DirectCast(.Rows(index).Item(6), String)
                    'ebanknumber = DirectCast(.Rows(index).Item(7), String)

                    With Me.GridDetail
                        .Rows.Add()
                        currow = .Rows.Count - 1
                        .SetData(currow, 0, amount)
                        .SetData(currow, 1, docnumber)
                        .SetData(currow, 2, classcode)
                        .SetData(currow, 3, descr)
                        .SetData(currow, 4, issued)
                        .SetData(currow, 5, key)
                        .SetData(currow, 6, doctype)
                        '.SetData(currow, 7, ebanknumber)
                    End With
                Next
            End With
        End With
        With Me.GridDetail
            'add the transaction records to the detail grid(legacy receipt);
            With ds.Tables(2)
                For index = 0 To .Rows.Count - 1
                    amount = CDec(.Rows(index).Item(0))
                    docnumber = DirectCast(.Rows(index).Item(1), String)
                    classcode = DirectCast(.Rows(index).Item(2), String)
                    descr = DirectCast(.Rows(index).Item(3), String)
                    issued = CDate(.Rows(index).Item(4))
                    key = CInt(.Rows(index).Item(5))
                    doctype = DirectCast(.Rows(index).Item(6), String)
                    'ebanknumber = DirectCast(.Rows(index).Item(7), String)

                    With Me.GridDetail
                        .Rows.Add()
                        currow = .Rows.Count - 1
                        .SetData(currow, 0, amount)
                        .SetData(currow, 1, docnumber)
                        .SetData(currow, 2, classcode)
                        .SetData(currow, 3, descr)
                        .SetData(currow, 4, issued)
                        .SetData(currow, 5, key)
                        .SetData(currow, 6, doctype)
                        '.SetData(currow, 7, ebanknumber)
                    End With
                Next
            End With
            If eusefilter Then
            Else
                If .Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")
                'sort by class code;
                .Sort(SortFlags.Ascending, 2)
                .Select(0, 2)
                Application.DoEvents()
            End If
            'If .Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")

            'sort by class code;
            '.Sort(SortFlags.Ascending, 2)
            '.Select(0, 2)
            'Application.DoEvents()
        End With

        With Me.GridDetail
            'add the transaction records to the detail grid(nsf);
            With ds.Tables(3)
                For index = 0 To .Rows.Count - 1
                    amount = CDec(.Rows(index).Item(0))
                    docnumber = DirectCast(.Rows(index).Item(1), String)
                    classcode = DirectCast(.Rows(index).Item(2), String)
                    descr = DirectCast(.Rows(index).Item(3), String)
                    issued = CDate(.Rows(index).Item(4))
                    key = CInt(.Rows(index).Item(5))
                    doctype = DirectCast(.Rows(index).Item(6), String)
                    'ebanknumber = DirectCast(.Rows(index).Item(7), String)

                    With Me.GridDetail
                        .Rows.Add()
                        currow = .Rows.Count - 1
                        .SetData(currow, 0, amount)
                        .SetData(currow, 1, docnumber)
                        .SetData(currow, 2, classcode)
                        .SetData(currow, 3, descr)
                        .SetData(currow, 4, issued)
                        .SetData(currow, 5, key)
                        .SetData(currow, 6, doctype)
                        '.SetData(currow, 7, ebanknumber)
                    End With
                Next
            End With

            'If .Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")

            ''sort by class code;
            '.Sort(SortFlags.Ascending, 2)
            '.Select(0, 2)
            'Application.DoEvents()
        End With

        With Me.GridDetail
            'add the transaction records to the detail grid(rev adj);
            With ds.Tables(4)
                For index = 0 To .Rows.Count - 1
                    amount = CDec(.Rows(index).Item(0))
                    docnumber = DirectCast(.Rows(index).Item(1), String)
                    classcode = DirectCast(.Rows(index).Item(2), String)
                    descr = DirectCast(.Rows(index).Item(3), String)
                    issued = CDate(.Rows(index).Item(4))
                    key = CInt(.Rows(index).Item(5))
                    doctype = DirectCast(.Rows(index).Item(6), String)
                    'ebanknumber = DirectCast(.Rows(index).Item(7), String)

                    With Me.GridDetail
                        .Rows.Add()
                        currow = .Rows.Count - 1
                        .SetData(currow, 0, amount)
                        .SetData(currow, 1, docnumber)
                        .SetData(currow, 2, classcode)
                        .SetData(currow, 3, descr)
                        .SetData(currow, 4, issued)
                        .SetData(currow, 5, key)
                        .SetData(currow, 6, doctype)
                        '.SetData(currow, 7, ebanknumber)
                    End With
                Next
            End With

            If .Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")

            'sort by class code;
            .Sort(SortFlags.Ascending, 2)
            .Select(0, 2)
            Application.DoEvents()
        End With


        ''''Me.Prev1.Visible = False
        ''''Me.GridDetail.Visible = True
        ''''Me.GridTotals.Visible = True
        ''''Me.ShowDialog()
        ''''Exit Sub

        Try
            'this report does not use the bold code file groupbox so hide it;
            Me.PanelBoldFail.Visible = False
            Me.PanelBoldSuccess.Visible = False
            Me.Prev1.Location = New Point(0, 0)
            Me.Prev1.Size = Me.ClientSize
            'define report criteria
            'Me.CellMiddleMiddle = ecurrentmonth & ", FY-" & Me.FiscalYear.ToString
            If eusefilter Then
                Me.CellMiddleMiddle = eclassfilter
            End If
            Me.CellRightMiddle = "Revenue Classification"
            If ereporttype = 1 Then Me.CellMiddleBottom = "MTD Classifications"
            If ereporttype = 2 Then Me.CellMiddleBottom = "YTD Classifications"
            Application.DoEvents()
            'render the table
            If eusefilter Then
                PrintClassificationRevenueSpecific()
            Else
                PrintClassificationRevenueListing()
            End If

            Application.DoEvents()
            Me.ShowDialog()
        Catch ex As Exception
            Throw
        End Try

    End Sub

    Friend Sub GenerateClassificationExpenditureDetailListing(ByVal ebankaccountnumber As String, ByVal efiscalyear As Int32, ByVal estartdate As Date, ByVal eenddate As Date, ByVal ereporttype As Int32, ByVal eusefilter As Boolean, ByVal eclassfilter As String)
        Dim SSQL, filter As String
        Dim result As Boolean

        If eusefilter Then
            filter = " AND ocex_code LIKE " & ConvertFilter(eclassfilter)
        End If

        result = CollectRevenueExpendTotals(ebankaccountnumber, efiscalyear)
        If Not result Then
            Throw New ArgumentException("An error has occured while collecting summary totals")
        End If

        'collection of detail check items(0);
        SSQL = "SELECT ci.bank_acct_num, ci.chks_fisyr, ci.chks_num, cd.ckdt_amount," _
        & " ocex_code, ci.chks_payee_name, cd.ckdt_descr, ci.chks_datetime" _
        & " FROM chks_info AS ci, chks_detl AS cd" _
        & " WHERE ci.bank_acct_num = cd.bank_acct_num" _
        & " AND ci.chks_autoinc_key = cd.chks_autoinc_key" _
        & " AND (ci.chks_status <> 'V')" _
        & " AND ci.chks_fisyr = @p2" _
        & " AND chks_applied_date BETWEEN @p3 AND @p4" _
        & filter _
        & " ORDER BY ci.bank_acct_num, ci.chks_fisyr, cd.ocex_code;"

        'collection of detail expenditure adjustments transaction items (1);
        SSQL &= "SELECT bank_acct_num, tran_fisyr, CAST(tran_autoinc_key AS VARCHAR), tran_amt," _
        & " ocex_code, tran_descr, tran_remarks, tran_datetime, tran_autoinc_key, 'A'" _
        & " FROM transactions AS d" _
        & " WHERE ((tran_type = 'E'))" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2" _
        & " AND (tran_descr NOT LIKE 'VOID CHECK%')" _
        & " AND tran_applied_date BETWEEN @p3 AND @p4" _
        & filter _
        & " ORDER BY tran_datetime; "

        'collection of bank charges transaction items(2);
        SSQL &= "SELECT bank_acct_num, tran_fisyr,  CAST(tran_autoinc_key AS VARCHAR), tran_amt, " _
        & " ocex_code, tran_descr, tran_remarks, tran_datetime, tran_autoinc_key, 'B'" _
        & " FROM transactions AS d" _
        & " WHERE ((tran_type = 'B'))" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2" _
        & " AND tran_applied_date BETWEEN @p3 AND @p4" _
        & filter _
        & " ORDER BY tran_datetime; "

        'collection of legacy checks (3);
        SSQL &= "SELECT bank_acct_num, tran_fisyr,  CAST(tran_autoinc_key AS VARCHAR), tran_amt," _
        & " ocex_code, tran_descr, tran_remarks, tran_datetime, tran_autoinc_key, 'K'" _
        & " FROM transactions AS d" _
        & " WHERE ((tran_type = 'K'))" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2" _
        & " AND tran_applied_date BETWEEN @p3 AND @p4" _
        & filter _
        & " ORDER BY tran_datetime "

        cn = New SqlConnection(Me.ConnectionString)
        Dim cmd As New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", ebankaccountnumber)
        cmd.Parameters.Add("@p2", efiscalyear)
        cmd.Parameters.Add("@p3", estartdate)
        cmd.Parameters.Add("@p4", eenddate)
        Dim da As New SqlDataAdapter(cmd)
        Dim ds As New DataSet("Expenditure Listing")
        Try
            da.Fill(ds)
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Dim currow, index, curtbl, rowindex As Int32
        Dim tbanknumber, remarks As String
        Dim classcode, docnumber, doctype, descr, expendcode, ttype As String
        Dim tfisyr, tcount, reccount As Int32
        Dim tdate As Date
        Dim amount As Decimal

        'collection of detail check items(0)
        With Me.GridDetail
            currow = 0      'use table 0
            curtbl = 0
            .Cols.Count = 16
            .Rows.Count = 0
            reccount = ds.Tables(curtbl).Rows.Count
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                'this is the trankey
                tcount = CInt(ds.Tables(curtbl).Rows(index).Item(2))
                'docnumber = DirectCast(.Rows(index).Item(2), String)
                amount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                expendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(4), String).Trim
                descr = DirectCast(ds.Tables(curtbl).Rows(index).Item(5), String).Trim
                remarks = DirectCast(ds.Tables(curtbl).Rows(index).Item(6), String).Trim
                tdate = CDate(ds.Tables(curtbl).Rows(index).Item(7))

                'ttype = DirectCast(ds.Tables(curtbl).Rows(index).Item(8), String).Trim
                'format the autoinc key to a string
                docnumber = tcount.ToString.Format("{0:D8}", tcount)
                .Rows.Add()     'add a row to the grid
                .SetData(currow, 0, tbanknumber)
                .SetData(currow, 1, tfisyr)
                .SetData(currow, 2, docnumber)
                .SetData(currow, 3, amount)
                .SetData(currow, 4, expendcode)
                .SetData(currow, 5, descr)
                .SetData(currow, 6, remarks)
                .SetData(currow, 7, tdate)
                .SetData(currow, 8, "E")    'designates this as a expenditure

                currow += 1
                EventRecordProcessed((index), reccount)
            Next
            'sort the grid by the coding
            '.Sort(SortFlags.UseColSort, 2, 4)
            '.Sort(SortFlags.Ascending, 4, 2)
            '.Select(4, 2)
            Application.DoEvents()
        End With

        'collection of detail expenditure adjustments transaction items (1);
        With Me.GridDetail
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            '     0           1         2        3        4        5   
            '   bank       fisyr    docnumber   amt    count   revenuecode
            '     6           7         8        9      
            '   descr     remarks   created    ttype 
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            curtbl = 1  'use table 1
            reccount = ds.Tables(curtbl).Rows.Count
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                'tbanknumber = CType(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                'this is the trankey
                'tcount = CInt(ds.Tables(curtbl).Rows(index).Item(2))
                docnumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String)
                amount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                amount *= -1
                expendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(4), String).Trim
                descr = DirectCast(ds.Tables(curtbl).Rows(index).Item(5), String).Trim
                remarks = DirectCast(ds.Tables(curtbl).Rows(index).Item(6), String).Trim
                tdate = CDate(ds.Tables(curtbl).Rows(index).Item(7))
                .Rows.Add()
                .SetData(currow, 0, tbanknumber)
                .SetData(currow, 1, tfisyr)
                .SetData(currow, 2, docnumber)
                .SetData(currow, 3, amount)
                .SetData(currow, 4, expendcode)
                .SetData(currow, 5, descr)
                .SetData(currow, 6, remarks)
                .SetData(currow, 7, tdate)
                .SetData(currow, 8, "A")    'designates this as a expenditure adjustment
                '.SetData(currow, 8, ttype)
                currow += 1
                EventRecordProcessed((index), reccount)
            Next

            'sort the grid by the coding
            '.Sort(SortFlags.UseColSort, 2, 4)
            '.Sort(SortFlags.Ascending, 4, 2)
            '.Select(4, 2)
            Application.DoEvents()
        End With

        'collection of bank charges transaction items(2);
        With Me.GridDetail
            curtbl = 2  'use table 2
            reccount = ds.Tables(curtbl).Rows.Count
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                'tbanknumber = CType(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                'this is the trankey
                'tcount = CInt(ds.Tables(curtbl).Rows(index).Item(2))
                docnumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String)
                amount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                expendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(4), String).Trim
                descr = DirectCast(ds.Tables(curtbl).Rows(index).Item(5), String).Trim
                remarks = DirectCast(ds.Tables(curtbl).Rows(index).Item(6), String).Trim
                tdate = CDate(ds.Tables(curtbl).Rows(index).Item(7))
                'ttype = DirectCast(ds.Tables(curtbl).Rows(index).Item(8), String).Trim
                'format the autoinc key to a string
                docnumber = tcount.ToString.Format("{0:D8}", tcount)
                .Rows.Add()
                .SetData(currow, 0, tbanknumber)
                .SetData(currow, 1, tfisyr)
                .SetData(currow, 2, docnumber)
                .SetData(currow, 3, amount)
                .SetData(currow, 4, expendcode)
                .SetData(currow, 5, descr)
                .SetData(currow, 6, remarks)
                .SetData(currow, 7, tdate)
                .SetData(currow, 8, "B")    'designates this as a bank charge
                '.SetData(currow, 8, ttype)  'designates this as a bank charge
                currow += 1
                EventRecordProcessed((index), reccount)
            Next

            'sort the grid by the coding
            '.Sort(SortFlags.UseColSort, 2, 4)
            '.Sort(SortFlags.Ascending, 4, 2)
            '.Select(4, 2)
            Application.DoEvents()
        End With

        ''collection of legacy checks (3);
        With Me.GridDetail
            curtbl = 3  'use table 3
            reccount = ds.Tables(curtbl).Rows.Count
            For index = 0 To ds.Tables(curtbl).Rows.Count - 1
                'extract fields from the table
                tbanknumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(0), String)
                'tbanknumber = CType(ds.Tables(curtbl).Rows(index).Item(0), String)
                tfisyr = CInt(ds.Tables(curtbl).Rows(index).Item(1))
                'this is the trankey
                'tcount = CInt(ds.Tables(curtbl).Rows(index).Item(2))
                'docnumber was changed 06-09-2010 pec 
                'docnumber = DirectCast(.Rows(index).Item(2), String)
                docnumber = DirectCast(ds.Tables(curtbl).Rows(index).Item(2), String)
                amount = CDec(ds.Tables(curtbl).Rows(index).Item(3))
                expendcode = DirectCast(ds.Tables(curtbl).Rows(index).Item(4), String).Trim
                descr = DirectCast(ds.Tables(curtbl).Rows(index).Item(5), String).Trim
                remarks = DirectCast(ds.Tables(curtbl).Rows(index).Item(6), String).Trim
                tdate = CDate(ds.Tables(curtbl).Rows(index).Item(7))
                'ttype = DirectCast(ds.Tables(curtbl).Rows(index).Item(8), String).Trim
                'format the autoinc key to a string
                docnumber = tcount.ToString.Format("{0:D8}", tcount)
                .Rows.Add()
                .SetData(currow, 0, tbanknumber)
                .SetData(currow, 1, tfisyr)
                .SetData(currow, 2, docnumber)
                .SetData(currow, 3, amount)
                .SetData(currow, 4, expendcode)
                .SetData(currow, 5, descr)
                .SetData(currow, 6, remarks)
                .SetData(currow, 7, tdate)
                .SetData(currow, 8, "K")    'designates this as a legacy check
                '.SetData(currow, 8, ttype)
                currow += 1
                EventRecordProcessed((index), reccount)
            Next

            'sort the grid by the coding
            .Sort(SortFlags.Ascending, 4)
            '.Sort(SortFlags.Ascending, 4, 2)
            '.Select(4, 7)
            Application.DoEvents()
        End With


        If Me.GridDetail.Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")


        ''''Me.Prev1.Visible = False

        ''''Me.GridDetail.Cols(4).Width = 175
        ''''Me.GridDetail.Visible = True
        ''''Me.GridTotals.Visible = True
        ''''Me.ShowDialog()
        ''''Exit Sub

        Try
            'this report does not use the bold code file groupbox so hide it;
            Me.PanelBoldFail.Visible = False
            Me.PanelBoldSuccess.Visible = False
            Me.Prev1.Location = New Point(0, 0)
            Me.Prev1.Size = Me.ClientSize
            'define report criteria
            'Me.CellMiddleMiddle = "FY-" & Me.FiscalYeareclassfilter
            If eusefilter Then
                Me.CellMiddleMiddle = eclassfilter
            End If
            Me.CellRightMiddle = "Expenditure Classification"
            If ereporttype = 1 Then Me.CellMiddleBottom = "MTD Classifications"
            If ereporttype = 2 Then Me.CellMiddleBottom = "YTD Classifications"
            Application.DoEvents()
            'render the table
            If eusefilter Then
                PrintClassificationExpendSpecific()
            Else
                PrintClassificationExpendListing()
            End If

            'PrintDetailRevenueListing()
            Application.DoEvents()
            Me.ShowDialog()
        Catch ex As Exception
            Throw
        End Try

    End Sub

    Public Sub GenerateExpenditureCodes(ByVal efiscalyear As Int32, ByVal evalid As Boolean)
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        'This report produces a listing of all expenditure codes for a
        'given fiscal year; invalid codes are not included by default;
        'Fred: 2013.02.26;
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim SSQL, filter As String
        Dim da As SqlDataAdapter
        Dim tbl As DataTable
        Dim cmd As SqlCommand
        Dim result As Boolean

        'set filter for valid codes only;
        filter = ""
        If evalid = True Then filter = " AND ocex_status = 'O'"

        Try
            SSQL = "SELECT ocex_code_format, ocex_dim1, ocex_dim2, ocex_dim3, ocex_dim4," _
             & " ocex_dim5, ocex_dim6, ocex_dim7, ocex_dim8, ocex_dim9, ocex_status, ocex_descr" _
             & " FROM ocas_exp WHERE ocex_fisyr = @p1" _
             & filter _
             & " ORDER BY ocex_code"
            cn = New SqlConnection(Me.ConnectionString)
            cmd = New SqlCommand(SSQL, cn)
            cmd.Parameters.Add("@p1", efiscalyear)
            da = New SqlDataAdapter(cmd)
            tbl = New DataTable("ExpenditureCodes")
            da.Fill(tbl)
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        'bind the table to the grid;
        Me.GridDetail.DataSource = tbl
        Application.DoEvents()
        If Me.GridDetail.Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")

        ''''Me.Prev1.Visible = False
        ''''Me.GridDetail.Cols(4).Width = 175
        ''''Me.GridDetail.Visible = True
        ''''Me.GridTotals.Visible = True
        ''''Me.ShowDialog()
        ''''Exit Sub

        Try
            'this report does not use the bold code file groupbox so hide it;
            Me.PanelBoldFail.Visible = False
            Me.PanelBoldSuccess.Visible = False
            Me.Prev1.Location = New Point(0, 0)
            Me.Prev1.Size = Me.ClientSize
            '
            Me.CellRightMiddle = "FY " & efiscalyear & " Expenditure Codes"
            Application.DoEvents()
            'render the table;
            Call PrintExpenditureCodes()
            Application.DoEvents()
            Me.ShowDialog()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Public Sub GenerateRevenueCodes(ByVal efiscalyear As Int32, ByVal evalid As Boolean)
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        'This report produces a listing of all revenue codes for a
        'given fiscal year; invalid codes are not included by default;
        'Fred: 2013.02.26;
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim SSQL, filter As String
        Dim da As SqlDataAdapter
        Dim tbl As DataTable
        Dim cmd As SqlCommand
        Dim result As Boolean

        'set filter for valid codes only;
        filter = ""
        If evalid = True Then filter = " AND ocrv_status = 'O'"

        Try

            SSQL = "SELECT ocrv_code_format, ocrv_dim1, ocrv_dim2, ocrv_dim3, ocrv_dim4," _
            & " ocrv_dim5, ocrv_dim6, ocrv_status, ocrv_descr" _
            & " FROM ocas_rev WHERE ocrv_fisyr = @p1" _
            & filter _
            & " ORDER BY ocrv_code"
            cn = New SqlConnection(Me.ConnectionString)
            cmd = New SqlCommand(SSQL, cn)
            cmd.Parameters.Add("@p1", efiscalyear)
            da = New SqlDataAdapter(cmd)
            tbl = New DataTable("RevenueCodes")
            da.Fill(tbl)
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        'bind the table to the grid;
        Me.GridDetail.DataSource = tbl
        Application.DoEvents()
        If Me.GridDetail.Rows.Count < 1 Then Throw New ArgumentException("No records found for the selected criteria...")

        ''''Me.Prev1.Visible = False
        ''''Me.GridDetail.Cols(4).Width = 175
        ''''Me.GridDetail.Visible = True
        ''''Me.GridTotals.Visible = True
        ''''Me.ShowDialog()
        ''''Exit Sub

        Try
            'this report does not use the bold code file groupbox so hide it;
            Me.PanelBoldFail.Visible = False
            Me.PanelBoldSuccess.Visible = False
            Me.Prev1.Location = New Point(0, 0)
            Me.Prev1.Size = Me.ClientSize
            '
            Me.CellRightMiddle = "FY " & efiscalyear & " Revenue Codes"
            Application.DoEvents()
            'render the table;
            Call PrintRevenueCodes()
            Application.DoEvents()
            Me.ShowDialog()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintExpenditureCodes()
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0       1       2        3       4       5        6
        '  fmtcode  dim1    dim2     dim3    dim4    dim5     dim6
        '     7       8       9       10      11  
        '   dim7    dim8    dim9    status  descr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        'identify the document for header building;
        Me.DocumentName = "Classification"
        Me.ReportName = "Activity Fund Expenditure Coding"
        'define styles;
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        specstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles;
        Call DefineStyles()
        'define the document;
        Call DefineDocumentSettings(Me.DocumentName)

        'change this font for this report only;
        With Me.specstyle
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 8, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Center
            .TextColor = Color.Black
        End With

        Dim index, recordcount, y As Int32
        Dim tdescription, tdim1, tdim2, tdim3, tdim4, tdim5, tdim6, tdim7, tdim8, tdim9, tstatus As String

        Try
            With Me.Doc1
                .StartDoc()
                recordcount = Me.GridDetail.Rows.Count
                For index = 0 To Me.GridDetail.Rows.Count - 1
                    If index = 0 Then
                        'print the column headers;
                        y = 35
                        .RenderDirectText(0, y, "Classification", 50, 5, verdanaleft8bold)
                        .RenderDirectText(90, y, "Description", 50, 5, verdanaleft8bold)
                        'print line below the column headers;
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If

                    With Me.GridDetail
                        tdim1 = CType(.GetData(index, 1), String)
                        tdim2 = CType(.GetData(index, 2), String)
                        tdim3 = CType(.GetData(index, 3), String)
                        tdim4 = CType(.GetData(index, 4), String)
                        tdim5 = CType(.GetData(index, 5), String)
                        tdim6 = CType(.GetData(index, 6), String)
                        tdim7 = CType(.GetData(index, 7), String)
                        tdim8 = CType(.GetData(index, 8), String)
                        tdim9 = CType(.GetData(index, 9), String)
                        tstatus = CType(.GetData(index, 10), String)
                        'handle system default code;
                        If (tdim3 = "000" And tdim4 = "0000" And tdim5 = "000" And tdim6 = "000" And tdim7 = "0000" And tdim8 = "000" And tdim9 = "000") Then
                            tdescription = "[SYSTEM DEFAULT - DO NOT USE]"
                        Else
                            tdescription = CType(.GetData(index, 11), String)
                            If tstatus <> "O" Then tdescription = "*INVALID* " & tdescription
                        End If
                    End With

                    .RenderDirectText(0, y, tdim1, 10, 5, verdanaleft8)
                    .RenderDirectText(4, y, tdim2, 10, 5, verdanaleft8)
                    .RenderDirectText(10, y, tdim3, 10, 5, specstyle)
                    .RenderDirectText(20, y, tdim4, 10, 5, specstyle)
                    .RenderDirectText(30, y, tdim5, 10, 5, specstyle)
                    .RenderDirectText(40, y, tdim6, 10, 5, specstyle)
                    .RenderDirectText(50, y, tdim7, 10, 5, specstyle)
                    .RenderDirectText(60, y, tdim8, 10, 5, specstyle)
                    .RenderDirectText(70, y, tdim9, 10, 5, specstyle)
                    .RenderDirectText(90, y, tdescription, 100, 5, verdanaleft8)

                    'draw line thru code if invalid;
                    If tstatus <> "O" Then
                        .RenderDirectLine(0, y + 2.5, 80, y + 2.5, Color.Black, 0.5)
                    End If

                    'iterate the y coordinate;
                    y += 7

                    'check for page break;
                    If y >= 250 Then
                        If index >= (Me.GridDetail.Rows.Count - 1) Then Exit For
                        .NewPage()
                        'print the column headers;
                        y = 35
                        .RenderDirectText(0, y, "Classification", 50, 5, verdanaleft8bold)
                        .RenderDirectText(90, y, "Description", 50, 5, verdanaleft8bold)
                        'print line below the column headers;
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If
                Next
                y += 7
            End With
        Catch ex As Exception
            Throw
        End Try

        Try
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintRevenueCodes()
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0       1       2        3       4       5        6
        '  fmtcode  dim1    dim2     dim3    dim4    dim5     dim6
        '     7       8
        '  status  descr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        'identify the document for header building;
        Me.DocumentName = "Classification"
        Me.ReportName = "Activity Fund Revenue Coding"
        'define styles;
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        specstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles;
        Call DefineStyles()
        'define the document;
        Call DefineDocumentSettings(Me.DocumentName)

        'change this font for this report only;
        With Me.specstyle
            .Borders.AllEmpty = True
            .BorderTableHorz.Empty = True
            .BorderTableVert.Empty = True
            .Font = New Font("Verdana", 8, FontStyle.Regular)
            .Spacing.LeftStr = "1mm"
            .Spacing.RightStr = "1mm"
            .Spacing.TopStr = ".5mm"
            .TextAlignHorz = AlignHorzEnum.Center
            .TextColor = Color.Black
        End With

        Dim index, recordcount, y As Int32
        Dim tdescription, tdim1, tdim2, tdim3, tdim4, tdim5, tdim6, tstatus As String

        Try
            With Me.Doc1
                .StartDoc()
                recordcount = Me.GridDetail.Rows.Count
                For index = 0 To Me.GridDetail.Rows.Count - 1
                    If index = 0 Then
                        'print the column headers;
                        y = 35
                        .RenderDirectText(0, y, "Classification", 50, 5, verdanaleft8bold)
                        .RenderDirectText(90, y, "Description", 50, 5, verdanaleft8bold)
                        'print line below the column headers;
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If

                    With Me.GridDetail
                        tdim1 = CType(.GetData(index, 1), String)
                        tdim2 = CType(.GetData(index, 2), String)
                        tdim3 = CType(.GetData(index, 3), String)
                        tdim4 = CType(.GetData(index, 4), String)
                        tdim5 = CType(.GetData(index, 5), String)
                        tdim6 = CType(.GetData(index, 6), String)
                        tstatus = CType(.GetData(index, 7), String)
                        'handle system default code;
                        If (tdim3 = "000" And tdim4 = "0000" And tdim5 = "000" And tdim6 = "000") Then
                            tdescription = "[SYSTEM DEFAULT - DO NOT USE]"
                        Else
                            tdescription = CType(.GetData(index, 8), String)
                            If tstatus <> "O" Then tdescription = "*INVALID* " & tdescription
                        End If
                    End With

                    .RenderDirectText(0, y, tdim1, 10, 5, verdanaleft8)
                    .RenderDirectText(4, y, tdim2, 10, 5, verdanaleft8)
                    .RenderDirectText(10, y, tdim3, 10, 5, specstyle)
                    .RenderDirectText(20, y, tdim4, 10, 5, specstyle)
                    .RenderDirectText(30, y, tdim5, 10, 5, specstyle)
                    .RenderDirectText(40, y, tdim6, 10, 5, specstyle)
                    .RenderDirectText(90, y, tdescription, 100, 5, verdanaleft8)

                    'draw line thru code if invalid;
                    If tstatus <> "O" Then
                        .RenderDirectLine(0, y + 2.5, 80, y + 2.5, Color.Black, 0.5)
                    End If

                    'iterate the y coordinate;
                    y += 7

                    'check for page break;
                    If y >= 250 Then
                        If index >= (Me.GridDetail.Rows.Count - 1) Then Exit For
                        .NewPage()
                        'print the column headers;
                        y = 35
                        .RenderDirectText(0, y, "Classification", 50, 5, verdanaleft8bold)
                        .RenderDirectText(90, y, "Description", 50, 5, verdanaleft8bold)
                        'print line below the column headers;
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If
                Next
                y += 7
            End With
        Catch ex As Exception
            Throw
        End Try

        Try
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Function ConvertFilter(ByVal efilterstring As String) As String
        Dim index As Int32
        Dim c, newstring As String
        Dim r As Char
        If efilterstring.Length = 16 Then
            For index = 0 To efilterstring.Length - 1
                r = efilterstring.Chars(index)
                If Char.IsNumber(r) Then
                    newstring &= r.ToString
                Else
                    newstring &= "_"
                End If
            Next
        End If
        If efilterstring.Length = 26 Then
            For index = 0 To efilterstring.Length - 1
                r = efilterstring.Chars(index)
                If Char.IsNumber(r) Then
                    newstring &= r.ToString
                Else
                    newstring &= "_"
                End If
            Next
        End If
        Return "'" & newstring & "'"
    End Function

    Private Function CollectRevenueExpendTotals(ByVal ebankaccountnumber As String, ByVal efiscalyear As Int32) As Boolean

        Dim SSQL, filter As String

        'collect interest(0);
        SSQL = "SELECT ISNULL(SUM(tran_amt), 0) AS interest" _
        & " FROM transactions" _
        & " WHERE tran_type = 'I'" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2; "

        'collect bank charges(1);
        SSQL &= "SELECT ISNULL(SUM(tran_amt), 0) AS bankcharges" _
        & " FROM transactions" _
        & " WHERE tran_type = 'B'" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2; "

        'collect revadjust(2);
        SSQL &= "SELECT ISNULL(SUM(tran_amt), 0) AS revadjust" _
        & " FROM transactions" _
        & " WHERE tran_type = 'R'" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2; "

        'collect nsf(3);
        SSQL &= "SELECT ISNULL(SUM(tran_amt), 0) AS nsf" _
        & " FROM transactions" _
        & " WHERE tran_type = 'N'" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2; "

        'collect expadjust(4);
        SSQL &= "SELECT ISNULL(SUM(tran_amt), 0) AS expadjust" _
        & " FROM transactions" _
        & " WHERE tran_type = 'E'" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2; "

        'collect j records (legacy receipts)(5);
        SSQL &= "SELECT ISNULL(SUM(tran_amt), 0) AS legacyreceipts" _
        & " FROM transactions" _
        & " WHERE tran_type = 'J'" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2; "

        'collect k records (legacy checks)(6);
        SSQL &= "SELECT ISNULL(SUM(tran_amt), 0) AS legacychecks" _
        & " FROM transactions" _
        & " WHERE tran_type = 'K'" _
        & " AND bank_acct_num = @p1" _
        & " AND tran_fisyr = @p2; "

        'collection of detail receipt items(7);
        SSQL &= "SELECT ISNULL(SUM(rcdt_amount), 0) FROM receipt_info AS ri, receipt_detl AS rd" _
        & " WHERE ri.bank_acct_num = rd.bank_acct_num" _
        & " AND ri.rcpt_fisyr = rd.rcpt_fisyr" _
        & " AND ri.rcpt_num = rd.rcpt_num" _
        & " AND ri.rcpt_fisyr = @p2;"
        '& " AND ri.rcpt_status <> 'V'" _

        'collection of detail check(expenditures) items(8);
        SSQL &= "SELECT ISNULL(SUM(ckdt_amount), 0) FROM chks_info AS ci, chks_detl AS cd" _
        & " WHERE ci.chks_autoinc_key = cd.chks_autoinc_key" _
        & " AND ci.chks_fisyr = @p2;"
        '& " AND (ci.chks_status <> 'V')" _

        'collection of beginning balances(9);
        SSQL &= "SELECT ISNULL(SUM(af_beg_year_balance),0) FROM acct_info"

        cn = New SqlConnection(Me.ConnectionString)
        Dim cmd As New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", ebankaccountnumber)
        cmd.Parameters.Add("@p2", efiscalyear)
        Dim da As New SqlDataAdapter(cmd)
        Dim ds As New DataSet("RevenueListing")

        Try
            da.Fill(ds)
            'load totals into the detail grid;
            'Me.GridTotals.DataSource = ds.Tables(0)
            With Me.GridTotals
                Dim bankcharge, expadjust, interest, legacychks, legacyrcpts, nsf, revadjust, revenues, expenditures, begbalance As Double
                'remove unnecessary rows;
                .Cols.Count = 10
                .Rows.Count = 1
                'get values from datatables;
                interest = CDbl(ds.Tables(0).Rows(0).Item(0))
                bankcharge = CDbl(ds.Tables(1).Rows(0).Item(0))
                revadjust = CDbl(ds.Tables(2).Rows(0).Item(0))
                nsf = CDbl(ds.Tables(3).Rows(0).Item(0))
                expadjust = CDbl(ds.Tables(4).Rows(0).Item(0))
                legacyrcpts = CDbl(ds.Tables(5).Rows(0).Item(0))
                legacychks = CDbl(ds.Tables(6).Rows(0).Item(0))
                revenues = CDbl(ds.Tables(7).Rows(0).Item(0))
                expenditures = CDbl(ds.Tables(8).Rows(0).Item(0))
                begbalance = CDbl(ds.Tables(9).Rows(0).Item(0))

                'insert values into the totalgrid;
                .SetData(0, 0, interest)
                .SetData(0, 1, bankcharge)
                .SetData(0, 2, revadjust)
                .SetData(0, 3, nsf)
                .SetData(0, 4, expadjust)
                .SetData(0, 5, legacyrcpts)
                .SetData(0, 6, legacychks)
                .SetData(0, 7, revenues)
                .SetData(0, 8, expenditures)
                .SetData(0, 9, begbalance)
            End With
        Catch ex As Exception
            MsgBox(ex.Message)
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try



        '''''Me.Prev1.Visible = False
        '''''Me.GridDetail.Visible = False
        ''''Me.GridTotals.Visible = True
        ''''Me.ShowDialog()
        ''''Exit Function

        Return True

    End Function

    Private Function CheckForNegRev() As Boolean
        'phase 3 performs the edit checks for the amount used. 
        'checks amounts for being less then zero. Negative amounts 
        'are not accepted by the state department.

        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Dim dim1, dim2, dim3, dim4, dim5, dim6, amt As String
        Dim idim1, idim2, idim3, idim4, idim5, idim6 As Int32
        Dim revenuecode, boldcode, boldcodefmt, rcode As String
        Dim amount As Decimal
        Dim errordescr, errorphase, errorval, prevcode, phaseerror As String
        Dim currow, rowindex As Int32
        Dim valid As Boolean

        errordescr = ""
        errorphase = "0"
        errorval = ""

        Try

            For currow = 0 To Me.GridDetail.Rows.Count - 1
                revenuecode = DirectCast(Me.GridDetail.GetData(currow, 5), String)
                rcode = revenuecode.Substring(6, 4)
                phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                If phaseerror <> "0" Then GoTo Skiprecord
                amount = CDec(Me.GridDetail.GetData(currow, 3))
                amount = amount.Round(amount, 2)


                ''''''''''''''''''''''''''''''''''''''
                'validate the amount
                ''''''''''''''''''''''''''''''''''''''
                'test for neagative amounts.
                valid = True

                If amount < 0 Then
                    valid = False
                    errorval = ""
                    errorphase = "3"
                    errordescr = "Error: Negatives values are not accepted."
                    GoTo Errorhandle
                End If

                ' dim4 = 5200 needs to be zero out
                If rcode = "5200" Then
                    If amount <> 0 Then
                        valid = False
                        errorval = ""
                        errorphase = "3"
                        errordescr = "Error: 5200 must be zero balance."
                        GoTo Errorhandle
                    End If
                End If

                ' dim4 = 5300 needs to be zero out
                If rcode = "5300" Then
                    If amount <> 0 Then
                        valid = False
                        errorval = ""
                        errorphase = "3"
                        errordescr = "Error: 5300 must be zero balance."
                        GoTo Errorhandle
                    End If
                End If
Errorhandle:
                If valid = False Then
                    Me.HasErrors = True
                    With Me.GridDetail
                        .SetData(currow, 11, errorphase)
                        .SetData(currow, 14, errorval)
                        .SetData(currow, 15, errordescr)
                    End With
                End If
                'clear the vars
                errorphase = "0"
                errorval = ""
                errordescr = ""
Skiprecord:
            Next
        Catch ex As Exception
            Throw
        End Try

    End Function

    Private Function GetRidOfZeroAmt() As Boolean
        Dim currow, tcount, rowindex As Int32
        Dim tamt As Decimal
        Dim errordescr, errorphase, errorval, phaseerror As String
        Dim tboldcode, tprevcode As String

        Try
            With Me.GridDetail
                currow = 0
                Do While currow <= .Rows.Count - 1
                    tboldcode = DirectCast(.GetData(currow, 13), String)
                    tamt = CDec(.GetData(currow, 3))
                    tcount = CInt(.GetData(currow, 4))
                    phaseerror = DirectCast(Me.GridDetail.GetData(currow, 11), String)
                    If tamt = 0 Then
                        'is the cur = prev
                        .RemoveItem(currow)
                        rowindex = .FindRow(tboldcode, 0, 13, True, True, False)
                        currow -= 1     'go back one row since the current row was just deleted
                        If rowindex >= 0 Then
                            .SetData(rowindex, 3, tamt + CDbl(.GetData(rowindex, 3)))
                            .SetData(rowindex, 4, tcount + CInt(.GetData(rowindex, 4)))
                        End If
                    End If
                    currow += 1
                Loop
            End With
        Catch ex As Exception
            Throw
        End Try
    End Function

#End Region

#Region "  Methods IO "

    Private Function WriteBoldCodeExpenditureFile() As Boolean
        'write the bold code information to a file
        Dim fs As FileStream
        Dim sw As StreamWriter
        Try
            'create a reference to a filestream
            fs = New FileStream(Me.BoldCodeFilePath, FileMode.Create)
            'open the filestream
            sw = New StreamWriter(fs)
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            '     0           1         2        3        4        5   
            '   bank       fisyr    docnumber   amt    count   revenuecode
            '     6           7         8        9       10
            '   descr     remarks   created    ttype -- NOT USED --
            '    11          12        13       14       15   
            '  phaseerror boldfmt  boldunfmt errorval errordescr
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

            Dim row As Int32
            Dim record, boldcode As String
            Dim isnegative As Boolean
            Dim amt As Double
            Dim tempamt, parseamt1, parseamt2, fmtamt, fmtzeroes As String
            Dim index, iamt As Int32
            fmtzeroes = "000000000000"
            For row = 0 To Me.GridDetail.Rows.Count - 1
                boldcode = DirectCast(Me.GridDetail.GetData(row, 13), String)
                'remove the beginning year
                boldcode = boldcode.Substring(1, boldcode.Length - 1)
                'get the amount
                amt = CDbl(Me.GridDetail.GetData(row, 3))
                'initialise flag
                isnegative = False
                'check for negative value
                If amt < 0 Then isnegative = True
                'get absolute value if negative
                If amt < 0 Then amt *= -1
                'remove the decimal
                tempamt = amt.ToString.Format("{0:F2}", amt)
                index = tempamt.ToString.IndexOf(".")
                parseamt1 = tempamt.Substring(0, index)
                parseamt2 = tempamt.Substring(index + 1, 2)
                tempamt = parseamt1 + parseamt2
                'convert to int 
                iamt = CInt(tempamt)
                'pad int with leading zeroes for 12 chars
                fmtamt = iamt.ToString.Format("{0:D12}", iamt)
                '1-4
                record = Me.FiscalYearSelected.ToString
                '5-6
                record += Me.CountyId
                '7-10
                record += Me.DistrictId
                '11-35  
                record += boldcode
                '36 filler
                record += Space(1)
                '37-48  appropriation (always zero)
                record += fmtzeroes
                '49 filler
                record += Space(1)
                '50-61  encumbrance ???
                record += fmtzeroes
                '62 filler or negative sign
                If isnegative Then
                    record += "-"
                Else
                    record += Space(1)
                End If
                '63-74
                record += fmtamt
                sw.WriteLine(record)
                record = ""
            Next
            '''''''''''''''''''''''''''''''''''''
            'finished
            '''''''''''''''''''''''''''''''''''''
            Return True
        Catch ex As Exception
            Throw
        Finally
            sw.Close()
            fs.Close()
        End Try
    End Function

    Private Function WriteBoldCodeRevenueFile() As Boolean
        'write the bold code information to a file
        Dim fs As FileStream
        Dim sw As StreamWriter
        Try
            'create a reference to a filestream
            fs = New FileStream(Me.BoldCodeFilePath, FileMode.Create)
            'open the filestream
            sw = New StreamWriter(fs)
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            '     0           1         2        3        4        5   
            '   bank       fisyr    docnumber   amt    count   revenuecode
            '     6           7         8        9       10
            '   descr     remarks   created    ttype -- NOT USED --
            '    11          12        13       14       15   
            '  phaseerror boldfmt  boldunfmt errorval errordescr
            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

            Dim row As Int32
            Dim record, boldcode As String
            Dim isnegative As Boolean
            Dim amt As Double
            Dim tempamt, parseamt1, parseamt2, fmtamt, fmtneeds As String
            Dim index, iamt As Int32
            fmtneeds = "000000000000"
            For row = 0 To Me.GridDetail.Rows.Count - 1
                boldcode = DirectCast(Me.GridDetail.GetData(row, 13), String)
                'remove the beginning year
                boldcode = boldcode.Substring(1, boldcode.Length - 1)
                'get the amount
                amt = CDbl(Me.GridDetail.GetData(row, 3))
                'initialise flag
                isnegative = False
                'check for negative value
                If amt < 0 Then isnegative = True
                'get absolute value if negative
                If amt < 0 Then amt *= -1
                'remove the decimal
                tempamt = amt.ToString.Format("{0:F2}", amt)
                index = tempamt.ToString.IndexOf(".")
                parseamt1 = tempamt.Substring(0, index)
                parseamt2 = tempamt.Substring(index + 1, 2)
                tempamt = parseamt1 + parseamt2
                'convert to int 
                iamt = CInt(tempamt)
                'pad int with leading zeroes for 12 chars
                fmtamt = iamt.ToString.Format("{0:D12}", iamt)
                '1-4
                record = Me.FiscalYearSelected.ToString
                '5-6
                record += Me.CountyId
                '7-10
                record += Me.DistrictId
                '11-25  
                record += boldcode
                '26 filler
                record += Space(1)
                '27-38  estimate of needs (always zero)
                record += fmtneeds
                '39 filler or negative sign
                If isnegative Then
                    record += "-"
                Else
                    record += Space(1)
                End If
                '40-51
                record += fmtamt
                sw.WriteLine(record)
                record = ""
            Next
            '''''''''''''''''''''''''''''''''''''
            'finished
            '''''''''''''''''''''''''''''''''''''
            Return True
        Catch ex As Exception
            Throw
        Finally
            sw.Close()
            fs.Close()
        End Try
    End Function

#End Region

#Region "  Methods Rendering "

    Private Sub PrintBoldCodeExpenditure()
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count      code
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Me.DocumentName = "BoldCodeExpenditure"
        Me.ReportName = "Activity Fund Bold Code Required Listing"
        If Me._editchk = True Then
            Me.ReportName = "Validate a Bold Code"
        End If
        Me.CellRightMiddle = "Expenditure Reporting"

        'define styles
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles
        DefineStyles()
        'define the document
        DefineDocumentSettings(Me.DocumentName)

        Dim x, y, index As Int32
        Dim tboldcode, terrorval, terrordescr As String
        Dim tamt, tsumamt As Decimal
        Dim tcount, tsumcount As Int32
        Dim reccount, reccurrent As Int32

        Try
            With Me.Doc1
                .StartDoc()
                reccount = Me.GridDetail.Rows.Count


                For index = 0 To Me.GridDetail.Rows.Count - 1
                    '''''''''For single Edit check'''''''''''
                    If Me._editchk = True Then
                        index = Me.GridDetail.Rows.Count - 1
                        With Me.GridDetail
                            tamt = 0
                            tsumamt += tamt
                            tcount = CInt(.GetData(index, 4))
                            tsumcount += tcount

                            tboldcode = Me._expendcode
                            ' tboldcode = Me._Revenuecode
                            terrorval = DirectCast(.GetData(index, 14), String)
                            terrordescr = DirectCast(.GetData(index, 15), String).ToUpper
                            'render
                            y = 35
                            Doc1.RenderDirectText(0, y, "Classification", 70, 5, verdanaleft8bold)
                            Doc1.RenderDirectText(60, y, "Value", 15, 5, verdanaright8bold)
                            Doc1.RenderDirectText(70, y, "Items", 20, 5, verdanaright8bold)
                            Doc1.RenderDirectText(90, y, "Expense", 25, 5, verdanaright8bold)
                            Doc1.RenderDirectText(117, y, "Warning and error messages", 73, 5, verdanaleft8bold)
                            'print line below the column headers
                            Doc1.RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                            y += 7

                            Doc1.RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                            y += 7
                            Doc1.RenderDirectText(0, y, tboldcode, 65, 5, verdanaleft8)
                            Doc1.RenderDirectText(65, y, terrorval, 10, 5, verdanaright8)
                            Doc1.RenderDirectText(70, y, tcount.ToString, 20, 5, verdanaright8)
                            Doc1.RenderDirectText(90, y, tamt.ToString.Format("{0:F2}", tamt), 25, 5, verdanaright8)
                            Doc1.RenderDirectText(117, y, terrordescr, 73, 10, verdanaleft8)
                            'print line below the column headers
                            y += 7
                            Doc1.RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)


                            Me.btnAdministrator.Enabled = True
                            Me.PanelBoldFail.Visible = True
                            Me.Label3.Text = ""
                            Me.Label4.Text = "   Testing Only  "
                            Me.PanelBoldSuccess.Visible = False
                            Me.btnCreateBoldCodeExpenditure.Enabled = False
                            Me.btnCreateBoldCodeExpenditure.Text = "File Disabled"
                            Me.btnCreateBoldCodeExpenditure.Visible = True
                            Me.btnCreateBoldCodeRevenue.Visible = False
                        End With
                        Try
                            'set the preview zoom
                            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
                            'finish the document
                            Me.Doc1.EndDoc()
                        Catch ex As Exception
                            Throw
                        End Try
                        Exit Sub
                    End If
                    '''''''''For single Edit check'''''''''''


                    If index = 0 Then
                        'print the column headers
                        y = 35
                        .RenderDirectText(0, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(60, y, "Value", 15, 5, verdanaright8bold)
                        .RenderDirectText(70, y, "Items", 20, 5, verdanaright8bold)
                        .RenderDirectText(90, y, "Expense", 25, 5, verdanaright8bold)
                        .RenderDirectText(117, y, "Warning and error messages", 73, 5, verdanaleft8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 42
                    End If

                    With Me.GridDetail
                        tamt = CDec(.GetData(index, 3))
                        tsumamt += tamt
                        tcount = CInt(.GetData(index, 4))
                        tsumcount += tcount
                        tboldcode = DirectCast(.GetData(index, 12), String)
                        terrorval = DirectCast(.GetData(index, 14), String)
                        terrordescr = DirectCast(.GetData(index, 15), String).ToUpper
                    End With

                    .RenderDirectText(0, y, tboldcode, 65, 5, verdanaleft8)
                    .RenderDirectText(65, y, terrorval, 10, 5, verdanaright8)
                    .RenderDirectText(70, y, tcount.ToString, 20, 5, verdanaright8)
                    .RenderDirectText(90, y, tamt.ToString.Format("{0:F2}", tamt), 25, 5, verdanaright8)
                    .RenderDirectText(117, y, terrordescr, 73, 10, verdanaleft8)
                    y += 7
                    'expose the current record & count to the caller
                    'EventRecordProcessed((reccurrent), reccount)

                    'check for page break
                    If y >= 250 Then
                        If index >= (Me.GridDetail.Rows.Count - 1) Then Exit For
                        .NewPage()
                        'print the column headers
                        y = 35
                        .RenderDirectText(0, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(60, y, "Value", 15, 5, verdanaright8bold)
                        .RenderDirectText(70, y, "Items", 20, 5, verdanaright8bold)
                        .RenderDirectText(90, y, "Expense", 25, 5, verdanaright8bold)
                        .RenderDirectText(117, y, "Warning and error messages", 73, 5, verdanaleft8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 42
                    End If
                Next
                y += 7
                'print the totals
                If y >= 190 Then
                    .NewPage()
                    y = 50
                End If
                .RenderDirectText(0, y, "EXPENDITURES REPORTED TO THE STATE:", 60, 10, verdanaright8bold)
                .RenderDirectText(70, y, tsumcount.ToString, 20, 5, verdanaright8bold)
                .RenderDirectText(90, y, tsumamt.ToString.Format("{0:F2}", tsumamt), 25, 5, verdanaright8bold)
            End With
        Catch ex As Exception
            Throw
        End Try

        Try
            'print the summary values
            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            '      0        1       2       3        4       5       6       7
            '   acctbal  rcptsum  chksum  adjbank  adjexp  adjint  adjnsf  adjrev
            '      8        9
            '  legrcpts legchecks
            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            Dim calcval As Decimal
            Dim val0, val1, val2, val3, val4, val5, val6, val7, val8, val9 As Decimal
            With Me.GridTotals
                val0 = CDec(.GetData(0, 0))
                val1 = CDec(.GetData(0, 1))
                val2 = CDec(.GetData(0, 2))
                val3 = CDec(.GetData(0, 3))
                val4 = CDec(.GetData(0, 4))
                val5 = CDec(.GetData(0, 5))
                val6 = CDec(.GetData(0, 6))
                val7 = CDec(.GetData(0, 7))
                val8 = CDec(.GetData(0, 8))
                val9 = CDec(.GetData(0, 9))
            End With
            'Pat/Fred fix 2005.06.14
            'this is a school-specific fix for boldcode due to the way that the 
            'DOS adjustments are picked up;  we have to multiply the expenditure
            'adjustments by -1 since they appear as negatives in the system;
            Select Case Me.SchoolNumber
                '''''Case "497", "314", "080"
                '''''    val4 *= -1
                '''''    sumval = val0 + val1 - val2 - val3 - val4 + val5 + val6 + val7
                '''''    sumexpend = val2 + val3 + val4
                '''''Case "874"
                '''''    sumval = val0 + val1 - val2 - val3 - val4 + val5 + val6 + val7
                '''''    sumexpend = val2 + val3 + val4
            Case Else

            End Select

            With Me.Doc1
                x = 90
                y += 12
                calcval = val2 + val9
                .RenderDirectText(0, y, "Activity Fund Year-To-Date Checks:", 75, 5, verdanaright8)
                .RenderDirectText(x, y, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 4, "Add: Bank Charges", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 4, val3.ToString.Format("{0:F2}", val3), 25, 5, verdanaright8)
                calcval = val2 + val3 + val9
                .RenderDirectText(0, y + 10, "Total Checks And Bank Charges:", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 10, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 14, "Add: Net Check Adjustments", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 14, val4.ToString.Format("{0:F2}", val4), 25, 5, verdanaright8)
                calcval = val2 + val3 + val9 - val4
                .RenderDirectText(0, y + 20, "Expenditures For Fiscal Year " & Me.FiscalYear.ToString & ":", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 20, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 24, "Less: Checks Voided From Previous Year", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 24, 0.ToString.Format("{0:F2}", 0), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 30, "TOTAL ACTIVITY FUND EXPENDITURES:", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 30, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                y += 36
                .RenderDirectText(0, y, "Add: Activity Fund Beginning Balance", 75, 5, verdanaright8)
                .RenderDirectText(x, y, val0.ToString.Format("{0:F2}", val0), 25, 5, verdanaright8)

                '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                '      0        1       2       3        4       5       6       7
                '   acctbal  rcptsum  chksum  adjbank  adjexp  adjint  adjnsf  adjrev
                '      8        9
                '  legrcpts legchecks
                '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                calcval = val1 + val8
                .RenderDirectText(0, y + 4, "Add: Total Receipts", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 4, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 8, "Add: Interest", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 8, val5.ToString.Format("{0:F2}", val5), 25, 5, verdanaright8)
                calcval = val6 + val7
                .RenderDirectText(0, y + 12, "Add: Revenue Adjustments", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 12, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                y += 18
                calcval = (val0 + val1 + val5 + val6 + val7 + val8) + val4 - (val2 + val3 + val9)
                .RenderDirectText(0, y, "ACTIVITY FUND BANK BALANCE:", 75, 5, verdanaright8)
                .RenderDirectText(x, y, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
            End With
        Catch ex As Exception
            Throw
        End Try

        Try
            'allow user to create a bold code file if error-free;
            If Me.HasErrors Then
                Me.btnAdministrator.Enabled = True
                Me.PanelBoldFail.Visible = True
                Me.PanelBoldSuccess.Visible = False
                Me.btnCreateBoldCodeExpenditure.Enabled = False
                Me.btnCreateBoldCodeExpenditure.Text = "File disabled"
                Me.btnCreateBoldCodeExpenditure.Visible = True
                Me.btnCreateBoldCodeRevenue.Visible = False
            Else
                Me.btnAdministrator.Enabled = False
                Me.btnCreateBoldCodeExpenditure.Enabled = True
                Me.btnCreateBoldCodeExpenditure.Text = "Create bold code file"
                Me.btnCreateBoldCodeExpenditure.Visible = True
                Me.btnCreateBoldCodeRevenue.Visible = False
            End If
        Catch ex As Exception
            Throw
        End Try

        Try
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
            _editchk = False
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintBoldCodeExpenditureErrorsOnly()
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Me.DocumentName = "BoldCodeExpenditure"
        Me.ReportName = "Activity Fund Bold Code Detail"
        Me.CellRightMiddle = "Expenditure Reporting"
        Me.CellMiddleBottom = "Detail Errors Only"

        'define styles
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles
        DefineStyles()
        'define the document
        DefineDocumentSettings(Me.DocumentName)

        Dim tboldcode, terrorval, terrordescr, tphaseerror As String
        Dim tdocnumber, tdoctype, tdescr, tremarks As String
        Dim tamt, tsumamt As Double
        Dim x, y, index, reccount, currec As Int32
        Dim tdate As Date

        Try
            With Me.Doc1
                .StartDoc()
                For index = 0 To Me.GridDetail.Rows.Count - 1
                    With Me.GridDetail
                        tdocnumber = DirectCast(.GetData(index, 2), String)
                        tamt = CDbl(.GetData(index, 3))
                        tdescr = DirectCast(.GetData(index, 6), String)
                        tdate = CDate(.GetData(index, 8))
                        tdoctype = DirectCast(.GetData(index, 9), String).ToUpper
                        tphaseerror = DirectCast(.GetData(index, 11), String)
                        tboldcode = DirectCast(.GetData(index, 12), String)
                        terrordescr = DirectCast(.GetData(index, 15), String).ToUpper
                        'if no error, then skip record
                        If tphaseerror = "0" Then GoTo SkipRecord
                        'iterate the linecounter
                        currec += 1
                        Select Case tdoctype
                            Case "B"
                                tdoctype = "Bank Charge"
                            Case "E"
                                tdoctype = "Expenditure"
                            Case "K"
                                tdoctype = "Lg.Chk"
                            Case Else
                                tdoctype = "Undefined"
                        End Select
                    End With
                    If currec = 1 Then
                        'print the column headers
                        y = 35
                        .RenderDirectText(0, y, "Issued / Coding", 70, 5, verdanaleft8bold)
                        .RenderDirectText(50, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(70, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(100, y, "Type", 25, 5, verdanaleft8bold)
                        .RenderDirectText(115, y, "Description / Warning and error messages", 73, 5, verdanaleft8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 42
                    End If
                    .RenderDirectText(0, y, tdate.ToShortDateString, 70, 5, verdanaleft8)
                    .RenderDirectText(50, y, tdocnumber, 20, 5, verdanaright8)
                    .RenderDirectText(70, y, tamt.ToString.Format("{0:F2}", tamt), 25, 5, verdanaright8)
                    .RenderDirectText(100, y, tdoctype, 20, 5, verdanaleft8)
                    .RenderDirectText(115, y, tdescr, 75, 5, verdanaleft8)
                    .RenderDirectText(0, y + 5, tboldcode, 70, 5, verdanaleft8)
                    .RenderDirectText(115, y + 5, terrordescr, 75, 5, verdanaleft8)
                    y += 12
                    'check for page break
                    If y >= 250 Then
                        If index >= (Me.GridDetail.Rows.Count - 1) Then Exit For
                        .NewPage()
                        'print the column headers
                        y = 35
                        .RenderDirectText(0, y, "Issued / Coding", 70, 5, verdanaleft8bold)
                        .RenderDirectText(50, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(70, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(100, y, "Type", 25, 5, verdanaleft8bold)
                        .RenderDirectText(115, y, "Description / Warning and error messages", 73, 5, verdanaleft8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 42
                        'reinitialise the linecounter
                        currec = 0
                    End If
                    reccount += 1
                    tsumamt += tamt
SkipRecord:
                    'expose the current record & count to the caller
                    'EventRecordProcessed((reccurrent), reccount)
                Next

                'print the totals
                If y = 0 Then y = 50
                If y >= 220 Then
                    .NewPage()
                    y = 50
                End If
                y += 5
                'print line below the column headers
                .RenderDirectLine(0, y - 1, 190, y - 1, Color.Gray, 0.5)
                .RenderDirectText(0, y, "TOTAL AMOUNT IN ERROR:", 60, 10, verdanaright8bold)
                .RenderDirectText(70, y, tsumamt.ToString.Format("{0:C2}", tsumamt), 25, 5, verdanaright8bold)
                y += 5
                .RenderDirectText(0, y, "TOTAL ITEMS IN ERROR:", 60, 10, verdanaright8bold)
                .RenderDirectText(70, y, reccount.ToString, 25, 5, verdanaright8bold)
                'print line below the column headers
                .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
            End With
        Catch ex As Exception
            Throw
        Finally

        End Try

        Try
            Application.DoEvents()
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintBoldCodeRevenue()
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count     code
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Me.DocumentName = "BoldCodeRevenue"
        Me.ReportName = "Activity Fund Bold Code Required Listing"
        If Me._editchk = True Then
            Me.ReportName = "Validate a Bold Code"
        End If
        Me.CellRightMiddle = "Revenue Reporting"

        'define styles
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles
        DefineStyles()
        'define the document
        DefineDocumentSettings(Me.DocumentName)

        Dim x, y, index As Int32
        Dim tboldcode, terrorval, terrordescr As String
        Dim tamt, tsumamt As Double
        Dim tcount, tsumcount As Int32
        Dim reccount, reccurrent As Int32

        Try
            With Me.Doc1
                .StartDoc()
                reccount = Me.GridDetail.Rows.Count
                For index = 0 To Me.GridDetail.Rows.Count - 1



                    '''''''''For single Edit check'''''''''''
                    If Me._editchk = True Then
                        index = Me.GridDetail.Rows.Count - 1
                        With Me.GridDetail
                            tamt = 0
                            tsumamt += tamt
                            tcount = CInt(.GetData(index, 4))
                            tsumcount += tcount

                            tboldcode = Me._Revenuecode
                            terrorval = DirectCast(.GetData(index, 14), String)
                            terrordescr = DirectCast(.GetData(index, 15), String).ToUpper
                            'render
                            'render
                            y = 35
                            Doc1.RenderDirectText(0, y, "Classification", 70, 5, verdanaleft8bold)
                            Doc1.RenderDirectText(60, y, "Value", 15, 5, verdanaright8bold)
                            Doc1.RenderDirectText(70, y, "Items", 20, 5, verdanaright8bold)
                            Doc1.RenderDirectText(90, y, "Expense", 25, 5, verdanaright8bold)
                            Doc1.RenderDirectText(117, y, "Warning and error messages", 73, 5, verdanaleft8bold)
                            'print line below the column headers
                            Doc1.RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                            y += 7

                            Doc1.RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                            y += 7
                            Doc1.RenderDirectText(0, y, tboldcode, 65, 5, verdanaleft8)
                            Doc1.RenderDirectText(65, y, terrorval, 10, 5, verdanaright8)
                            Doc1.RenderDirectText(70, y, tcount.ToString, 20, 5, verdanaright8)
                            Doc1.RenderDirectText(90, y, tamt.ToString.Format("{0:F2}", tamt), 25, 5, verdanaright8)
                            Doc1.RenderDirectText(117, y, terrordescr, 73, 10, verdanaleft8)
                            'print line below the column headers
                            y += 7
                            Doc1.RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)


                            Me.btnAdministrator.Enabled = True
                            Me.PanelBoldFail.Visible = True
                            Me.Label3.Text = ""
                            Me.Label4.Text = "   Testing Only  "
                            Me.PanelBoldSuccess.Visible = False
                            Me.btnCreateBoldCodeExpenditure.Enabled = False
                            Me.btnCreateBoldCodeExpenditure.Text = "File Disabled"
                            Me.btnCreateBoldCodeExpenditure.Visible = True
                            Me.btnCreateBoldCodeRevenue.Visible = False
                        End With
                        Try
                            'set the preview zoom
                            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
                            'finish the document
                            Me.Doc1.EndDoc()
                        Catch ex As Exception
                            Throw
                        End Try
                        Exit Sub
                    End If
                    '''''''''For single Edit check''''''''''
                    If index = 0 Then
                        'print the column headers
                        y = 35
                        .RenderDirectText(0, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(60, y, "Value", 15, 5, verdanaright8bold)
                        .RenderDirectText(70, y, "Items", 20, 5, verdanaright8bold)
                        .RenderDirectText(90, y, "Revenue", 25, 5, verdanaright8bold)
                        .RenderDirectText(117, y, "Warning and error messages", 73, 5, verdanaleft8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 42
                    End If

                    With Me.GridDetail
                        tamt = CDbl(.GetData(index, 3))
                        tsumamt += tamt
                        tcount = CInt(.GetData(index, 4))
                        tsumcount += tcount
                        tboldcode = DirectCast(.GetData(index, 12), String)
                        terrorval = DirectCast(.GetData(index, 14), String)
                        terrordescr = DirectCast(.GetData(index, 15), String).ToUpper
                    End With

                    .RenderDirectText(0, y, tboldcode, 65, 5, verdanaleft8)
                    .RenderDirectText(65, y, terrorval, 10, 5, verdanaright8)
                    .RenderDirectText(70, y, tcount.ToString, 20, 5, verdanaright8)
                    .RenderDirectText(90, y, tamt.ToString.Format("{0:F2}", tamt), 25, 5, verdanaright8)
                    .RenderDirectText(117, y, terrordescr, 73, 10, verdanaleft8)
                    y += 7
                    'expose the current record & count to the caller
                    'EventRecordProcessed((reccurrent), reccount)

                    'check for page break
                    If y >= 250 Then
                        If index >= (Me.GridDetail.Rows.Count - 1) Then Exit For
                        .NewPage()
                        'print the column headers
                        y = 35
                        .RenderDirectText(0, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(60, y, "Value", 15, 5, verdanaright8bold)
                        .RenderDirectText(70, y, "Items", 20, 5, verdanaright8bold)
                        .RenderDirectText(90, y, "Expense", 25, 5, verdanaright8bold)
                        .RenderDirectText(117, y, "Warning and error messages", 73, 5, verdanaleft8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 42
                    End If
                    '''''If index > 19 Then Exit For
                    '''''Debug.WriteLine(index)
                Next
                y += 4
                If y >= 189 Then
                    .NewPage()
                    y = 50
                End If
                .RenderDirectText(0, y, "REVENUE REPORTED TO THE STATE:", 70, 10, verdanaright8bold)
                .RenderDirectText(70, y, tsumcount.ToString, 20, 5, verdanaright8bold)
                .RenderDirectText(90, y, tsumamt.ToString.Format("{0:F2}", tsumamt), 25, 5, verdanaright8bold)
            End With
        Catch ex As Exception
            Throw
        End Try

        Try
            'print the summary values
            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            '      0        1       2       3        4       5       6       7
            '   acctbal  rcptsum  chksum  adjbank  adjexp  adjint  adjnsf  adjrev
            '      8        9 
            '  legrcpts legchecks
            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            Dim calcval, sumval, sumexpend As Double
            Dim val0, val1, val2, val3, val4, val5, val6, val7, val8, val9 As Double

            With Me.GridTotals
                val0 = CDbl(.GetData(0, 0))
                val1 = CDbl(.GetData(0, 1))
                val2 = CDbl(.GetData(0, 2))
                val3 = CDbl(.GetData(0, 3))
                val4 = CDbl(.GetData(0, 4))
                val5 = CDbl(.GetData(0, 5))
                val6 = CDbl(.GetData(0, 6))
                val7 = CDbl(.GetData(0, 7))
                val8 = CDbl(.GetData(0, 8))
                val9 = CDbl(.GetData(0, 9))
            End With
            'Pat/Fred fix 2005.06.14
            'this is a school-specific fix for boldcode due to the way that the 
            'DOS adjustments are picked up;  we have to multiply the expenditure
            'adjustments by -1 since they appear as negatives in the system;
            Select Case Me.SchoolNumber
                '''''Case "497", "314", "080"
                '''''    val4 *= -1
                '''''    sumval = val0 + val1 - val2 - val3 - val4 + val5 + val6 + val7
                '''''    sumexpend = val2 + val3 + val4
                '''''Case "874"
                '''''    sumval = val0 + val1 - val2 - val3 - val4 + val5 + val6 + val7
                '''''    sumexpend = val2 + val3 + val4
            Case Else
                    'sumval = val0 + val1 - val2 - val3 + val4 + val5 + val6 + val7
                    sumexpend = (val2 + val3 + val9) - val4
            End Select

            With Me.Doc1
                x = 90
                y += 12
                calcval = val1 + val8
                .RenderDirectText(0, y, "Activity Fund Year-To-Date Receipts:", 75, 5, verdanaright8)
                .RenderDirectText(x, y, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 4, "Add: Interest Received", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 4, val5.ToString.Format("{0:F2}", val5), 25, 5, verdanaright8)
                'total receipts and interest
                calcval = val1 + val5 + val8
                .RenderDirectText(0, y + 10, "Total Receipts And Interest:", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 10, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                calcval = val6 + val7
                .RenderDirectText(0, y + 14, "Add: Net Receipt Adjustments", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 14, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                calcval = val1 + val5 + val6 + val7 + val8
                .RenderDirectText(0, y + 20, "Revenues For Fiscal Year " & Me.FiscalYearSelected.ToString & ":", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 20, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 24, "Less: Receipts Voided From Previous Year", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 24, 0.ToString.Format("{0:F2}", 0), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 30, "TOTAL ACTIVITY FUND REVENUE:", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 30, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                y += 36
                .RenderDirectText(0, y, "Add: Activity Fund Beginning Balance", 75, 5, verdanaright8)
                .RenderDirectText(x, y, val0.ToString.Format("{0:F2}", val0), 25, 5, verdanaright8)
                calcval = val2 + val9
                .RenderDirectText(0, y + 4, "Less: Total Checks", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 4, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 8, "Less: Bank Charges", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 8, val3.ToString.Format("{0:F2}", val3), 25, 5, verdanaright8)
                .RenderDirectText(0, y + 12, "Add: Expenditure Adjustments", 75, 5, verdanaright8)
                .RenderDirectText(x, y + 12, val4.ToString.Format("{0:F2}", val4), 25, 5, verdanaright8)
                y += 18
                calcval = val0 + val1 - val2 - val3 + val4 + val5 + val6 + val7 + val8 - val9
                .RenderDirectText(0, y, "ACTIVITY FUND BANK BALANCE:", 75, 5, verdanaright8)
                .RenderDirectText(x, y, calcval.ToString.Format("{0:F2}", calcval), 25, 5, verdanaright8)
            End With
        Catch ex As Exception
            Throw
        End Try


        Try
            'allow user to create a bold code file if error-free;
            If Me.HasErrors Then
                Me.btnAdministrator.Enabled = True
                Me.PanelBoldFail.Visible = True
                Me.PanelBoldSuccess.Visible = False
                Me.btnCreateBoldCodeRevenue.Enabled = False
                Me.btnCreateBoldCodeRevenue.Text = "File disabled"
                Me.btnCreateBoldCodeRevenue.Visible = True
                Me.btnCreateBoldCodeExpenditure.Visible = False
            Else
                Me.btnAdministrator.Enabled = False
                Me.btnCreateBoldCodeRevenue.Enabled = True
                Me.btnCreateBoldCodeRevenue.Text = "Create bold code file"
                Me.btnCreateBoldCodeRevenue.Visible = True
                Me.btnCreateBoldCodeExpenditure.Visible = False
            End If
        Catch ex As Exception
            Throw
        End Try

        Try
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            _editchk = False
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintBoldCodeRevenueErrorsOnly()
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9       10
        '   descr     remarks   created    ttype -- NOT USED --
        '    11          12        13       14       15   
        '  phaseerror boldfmt  boldunfmt errorval errordescr
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Me.DocumentName = "BoldCodeRevenue"
        Me.ReportName = "Activity Fund Bold Code Detail"
        Me.CellRightMiddle = "Revenue Reporting"
        Me.CellMiddleBottom = "Detail Errors Only"

        'define styles
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles
        DefineStyles()
        'define the document
        DefineDocumentSettings(Me.DocumentName)

        Dim tboldcode, terrorval, terrordescr, tphaseerror As String
        Dim tdocnumber, tdoctype, tdescr, tremarks As String
        Dim tamt, tsumamt As Double
        Dim x, y, index, reccount, currec As Int32
        Dim tdate As Date

        Try
            With Me.Doc1
                .StartDoc()
                For index = 0 To Me.GridDetail.Rows.Count - 1
                    With Me.GridDetail
                        tdocnumber = DirectCast(.GetData(index, 2), String)
                        tamt = CDbl(.GetData(index, 3))
                        tdescr = DirectCast(.GetData(index, 6), String)
                        tdate = CDate(.GetData(index, 8))
                        tdoctype = DirectCast(.GetData(index, 9), String).ToUpper
                        tphaseerror = DirectCast(.GetData(index, 11), String)
                        tboldcode = DirectCast(.GetData(index, 12), String)
                        terrordescr = DirectCast(.GetData(index, 15), String).ToUpper
                        'if no error, then skip record
                        If tphaseerror = "0" Then GoTo SkipRecord
                        'iterate the linecounter
                        currec += 1
                        Select Case tdoctype
                            Case "N"
                                tdoctype = "Adj-NSF"
                            Case "R"
                                tdoctype = "Adj-Rev"
                            Case "J"
                                tdoctype = "Lg.Rcpt"
                            Case Else
                                tdoctype = "Undefined"
                        End Select
                    End With
                    If currec = 1 Then
                        'print the column headers
                        y = 35
                        .RenderDirectText(0, y, "Issued / Coding", 70, 5, verdanaleft8bold)
                        .RenderDirectText(50, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(70, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(100, y, "Type", 25, 5, verdanaleft8bold)
                        .RenderDirectText(115, y, "Description / Warning and error messages", 73, 5, verdanaleft8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 42
                    End If
                    .RenderDirectText(0, y, tdate.ToShortDateString, 70, 5, verdanaleft8)
                    .RenderDirectText(50, y, tdocnumber, 20, 5, verdanaright8)
                    .RenderDirectText(70, y, tamt.ToString.Format("{0:F2}", tamt), 25, 5, verdanaright8)
                    .RenderDirectText(100, y, tdoctype, 15, 5, verdanaleft8)
                    .RenderDirectText(115, y, tdescr, 75, 5, verdanaleft8)
                    .RenderDirectText(0, y + 5, tboldcode, 70, 5, verdanaleft8)
                    .RenderDirectText(115, y + 5, terrordescr, 75, 10, verdanaleft8)
                    y += 14
                    'check for page break
                    If y >= 250 Then
                        If index >= (Me.GridDetail.Rows.Count - 1) Then Exit For
                        .NewPage()
                        'print the column headers
                        y = 35
                        .RenderDirectText(0, y, "Issued / Coding", 70, 5, verdanaleft8bold)
                        .RenderDirectText(50, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(70, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(100, y, "Type", 25, 5, verdanaleft8bold)
                        .RenderDirectText(115, y, "Description / Warning and error messages", 73, 5, verdanaleft8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 42
                        'reinitialise the linecounter
                        currec = 0
                    End If
                    reccount += 1
                    tsumamt += tamt
SkipRecord:
                    'expose the current record & count to the caller
                    'EventRecordProcessed((reccurrent), reccount)
                Next

                'print the totals
                If y = 0 Then y = 50
                If y >= 220 Then
                    .NewPage()
                    y = 50
                End If
                y += 5
                'print line below the column headers
                .RenderDirectLine(0, y - 1, 190, y - 1, Color.Gray, 0.5)
                .RenderDirectText(0, y, "TOTAL AMOUNT IN ERROR:", 60, 10, verdanaright8bold)
                .RenderDirectText(70, y, tsumamt.ToString.Format("{0:C2}", tsumamt), 25, 5, verdanaright8bold)
                y += 5
                .RenderDirectText(0, y, "TOTAL ITEMS IN ERROR:", 60, 10, verdanaright8bold)
                .RenderDirectText(70, y, reccount.ToString, 25, 5, verdanaright8bold)
                'print line below the column headers
                .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
            End With
        Catch ex As Exception
            Throw
        Finally

        End Try

        Try
            Application.DoEvents()
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintClassificationRevenueListing()
        Me.DocumentName = "Classification"
        Me.ReportName = "Activity Fund Classification Listing"
        'define styles
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles
        DefineStyles()
        'define the document
        DefineDocumentSettings(Me.DocumentName)

        Dim classcode, formatcode, nextcode, banknumber As String
        Dim docnumber, doctype, descr As String
        Dim amount, balance, codebalance As Double
        Dim issued As Date
        Dim lastrecord As Boolean
        Dim totalreceipt, totalinterest, totalrevadjust, totalnsf, totalrevenue, totalexpadjust, totalexpenditures, totallegrcpt, totallegchks, totalbankcharge, beginbalance As Double
        Dim tsumamt As Double
        Dim notselectedrcpt, selectedrcpt, actfundbalance, selrevadj, selexpadj, selinterest, selnsf, selbankchg, selsum, selexpend As Double
        Dim x, y, index, reccount As Int32

        Try
            With Me.Doc1
                .StartDoc()
                For index = 0 To Me.GridDetail.Rows.Count - 1
                    '''''''''''''''''''''''''''' GridDetail ''''''''''''''''''''''''''''''
                    '     0          1         2         3        4       5       6  
                    '   amount    number     class     descr    issued   key   doctype
                    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                    With Me.GridDetail
                        docnumber = DirectCast(.GetData(index, 1), String)
                        amount = CDbl(.GetData(index, 0))
                        classcode = DirectCast(.GetData(index, 2), String)
                        descr = DirectCast(.GetData(index, 3), String)
                        issued = CDate(.GetData(index, 4))
                        doctype = DirectCast(.GetData(index, 6), String)
                        banknumber = DirectCast(.GetData(index, 7), String)
                        balance += amount
                        codebalance += amount
                        formatcode = Module1.FormatRevenueCode(classcode)
                        '''''amount = 256653.36
                        '''''balance = 25566932.39
                        '''''descr = "a b c d e f g h i j k l m n o p q r s t u v w x y z"
                        '''''formatcode = "7-60-000-1225-252-002-2142-252-050"
                        If index = .Rows.Count - 1 Then lastrecord = True
                        If index < .Rows.Count - 1 Then nextcode = DirectCast(.GetData(index + 1, 2), String)
                    End With

                    If index = 0 Then
                        'print the column headers
                        y = 35
                        .RenderDirectText(2, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(62, y, "Payee", 20, 5, verdanaleft8bold)
                        .RenderDirectText(102, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(122, y, "Issued", 20, 5, verdanaright8bold)
                        .RenderDirectText(140, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(163, y, "Tally", 25, 5, verdanaright8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If

                    .RenderDirectText(0, y, formatcode, 65, 5, verdanaleft8)
                    .RenderDirectText(62, y, descr, 45, 10, verdanaleft8)
                    .RenderDirectText(103, y, docnumber, 20, 5, verdanaright8)
                    .RenderDirectText(125, y, issued.ToString.Format("{0:MM/dd/yyyy}", issued), 20, 5, verdanaright8)
                    .RenderDirectText(140, y, amount.ToString.Format("{0:F2}", amount), 25, 5, verdanaright8)
                    .RenderDirectText(165, y, balance.ToString.Format("{0:F2}", balance), 25, 5, verdanaright8)
                    y += 7

                    'check for page break
                    If y >= 240 Then
                        If index >= (Me.GridDetail.Rows.Count - 1) Then Exit For
                        .NewPage()
                        'print the column headers
                        y = 35
                        .RenderDirectText(2, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(62, y, "Payee", 20, 5, verdanaleft8bold)
                        .RenderDirectText(102, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(122, y, "Issued", 20, 5, verdanaright8bold)
                        .RenderDirectText(140, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(163, y, "Tally", 25, 5, verdanaright8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If

                    'print a subtotal line if the code has changed or last record is true;
                    If (classcode.Compare(classcode, nextcode, False) <> 0) Or (lastrecord) Then
                        .RenderDirectText(0, y, "Subtotal:", 60, 5, verdanaright8bold)
                        .RenderDirectText(130, y, codebalance.ToString.Format("{0:F2}", codebalance), 35, 5, verdanaright8bold)
                        '.RenderDirectText(165, y, "***", 20, 5, verdanaleft8bold)
                        codebalance = 0
                        y += 9
                    End If

                    reccount += 1
                    Select Case doctype
                        Case "B"
                            selbankchg += amount
                        Case "I"
                            selinterest += amount
                        Case "J"
                            totallegrcpt += amount
                        Case "K"
                            totallegchks += amount
                        Case "N"
                            selnsf += amount
                        Case "T"
                            selrevadj += amount
                        Case "R"
                            selectedrcpt += amount
                        Case "A"
                            selexpadj += amount
                        Case "E"
                            selexpend += amount
                        Case Else
                            doctype = "Undefined"
                    End Select


                    selsum = selectedrcpt + selrevadj + selinterest + selnsf

SkipRecord:
                    'expose the current record & count to the caller
                    'EventRecordProcessed((reccurrent), reccount)
                Next
                'collect the totals from the totalgrid to use as a match;
                Dim gbankcharge, gexpadjust, grevadjust, ginterest, glegchks, glegrcpts, gnsf, gexpenditure, grevenue, gbegbalance As Double
                With Me.GridTotals
                    ginterest = CDbl(.GetData(0, 0))
                    gbankcharge = CDbl(.GetData(0, 1))
                    grevadjust = CDbl(.GetData(0, 2))
                    gnsf = CDbl(.GetData(0, 3))
                    gexpadjust = CDbl(.GetData(0, 4))
                    glegrcpts = CDbl(.GetData(0, 5))
                    glegchks = CDbl(.GetData(0, 6))
                    grevenue = CDbl(.GetData(0, 7))
                    gexpenditure = CDbl(.GetData(0, 8))
                    gbegbalance = CDbl(.GetData(0, 9))

                    'totalrevenue = totalreceipt + totalrevadjust + totalinterest + totalnsf

                End With

                beginbalance = gbegbalance
                notselectedrcpt = grevenue - selectedrcpt
                totalrevenue = grevenue
                totalinterest = ginterest
                totalrevadjust = grevadjust
                totalnsf = gnsf
                totalexpadjust = gexpadjust
                totalexpenditures = gexpenditure
                totallegrcpt = glegrcpts
                totallegchks = glegchks
                totalbankcharge = gbankcharge
                actfundbalance = beginbalance + totalrevenue + totalinterest + totalrevadjust - totalexpenditures + totalexpadjust + totalnsf - totalbankcharge

                Try
                    If ginterest <> totalinterest Then Throw New ArgumentException("Total interest not matching detail records.")
                    If gbankcharge <> totalbankcharge Then Throw New ArgumentException("Total bank charge not matching detail records.")
                    If grevadjust <> totalrevadjust Then Throw New ArgumentException("Total revenue adjustments not matching detail records.")
                    If grevenue <> totalrevenue Then Throw New ArgumentException("Total revenue not matching detail records.")
                    If gnsf <> totalnsf Then Throw New ArgumentException("Total nsf charges not matching detail records.")
                    If gexpenditure <> totalexpenditures Then Throw New ArgumentException("Total expenditures not matching detail records.")
                    If glegrcpts <> totallegrcpt Then Throw New ArgumentException("Total legacy receipts not matching detail records.")
                    If glegchks <> totallegchks Then Throw New ArgumentException("Total legacy checks not matching detail records.")
                Catch ex As Exception
                    Throw
                End Try




                'print the totals on new page;
                .NewPage()
                y = 50

                'print the total text
                .RenderDirectLine(10, y - 1, 180, y - 1, Color.Gray, 0.5)
                .RenderDirectText(10, y, "Total items:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 5, "Selected Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 10, "Selected Revenue Adjust:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 15, "Selected Interest:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 20, "Selected Nsf:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 25, "Receipts Not In Range:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 30, "Sub Total:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 40, "Begining Balance:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 45, "Total Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 50, "Total Legacy Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 55, "Total Revenue Adjust:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 60, "Total Interest:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 65, "Total Legacy Checks:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 70, "Total Expenditures:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 75, "Total Bank Charges:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 80, "Total Not-Sufficient-Funds:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 85, "Expenditures Adjustments:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 90, "ACT FUND BANK BALANCE:", 60, 10, verdanaright8bold)

                'print the total amounts
                .RenderDirectText(90, y, reccount.ToString.Format("{0:D1}", reccount), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 5, selectedrcpt.ToString.Format("{0:C2}", selectedrcpt), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 10, selrevadj.ToString.Format("{0:C2}", selrevadj), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 15, selinterest.ToString.Format("{0:C2}", selinterest), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 20, selnsf.ToString.Format("{0:C2}", selnsf), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 25, notselectedrcpt.ToString.Format("{0:C2}", notselectedrcpt), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 30, selsum.ToString.Format("{0:C2}", selsum), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 40, beginbalance.ToString.Format("{0:C2}", beginbalance), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 45, totalrevenue.ToString.Format("{0:C2}", totalrevenue), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 50, glegrcpts.ToString.Format("{0:C2}", glegrcpts), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 55, totalrevadjust.ToString.Format("{0:C2}", totalrevadjust), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 60, totalinterest.ToString.Format("{0:C2}", totalinterest), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 65, totallegchks.ToString.Format("{0:C2}", totallegchks), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 70, totalexpenditures.ToString.Format("{0:C2}", totalexpenditures), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 75, totalbankcharge.ToString.Format("{0:C2}", totalbankcharge), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 80, totalnsf.ToString.Format("{0:C2}", totalnsf), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 85, totalexpadjust.ToString.Format("{0:C2}", totalexpadjust), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 90, actfundbalance.ToString.Format("{0:C2}", actfundbalance), 35, 5, verdanaright8bold)

                '.RenderDirectText(0, y, "TOTAL ITEMS IN ERROR:", 60, 10, verdanaright8bold)
                '.RenderDirectText(70, y, reccount.ToString, 25, 5, verdanaright8bold)
                'print line below the column headers
                .RenderDirectLine(10, y + 90, 180, y + 90, Color.Gray, 0.5)
            End With
        Catch ex As Exception
            Throw
        Finally

        End Try

        Try
            Application.DoEvents()
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintClassificationRevenueSpecific()
        Me.DocumentName = "Classification"
        Me.ReportName = "Activity Fund Classification Listing"
        'Me.CellMiddleMiddle = eclassfilter
        'define styles
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles
        DefineStyles()
        'define the document
        DefineDocumentSettings(Me.DocumentName)

        Dim classcode, formatcode, nextcode As String
        Dim docnumber, doctype, descr As String
        Dim amount, balance, codebalance As Double
        Dim issued As Date
        Dim lastrecord As Boolean
        Dim totalreceipt, totalinterest, totalrevadjust, totalnsf, totalrevenue, totalexpadjust, totalexpenditures, totallegrcpt, totallegchks, totalbankcharge, beginbalance As Double
        Dim notselectedrcpt, selectedrcpt, actfundbalance, selrevadj, selexpadj, selinterest, selnsf, selbankchg, selsum, selexpend As Double
        Dim x, y, index, reccount As Int32

        Try
            With Me.Doc1
                .StartDoc()
                For index = 0 To Me.GridDetail.Rows.Count - 1
                    '''''''''''''''''''''''''''' GridDetail ''''''''''''''''''''''''''''''
                    '     0          1         2         3        4       5       6  
                    '   amount    number     class     descr    issued   key   doctype
                    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                    With Me.GridDetail
                        docnumber = DirectCast(.GetData(index, 1), String)
                        amount = CDbl(.GetData(index, 0))
                        classcode = DirectCast(.GetData(index, 2), String)
                        descr = DirectCast(.GetData(index, 3), String)
                        issued = CDate(.GetData(index, 4))
                        doctype = DirectCast(.GetData(index, 6), String)
                        balance += amount
                        codebalance += amount
                        formatcode = Module1.FormatRevenueCode(classcode)
                        '''''amount = 256653.36
                        '''''balance = 25566932.39
                        '''''descr = "a b c d e f g h i j k l m n o p q r s t u v w x y z"
                        '''''formatcode = "7-60-000-1225-252-002-2142-252-050"
                        If index = .Rows.Count - 1 Then lastrecord = True
                        If index < .Rows.Count - 1 Then nextcode = DirectCast(.GetData(index + 1, 2), String)
                    End With

                    If index = 0 Then
                        'print the column headers
                        y = 35
                        .RenderDirectText(2, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(62, y, "Payee", 20, 5, verdanaleft8bold)
                        .RenderDirectText(102, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(122, y, "Issued", 20, 5, verdanaright8bold)
                        .RenderDirectText(140, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(163, y, "Tally", 25, 5, verdanaright8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If

                    .RenderDirectText(0, y, formatcode, 65, 5, verdanaleft8)
                    .RenderDirectText(62, y, descr, 45, 10, verdanaleft8)
                    .RenderDirectText(103, y, docnumber, 20, 5, verdanaright8)
                    .RenderDirectText(125, y, issued.ToString.Format("{0:MM/dd/yyyy}", issued), 20, 5, verdanaright8)
                    .RenderDirectText(140, y, amount.ToString.Format("{0:F2}", amount), 25, 5, verdanaright8)
                    .RenderDirectText(165, y, balance.ToString.Format("{0:F2}", balance), 25, 5, verdanaright8)
                    y += 7

                    'check for page break
                    If y >= 240 Then

                        .NewPage()
                        'print the column headers
                        y = 35
                        .RenderDirectText(2, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(62, y, "Payee", 20, 5, verdanaleft8bold)
                        .RenderDirectText(102, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(122, y, "Issued", 20, 5, verdanaright8bold)
                        .RenderDirectText(140, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(163, y, "Tally", 25, 5, verdanaright8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If

                    'print a subtotal line if the code has changed or last record is true;
                    If (classcode.Compare(classcode, nextcode, False) <> 0) Or (lastrecord) Then
                        .RenderDirectText(0, y, "Subtotal:", 60, 5, verdanaright8bold)
                        .RenderDirectText(130, y, codebalance.ToString.Format("{0:F2}", codebalance), 35, 5, verdanaright8bold)
                        '.RenderDirectText(165, y, "***", 20, 5, verdanaleft8bold)
                        codebalance = 0
                        y += 9
                    End If

                    reccount += 1
                    Select Case doctype
                        Case "B"
                            selbankchg += amount
                        Case "I"
                            selinterest += amount
                        Case "J"
                            totallegrcpt += amount
                        Case "K"
                            totallegchks += amount
                        Case "N"
                            selnsf += amount
                        Case "T"
                            selrevadj += amount
                        Case "R"
                            selectedrcpt += amount
                        Case "A"
                            selexpadj += amount
                        Case "E"
                            selexpend += amount
                        Case Else
                            doctype = "Undefined"
                    End Select


                    selsum = selectedrcpt + selrevadj + selinterest + selnsf

SkipRecord:
                    'expose the current record & count to the caller
                    'EventRecordProcessed((reccurrent), reccount)
                Next
                'collect the totals from the totalgrid to use as a match;
                Dim gbankcharge, gexpadjust, grevadjust, ginterest, glegchks, glegrcpts, gnsf, gexpenditure, grevenue, gbegbalance As Double
                With Me.GridTotals
                    ginterest = CDbl(.GetData(0, 0))
                    gbankcharge = CDbl(.GetData(0, 1))
                    grevadjust = CDbl(.GetData(0, 2))
                    gnsf = CDbl(.GetData(0, 3))
                    gexpadjust = CDbl(.GetData(0, 4))
                    glegrcpts = CDbl(.GetData(0, 5))
                    glegchks = CDbl(.GetData(0, 6))
                    grevenue = CDbl(.GetData(0, 7))
                    gexpenditure = CDbl(.GetData(0, 8))
                    gbegbalance = CDbl(.GetData(0, 9))
                End With


                beginbalance = gbegbalance
                notselectedrcpt = grevenue - selectedrcpt
                totalrevenue = grevenue
                totalinterest = ginterest
                totalrevadjust = grevadjust
                totalnsf = gnsf
                totalexpadjust = gexpadjust
                totalexpenditures = gexpenditure
                totallegrcpt = glegrcpts
                totallegchks = glegchks
                totalbankcharge = gbankcharge
                actfundbalance = beginbalance + totalrevenue + totalinterest + totalrevadjust - totalexpenditures + totalexpadjust + totalnsf - totalbankcharge

                'print the totals on new page;
                .NewPage()
                y = 50

                'print the total text
                .RenderDirectLine(10, y - 1, 180, y - 1, Color.Gray, 0.5)
                .RenderDirectText(10, y, "Total items:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 5, "Selected Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 10, "Selected Revenue Adjust:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 15, "Selected Interest:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 20, "Selected Nsf:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 25, "Receipts Not In Range:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 30, "Sub Total:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 40, "Begining Balance:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 45, "Total Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 50, "Total Legacy Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 55, "Total Revenue Adjust:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 60, "Total Interest:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 65, "Total Legacy Checks:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 70, "Total Expenditures:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 75, "Total Bank Charges:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 80, "Total Not-Sufficient-Funds:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 85, "Expenditures Adjustments:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 90, "ACT FUND BANK BALANCE:", 60, 10, verdanaright8bold)


                'print the total amounts
                .RenderDirectText(90, y, reccount.ToString.Format("{0:D1}", reccount), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 5, selectedrcpt.ToString.Format("{0:C2}", selectedrcpt), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 10, selrevadj.ToString.Format("{0:C2}", selrevadj), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 15, selinterest.ToString.Format("{0:C2}", selinterest), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 20, selnsf.ToString.Format("{0:C2}", selnsf), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 25, notselectedrcpt.ToString.Format("{0:C2}", notselectedrcpt), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 30, selsum.ToString.Format("{0:C2}", selsum), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 40, beginbalance.ToString.Format("{0:C2}", beginbalance), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 45, totalrevenue.ToString.Format("{0:C2}", totalrevenue), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 50, glegrcpts.ToString.Format("{0:C2}", glegrcpts), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 55, totalrevadjust.ToString.Format("{0:C2}", totalrevadjust), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 60, totalinterest.ToString.Format("{0:C2}", totalinterest), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 65, totallegchks.ToString.Format("{0:C2}", totallegchks), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 70, totalexpenditures.ToString.Format("{0:C2}", totalexpenditures), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 75, totalbankcharge.ToString.Format("{0:C2}", totalbankcharge), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 80, totalnsf.ToString.Format("{0:C2}", totalnsf), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 85, totalexpadjust.ToString.Format("{0:C2}", totalexpadjust), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 90, actfundbalance.ToString.Format("{0:C2}", actfundbalance), 35, 5, verdanaright8bold)

                '.RenderDirectText(0, y, "TOTAL ITEMS IN ERROR:", 60, 10, verdanaright8bold)
                '.RenderDirectText(70, y, reccount.ToString, 25, 5, verdanaright8bold)
                'print line below the column headers
                .RenderDirectLine(10, y + 90, 180, y + 90, Color.Gray, 0.5)
            End With
        Catch ex As Exception
            Throw
        Finally

        End Try

        Try
            Application.DoEvents()
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintClassificationExpendListing()
        Me.DocumentName = "Classification"
        Me.ReportName = "Activity Fund Classification Listing"
        'define styles
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles
        DefineStyles()
        'define the document
        DefineDocumentSettings(Me.DocumentName)

        Dim classcode, formatcode, nextcode As String
        Dim docnumber, doctype, descr As String
        Dim amount, balance, codebalance As Double
        Dim issued As Date
        Dim lastrecord As Boolean
        Dim totalreceipt, totalinterest, totalrevadjust, totalnsf, totalrevenue, totalexpadjust, totalexpenditures, totallegrcpt, totallegchks, totalbankcharge, beginbalance As Double
        Dim tsumamt As Double
        Dim notselectedexp, actfundbalance, selexpadj, selinterest, selnsf, selbankchg, selsum, selexpend As Double
        Dim x, y, index, reccount As Int32

        Try
            With Me.Doc1
                .StartDoc()
                For index = 0 To Me.GridDetail.Rows.Count - 1
                    '''''''''''''''''''''''''''' GridDetail ''''''''''''''''''''''''''''''
                    '     0          1         2         3        4       5       6  
                    '   amount    number     class     descr    issued   key   doctype
                    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                    With Me.GridDetail
                        docnumber = DirectCast(.GetData(index, 2), String)
                        amount = CDbl(.GetData(index, 3))
                        classcode = DirectCast(.GetData(index, 4), String)
                        descr = DirectCast(.GetData(index, 5), String)
                        issued = CDate(.GetData(index, 7))
                        doctype = DirectCast(.GetData(index, 8), String)
                        balance += amount
                        codebalance += amount
                        formatcode = Module1.FormatExpenditureCode(classcode)
                        '''''amount = 256653.36
                        '''''balance = 25566932.39
                        '''''descr = "a b c d e f g h i j k l m n o p q r s t u v w x y z"
                        '''''formatcode = "7-60-000-1225-252-002-2142-252-050"
                        If index = .Rows.Count - 1 Then lastrecord = True
                        'If index < .Rows.Count - 1 Then nextcode = DirectCast(.GetData(index + 1, 2), String)
                        If index < .Rows.Count - 1 Then nextcode = DirectCast(.GetData(index + 1, 4), String)
                    End With

                    If index = 0 Then
                        'print the column headers
                        y = 35
                        .RenderDirectText(2, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(62, y, "Payee", 20, 5, verdanaleft8bold)
                        .RenderDirectText(102, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(122, y, "Issued", 20, 5, verdanaright8bold)
                        .RenderDirectText(140, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(163, y, "Tally", 25, 5, verdanaright8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If

                    .RenderDirectText(0, y, formatcode, 65, 5, verdanaleft8)
                    .RenderDirectText(62, y, descr, 45, 10, verdanaleft8)
                    .RenderDirectText(103, y, docnumber, 20, 5, verdanaright8)
                    .RenderDirectText(125, y, issued.ToString.Format("{0:MM/dd/yyyy}", issued), 20, 5, verdanaright8)
                    .RenderDirectText(140, y, amount.ToString.Format("{0:F2}", amount), 25, 5, verdanaright8)
                    .RenderDirectText(165, y, balance.ToString.Format("{0:F2}", balance), 25, 5, verdanaright8)
                    y += 7

                    'check for page break
                    If y >= 240 Then
                        If index >= (Me.GridDetail.Rows.Count - 1) Then Exit For
                        .NewPage()
                        'print the column headers
                        y = 35
                        .RenderDirectText(2, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(62, y, "Payee", 20, 5, verdanaleft8bold)
                        .RenderDirectText(102, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(122, y, "Issued", 20, 5, verdanaright8bold)
                        .RenderDirectText(140, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(163, y, "Tally", 25, 5, verdanaright8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If

                    'print a subtotal line if the code has changed or last record is true;
                    If (classcode.Compare(classcode, nextcode, False) <> 0) Or (lastrecord) Then
                        .RenderDirectText(0, y, "Subtotal:", 60, 5, verdanaright8bold)
                        .RenderDirectText(130, y, codebalance.ToString.Format("{0:F2}", codebalance), 35, 5, verdanaright8bold)
                        '.RenderDirectText(165, y, "***", 20, 5, verdanaleft8bold)
                        codebalance = 0
                        y += 9
                    End If

                    reccount += 1
                    Select Case doctype
                        Case "E"
                            selexpend += amount
                        Case "A"
                            selexpadj += amount
                        Case "B"
                            selbankchg += amount
                        Case "K"
                            totallegchks += amount
                        Case Else
                            doctype = "Undefined"
                    End Select


                    selsum = selexpend + selexpadj + selbankchg

SkipRecord:
                    'expose the current record & count to the caller
                    'EventRecordProcessed((reccurrent), reccount)
                Next
                'collect the totals from the totalgrid to use as a match;
                Dim gbankcharge, gexpadjust, grevadjust, ginterest, glegchks, glegrcpts, gnsf, gexpenditure, grevenue, gbegbalance As Double
                With Me.GridTotals
                    ginterest = CDbl(.GetData(0, 0))
                    gbankcharge = CDbl(.GetData(0, 1))
                    grevadjust = CDbl(.GetData(0, 2))
                    gnsf = CDbl(.GetData(0, 3))
                    gexpadjust = CDbl(.GetData(0, 4))
                    glegrcpts = CDbl(.GetData(0, 5))
                    glegchks = CDbl(.GetData(0, 6))
                    grevenue = CDbl(.GetData(0, 7))
                    gexpenditure = CDbl(.GetData(0, 8))
                    gbegbalance = CDbl(.GetData(0, 9))

                    'totalrevenue = totalreceipt + totalrevadjust + totalinterest + totalnsf

                End With

                beginbalance = gbegbalance
                notselectedexp = gexpenditure - selexpend
                totalrevenue = grevenue
                totalinterest = ginterest
                totalrevadjust = grevadjust
                totalnsf = gnsf
                totalexpadjust = gexpadjust
                totalexpenditures = gexpenditure
                totallegrcpt = glegrcpts
                totallegchks = glegchks
                totalbankcharge = gbankcharge
                actfundbalance = beginbalance + totalrevenue + totalinterest + totalrevadjust - totalexpenditures + totalexpadjust + totalnsf - totalbankcharge

                Try
                    If ginterest <> totalinterest Then Throw New ArgumentException("Total interest not matching detail records.")
                    If gbankcharge <> totalbankcharge Then Throw New ArgumentException("Total bank charge not matching detail records.")
                    If grevadjust <> totalrevadjust Then Throw New ArgumentException("Total revenues adjustments not matching detail records.")
                    If grevenue <> totalrevenue Then Throw New ArgumentException("Total revenue not matching detail records.")
                    If gnsf <> totalnsf Then Throw New ArgumentException("Total nsf charges not matching detail records.")
                    If gexpenditure <> totalexpenditures Then Throw New ArgumentException("Total expenditures not matching detail records.")
                    If glegrcpts <> totallegrcpt Then Throw New ArgumentException("Total legacy receipts not matching detail records.")
                    If glegchks <> totallegchks Then Throw New ArgumentException("Total legacy checks not matching detail records.")
                Catch ex As Exception
                    Throw
                End Try




                'print the totals on new page;
                .NewPage()
                y = 50

                'print the total text
                .RenderDirectLine(10, y - 1, 180, y - 1, Color.Gray, 0.5)
                .RenderDirectText(10, y, "Total items:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 5, "Selected Checks:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 10, "Selected Expend Adjust:", 60, 10, verdanaright8)
                '.RenderDirectText(10, y + 15, "Selected Interest:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 15, "Selected Bank Charges:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 20, "Checks Not In Range:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 25, "Sub Total:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 35, "Begining Balance:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 40, "Total Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 45, "Total Legacy Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 50, "Total Revenue Adjust:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 55, "Total Interest:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 60, "Total Legacy Checks:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 65, "Total Expenditures:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 70, "Total Bank Charges:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 75, "Total Not-Sufficient-Funds:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 80, "Expenditures Adjustments:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 85, "ACT FUND BANK BALANCE:", 60, 10, verdanaright8bold)

                'print the total amounts
                .RenderDirectText(90, y, reccount.ToString.Format("{0:D1}", reccount), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 5, selexpend.ToString.Format("{0:C2}", selexpend), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 10, selexpadj.ToString.Format("{0:C2}", selexpadj), 35, 5, verdanaright8)
                '.RenderDirectText(90, y + 15, selinterest.ToString.Format("{0:C2}", selinterest), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 15, selbankchg.ToString.Format("{0:C2}", selbankchg), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 20, notselectedexp.ToString.Format("{0:C2}", notselectedexp), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 25, selsum.ToString.Format("{0:C2}", selsum), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 35, beginbalance.ToString.Format("{0:C2}", beginbalance), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 40, totalrevenue.ToString.Format("{0:C2}", totalrevenue), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 45, glegrcpts.ToString.Format("{0:C2}", glegrcpts), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 50, totalrevadjust.ToString.Format("{0:C2}", totalrevadjust), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 55, totalinterest.ToString.Format("{0:C2}", totalinterest), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 60, totallegchks.ToString.Format("{0:C2}", totallegchks), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 65, totalexpenditures.ToString.Format("{0:C2}", totalexpenditures), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 70, totalbankcharge.ToString.Format("{0:C2}", totalbankcharge), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 75, totalnsf.ToString.Format("{0:C2}", totalnsf), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 80, totalexpadjust.ToString.Format("{0:C2}", totalexpadjust), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 85, actfundbalance.ToString.Format("{0:C2}", actfundbalance), 35, 5, verdanaright8bold)

                '.RenderDirectText(0, y, "TOTAL ITEMS IN ERROR:", 60, 10, verdanaright8bold)
                '.RenderDirectText(70, y, reccount.ToString, 25, 5, verdanaright8bold)
                'print line below the column headers
                .RenderDirectLine(10, y + 85, 180, y + 85, Color.Gray, 0.5)
            End With
        Catch ex As Exception
            Throw
        Finally

        End Try

        Try
            Application.DoEvents()
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintClassificationExpendSpecific()
        Me.DocumentName = "Classification"
        Me.ReportName = "Activity Fund Classification Listing"

        'define styles
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles
        DefineStyles()
        'define the document
        DefineDocumentSettings(Me.DocumentName)

        Dim classcode, formatcode, nextcode As String
        Dim docnumber, doctype, descr As String
        Dim amount, balance, codebalance As Double
        Dim issued As Date
        Dim lastrecord As Boolean
        Dim totalreceipt, totalinterest, totalrevadjust, totalnsf, totalrevenue, totalexpadjust, totalexpenditures, totallegrcpt, totallegchks, totalbankcharge, beginbalance As Double
        Dim notselectedexp, selectedrcpt, actfundbalance, selrevadj, selexpadj, selinterest, selnsf, selbankchg, selsum, selexpend As Double
        Dim x, y, index, reccount As Int32

        Try
            With Me.Doc1
                .StartDoc()
                For index = 0 To Me.GridDetail.Rows.Count - 1
                    '''''''''''''''''''''''''''' GridDetail ''''''''''''''''''''''''''''''
                    '     0          1         2         3        4       5       6  
                    '   amount    number     class     descr    issued   key   doctype
                    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                    With Me.GridDetail
                        docnumber = DirectCast(.GetData(index, 2), String)
                        amount = CDbl(.GetData(index, 3))
                        classcode = DirectCast(.GetData(index, 4), String)
                        descr = DirectCast(.GetData(index, 5), String)
                        issued = CDate(.GetData(index, 7))
                        doctype = DirectCast(.GetData(index, 8), String)
                        balance += amount
                        codebalance += amount
                        formatcode = Module1.FormatExpenditureCode(classcode)
                        '''''amount = 256653.36
                        '''''balance = 25566932.39
                        '''''descr = "a b c d e f g h i j k l m n o p q r s t u v w x y z"
                        '''''formatcode = "7-60-000-1225-252-002-2142-252-050"
                        If index = .Rows.Count - 1 Then lastrecord = True
                        If index < .Rows.Count - 1 Then nextcode = DirectCast(.GetData(index + 1, 4), String)
                    End With

                    If index = 0 Then
                        'print the column headers
                        y = 35
                        .RenderDirectText(2, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(62, y, "Payee", 20, 5, verdanaleft8bold)
                        .RenderDirectText(102, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(122, y, "Issued", 20, 5, verdanaright8bold)
                        .RenderDirectText(140, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(163, y, "Tally", 25, 5, verdanaright8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If

                    .RenderDirectText(0, y, formatcode, 65, 5, verdanaleft8)
                    .RenderDirectText(62, y, descr, 45, 10, verdanaleft8)
                    .RenderDirectText(103, y, docnumber, 20, 5, verdanaright8)
                    .RenderDirectText(125, y, issued.ToString.Format("{0:MM/dd/yyyy}", issued), 20, 5, verdanaright8)
                    .RenderDirectText(140, y, amount.ToString.Format("{0:F2}", amount), 25, 5, verdanaright8)
                    .RenderDirectText(165, y, balance.ToString.Format("{0:F2}", balance), 25, 5, verdanaright8)
                    y += 7

                    'print a subtotal line if the code has changed or last record is true;
                    If (classcode.Compare(classcode, nextcode, False) <> 0) Or (lastrecord) Then
                        .RenderDirectText(0, y, "Subtotal:", 60, 5, verdanaright8bold)
                        .RenderDirectText(130, y, codebalance.ToString.Format("{0:F2}", codebalance), 35, 5, verdanaright8bold)
                        '.RenderDirectText(165, y, "***", 20, 5, verdanaleft8bold)
                        codebalance = 0
                        y += 9
                    End If

                    reccount += 1
                    Select Case doctype
                        Case "E"
                            selexpend += amount
                        Case "A"
                            selexpadj += amount
                        Case "B"
                            selbankchg += amount
                        Case "K"
                            totallegchks += amount
                        Case Else
                            doctype = "Undefined"
                    End Select

                    selsum = selexpend + selexpadj + selbankchg

                    'check for page break
                    If y >= 240 Then

                        .NewPage()
                        'print the column headers
                        y = 35
                        .RenderDirectText(2, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(62, y, "Payee", 20, 5, verdanaleft8bold)
                        .RenderDirectText(102, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(122, y, "Issued", 20, 5, verdanaright8bold)
                        .RenderDirectText(140, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(163, y, "Tally", 25, 5, verdanaright8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 44
                    End If


SkipRecord:
                    'expose the current record & count to the caller
                    'EventRecordProcessed((reccurrent), reccount)
                Next
                'collect the totals from the totalgrid to use as a match;
                Dim gbankcharge, gexpadjust, grevadjust, ginterest, glegchks, glegrcpts, gnsf, gexpenditure, grevenue, gbegbalance As Double
                With Me.GridTotals
                    ginterest = CDbl(.GetData(0, 0))
                    gbankcharge = CDbl(.GetData(0, 1))
                    grevadjust = CDbl(.GetData(0, 2))
                    gnsf = CDbl(.GetData(0, 3))
                    gexpadjust = CDbl(.GetData(0, 4))
                    glegrcpts = CDbl(.GetData(0, 5))
                    glegchks = CDbl(.GetData(0, 6))
                    grevenue = CDbl(.GetData(0, 7))
                    gexpenditure = CDbl(.GetData(0, 8))
                    gbegbalance = CDbl(.GetData(0, 9))
                End With

                beginbalance = gbegbalance
                notselectedexp = gexpenditure - selexpend
                totalrevenue = grevenue
                totalinterest = ginterest
                totalrevadjust = grevadjust
                totalnsf = gnsf
                totalexpadjust = gexpadjust
                totalexpenditures = gexpenditure
                totallegrcpt = glegrcpts
                totallegchks = glegchks
                totalbankcharge = gbankcharge
                actfundbalance = beginbalance + totalrevenue + totalinterest + totalrevadjust - totalexpenditures + totalexpadjust + totalnsf - totalbankcharge

                'print the totals on new page;
                .NewPage()
                y = 50

                'print the total text
                .RenderDirectLine(10, y - 1, 180, y - 1, Color.Gray, 0.5)
                .RenderDirectText(10, y, "Total items:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 5, "Selected Checks:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 10, "Selected Expend Adjust:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 15, "Selected Bank Charges:", 60, 10, verdanaright8)
                '.RenderDirectText(10, y + 20, "Selected Nsf:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 20, "Checks Not In Range:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 25, "Sub Total:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 35, "Beginning Balance:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 40, "Total Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 45, "Total Legacy Receipts:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 50, "Total Revenue Adjust:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 55, "Total Interest:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 60, "Total Legacy Checks:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 65, "Total Expenditures:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 70, "Total Bank Charges:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 75, "Total Not-Sufficient-Funds:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 80, "Expenditures Adjustments:", 60, 10, verdanaright8)
                .RenderDirectText(10, y + 85, "ACT FUND BANK BALANCE:", 60, 10, verdanaright8bold)


                'print the total amounts
                .RenderDirectText(90, y, reccount.ToString.Format("{0:D1}", reccount), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 5, selexpend.ToString.Format("{0:C2}", selexpend), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 10, selexpadj.ToString.Format("{0:C2}", selexpadj), 35, 5, verdanaright8)
                '.RenderDirectText(90, y + 15, selinterest.ToString.Format("{0:C2}", selinterest), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 15, selbankchg.ToString.Format("{0:C2}", selbankchg), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 20, notselectedexp.ToString.Format("{0:C2}", notselectedexp), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 25, selsum.ToString.Format("{0:C2}", selsum), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 35, beginbalance.ToString.Format("{0:C2}", beginbalance), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 40, totalrevenue.ToString.Format("{0:C2}", totalrevenue), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 45, glegrcpts.ToString.Format("{0:C2}", glegrcpts), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 50, totalrevadjust.ToString.Format("{0:C2}", totalrevadjust), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 55, totalinterest.ToString.Format("{0:C2}", totalinterest), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 60, totallegchks.ToString.Format("{0:C2}", totallegchks), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 65, totalexpenditures.ToString.Format("{0:C2}", totalexpenditures), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 70, totalbankcharge.ToString.Format("{0:C2}", totalbankcharge), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 75, totalnsf.ToString.Format("{0:C2}", totalnsf), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 80, totalexpadjust.ToString.Format("{0:C2}", totalexpadjust), 35, 5, verdanaright8)
                .RenderDirectText(90, y + 85, actfundbalance.ToString.Format("{0:C2}", actfundbalance), 35, 5, verdanaright8bold)

                '.RenderDirectText(0, y, "TOTAL ITEMS IN ERROR:", 60, 10, verdanaright8bold)
                '.RenderDirectText(70, y, reccount.ToString, 25, 5, verdanaright8bold)
                'print line below the column headers
                .RenderDirectLine(10, y + 85, 180, y + 85, Color.Gray, 0.5)
            End With
        Catch ex As Exception
            Throw
        Finally

        End Try

        Try
            Application.DoEvents()
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintDetailRevenueListing()
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        '     0           1         2        3        4        5   
        '   bank       fisyr    docnumber   amt    count   revenuecode
        '     6           7         8        9      
        '   descr     remarks   created    ttype 
        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        Me.DocumentName = "BoldCodeRevenue"
        Me.ReportName = "Activity Fund OCAS Listing"
        Me.CellRightMiddle = "Revenue Classification"
        'define styles
        arialleft8 = New C1DocStyle(Me.Doc1)
        arialright8 = New C1DocStyle(Me.Doc1)
        arialleft10 = New C1DocStyle(Me.Doc1)
        arialleft10bold = New C1DocStyle(Me.Doc1)
        arialright10 = New C1DocStyle(Me.Doc1)
        footerstyle = New C1DocStyle(Me.Doc1)
        timesleft16 = New C1DocStyle(Me.Doc1)
        verdanaleft8 = New C1DocStyle(Me.Doc1)
        verdanaleft8bold = New C1DocStyle(Me.Doc1)
        verdanaright8 = New C1DocStyle(Me.Doc1)
        verdanaright8bold = New C1DocStyle(Me.Doc1)
        verdanaleft10 = New C1DocStyle(Me.Doc1)
        verdanaleft10bold = New C1DocStyle(Me.Doc1)
        verdanaright10 = New C1DocStyle(Me.Doc1)
        verdanaright10bold = New C1DocStyle(Me.Doc1)
        'define the styles
        DefineStyles()
        'define the document
        DefineDocumentSettings(Me.DocumentName)

        Dim tcode As String
        Dim tdocnumber, tdoctype, tdescr, tremarks As String
        Dim tamt, tsumamt, tbalance As Double
        Dim totalreceipt, totalinterest, totaladjust, totalnsf, totalrevenue As Double
        Dim x, y, index, reccount, currec As Int32
        Dim tdate As Date

        Try
            With Me.Doc1
                .StartDoc()
                For index = 0 To Me.GridDetail.Rows.Count - 1
                    With Me.GridDetail
                        tdocnumber = DirectCast(.GetData(index, 2), String)
                        tamt = CDbl(.GetData(index, 3))
                        tcode = DirectCast(.GetData(index, 5), String)
                        tdescr = DirectCast(.GetData(index, 6), String)
                        tdate = CDate(.GetData(index, 8))
                        tdoctype = DirectCast(.GetData(index, 9), String).ToUpper
                        tbalance += tamt
                        'iterate the linecounter
                        currec += 1

                        '''''''''''''''''''''''''''''''''''''''''''''''''''
                        '''''''''''''''''''''''''''''''''''''''''''''''''''
                        'diag code'''''''''''''''''''''''''''''''''''''''''
                        '''''tcode = "66080011115002223333444050"
                        '''''tcode = Module1.FormatExpenditureCode(tcode)
                        tcode = Module1.FormatRevenueCode(tcode)
                        '''''tamt = 256653.36
                        '''''tbalance = 25566932.39
                        '''''tdescr = "a b c d e f g h i j k l m n o p q r s t u v w x y z"
                        '''''''''''''''''''''''''''''''''''''''''''''''''''
                        '''''''''''''''''''''''''''''''''''''''''''''''''''

                        Select Case tdoctype
                            Case "I"
                                totalinterest += tamt
                            Case "N"
                                totalnsf += tamt
                            Case "R"
                                totaladjust += tamt
                            Case "T"
                                totalreceipt += tamt
                            Case Else
                                tdoctype = "Undefined"
                        End Select
                    End With
                    If currec = 1 Then
                        'print the column headers
                        y = 35
                        .RenderDirectText(5, y, "Classification", 70, 5, verdanaleft8bold)
                        .RenderDirectText(65, y, "Payee", 40, 5, verdanaleft8bold)
                        .RenderDirectText(104, y, "Number", 20, 5, verdanaright8bold)
                        .RenderDirectText(123, y, "Issued", 20, 5, verdanaright8bold)
                        .RenderDirectText(138, y, "Amount", 25, 5, verdanaright8bold)
                        .RenderDirectText(163, y, "Tally", 25, 5, verdanaright8bold)
                        'print line below the column headers
                        .RenderDirectLine(0, y + 5, 190, y + 5, Color.Gray, 0.5)
                        y = 42
                    End If
                    .RenderDirectText(0, y, tcode, 70, 5, verdanaleft8)
                    .RenderDirectText(65, y, tdescr, 40, 10, verdanaleft8)
                    .RenderDirectText(105, y, tdocnumber, 20, 5, verdanaright8)
                    .RenderDirectText(125, y, tdate.ToShortDateString, 20, 5, verdanaright8)
                    .RenderDirectText(140, y, tamt.ToString.Format("{0:F2}", tamt), 25, 5, verdanaright8)
                    .RenderDirectText(165, y, tbalance.ToString.Format("{0:F2}", tbalance), 25, 5, verdanaright8)
                    y += 7
                    'check for page break
                    If y >= 255 Then
                        If index >= (Me.GridDetail.Rows.Count - 1) Then Exit For
                        .NewPage()
                        y = 35
                        'reinitialise the linecounter
                        currec = 0
                    End If
                    reccount += 1
                    tsumamt += tamt
SkipRecord:
                    'expose the current record & count to the caller
                    'EventRecordProcessed((reccurrent), reccount)
                Next

                'print the totals
                If y = 0 Then y = 50
                If y >= 220 Then
                    .NewPage()
                    y = 50
                End If
                y += 5
                totalrevenue = totalreceipt + totaladjust + totalnsf + totalinterest
                'print the total text
                .RenderDirectLine(10, y - 1, 180, y - 1, Color.Gray, 0.5)
                .RenderDirectText(10, y, "Selected Receipts:", 60, 10, verdanaright8bold)
                .RenderDirectText(10, y + 5, "Selected Revenue Adjustments:", 60, 10, verdanaright8bold)
                .RenderDirectText(10, y + 10, "Selected Interest:", 60, 10, verdanaright8bold)
                .RenderDirectText(10, y + 15, "Selected Not-Sufficient-Funds:", 60, 10, verdanaright8bold)
                .RenderDirectText(10, y + 20, "Revenue Not In Range:", 60, 10, verdanaright8bold)
                .RenderDirectText(10, y + 25, "Total Revenues:", 60, 10, verdanaright8bold)
                'print the total amounts
                .RenderDirectText(90, y, totalreceipt.ToString.Format("{0:C2}", totalreceipt), 35, 5, verdanaright8bold)
                .RenderDirectText(90, y + 5, totaladjust.ToString.Format("{0:C2}", totaladjust), 35, 5, verdanaright8bold)
                .RenderDirectText(90, y + 10, totalinterest.ToString.Format("{0:C2}", totalinterest), 35, 5, verdanaright8bold)
                .RenderDirectText(90, y + 15, totalnsf.ToString.Format("{0:C2}", totalnsf), 35, 5, verdanaright8bold)
                .RenderDirectText(90, y + 20, 0.ToString.Format("{0:C2}", 0), 35, 5, verdanaright8bold)
                .RenderDirectText(90, y + 25, totalrevenue.ToString.Format("{0:C2}", totalrevenue), 35, 5, verdanaright8bold)
                '.RenderDirectText(0, y, "TOTAL ITEMS IN ERROR:", 60, 10, verdanaright8bold)
                '.RenderDirectText(70, y, reccount.ToString, 25, 5, verdanaright8bold)
                'print line below the column headers
                .RenderDirectLine(10, y + 30, 180, y + 30, Color.Gray, 0.5)
            End With
        Catch ex As Exception
            Throw
        Finally

        End Try

        Try
            Application.DoEvents()
            'set the preview zoom
            Me.Prev1.PreviewPane.ZoomMode = C1.Win.C1PrintPreview.ZoomModeEnum.ActualSize
            'finish the document
            Me.Doc1.EndDoc()
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub PrintFooter()
        Try
            'print footer (portrait)
            With Me.Doc1
                .RenderDirectLine(0, 264, 191.5, 264, Color.Black, 0.5)
                .RenderDirectText(0, 265, "Page [@@PageNo@@] of [@@PageCount@@]", 150, 4, footerstyle)
                .RenderDirectText(68, 265, "Activity Fund.Net  - A product of ADPC", 75, 4, footerstyle)
                '.RenderDirectText(167, 265, "1(800)747-2372", 80, 4, footerstyle)
                'changed by fred 2008.04.10;
                .RenderDirectText(152, 265, Now.ToString.Format("{0:MM/dd/yyyy HH:mm:ss tt}", Now), 80, 4, footerstyle)
            End With
        Catch ex As Exception

        End Try
    End Sub

    Private Sub PrintHeader()
        Try
            With Me.Doc1
                'print the top margin line 
                .RenderDirectLine(0, 14, 190, 14, Color.Black, 0.5)
                'print the left side of the header
                .RenderDirectText(2, 15, Me.SchoolName, 80, 5, arialleft10)
                .RenderDirectText(2, 20, Me.SchoolAddress1, 80, 5, arialleft10)
                .RenderDirectText(2, 25, Me.SchoolCityStateZip, 80, 5, arialleft10)
                'print the center of the header
                verdanaleft8.TextAlignHorz = AlignHorzEnum.Center
                .RenderDirectText(70, 15, Me.CellMiddleTop, 80, 5, verdanaleft8)
                .RenderDirectText(70, 20, Me.CellMiddleMiddle, 60, 5, verdanaleft8)
                .RenderDirectText(70, 25, Me.CellMiddleBottom, 50, 5, verdanaleft8)
                verdanaleft8.TextAlignHorz = AlignHorzEnum.Left
                'print the right side of the header
                .RenderDirectText(100, 15, Me.ReportName, 90, 5, verdanaright10bold)
                .RenderDirectText(100, 20, Me.CellRightMiddle, 90, 5, verdanaright8)
                .RenderDirectText(150, 25, Now.ToString.Format("{0:MMMM dd, yyyy}", Now), 40, 5, verdanaright8)
                'print the bottom header line
                .RenderDirectLine(0, 31, 190, 31, Color.Gray, 0.5)
            End With
        Catch ex As Exception
            Throw
        End Try

        Try
            PrintFooter()
        Catch ex As Exception

        End Try

    End Sub

#End Region

#Region "  Methods Retrieval "

    Private Sub GetBalanceForwardSumAndCount()
        'this routine retrieves the sum of the beginning year balances
        'from all accounts; this amount will be given a code and added
        'to the detail grid with the other bold codes during the generation
        'of the bold code information;  this amount is NOT retrieved from
        'any detail record;
        Dim SSQL As String
        If Me.FiscalYear = Me.FiscalYearSelected Then
            SSQL = "SELECT SUM(as_beg_year_balance), COUNT(*) FROM acct_sub"
        Else
            'this statement below is the one it's bombing on
            '& " And ahst_current_month = 5;"
            SSQL = "SELECT SUM(ahst_beg_year_balance), COUNT(*) FROM acct_history where ahst_fisyr = @p1 " _
             & " And ahst_current_month = (select min(ahst_current_month) from acct_history" _
             & " where ahst_fisyr = @p1);"
        End If
        cn = New SqlConnection(Me.ConnectionString)
        Dim cmd As New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
        Dim da As New SqlDataAdapter(cmd)
        Dim tbl As New DataTable("Dim4")
        Try
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Balance forward summary invalid or missing...")
        Catch ex As Exception
            Throw
        Finally
            da.Dispose()
            cmd.Dispose()
        End Try

        Try
            Me.BalanceForwardAmount = CDbl(tbl.Rows(0).Item(0))
            Me.BalanceForwardCount = CInt(tbl.Rows(0).Item(1))
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub GetDistrictInformation()
        Dim SSQL As String
        SSQL = "SELECT schi_district_id, schi_county_id FROM school_info"
        cn = New SqlConnection(Me.ConnectionString)
        Dim cmd1 As New SqlCommand(SSQL, cn)
        Dim da As New SqlDataAdapter(cmd1)
        Dim tbl As New DataTable("District")
        Try
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("School information invalid or missing...")
            If tbl.Rows.Count <> 1 Then Throw New ArgumentException("School information invalid or corrupt...")
        Catch ex As Exception
            Throw
        Finally
            da.Dispose()
            cmd1.Dispose()
        End Try

        Try
            Me.DistrictId = DirectCast(tbl.Rows(0).Item(0), String)
            Me.CountyId = DirectCast(tbl.Rows(0).Item(1), String)
            '''''Me.lblDistrictId.Text = Me.DistrictId
            '''''Me.lblCountyId.Text = Me.CountyId
        Catch ex As Exception
            Throw
        End Try
    End Sub

    Private Sub GetExpenditureDims()
        Dim SSQL As String
        Dim cmd As SqlCommand
        Dim da As SqlDataAdapter
        Dim tbl As DataTable

        Try
            SSQL = "SELECT dimx3_value, dimx3_type, dimx3_valid FROM dimx3" _
            & " WHERE ((dimx3_type = 'B') OR (dimx3_type = 'D'))" _
            & " AND dimx3_fisyr = @p1" _
            & " ORDER BY CAST(dimx3_value AS INT)"
            cn = New SqlConnection(Me.ConnectionString)
            cmd = New SqlCommand(SSQL, cn)
            cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
            da = New SqlDataAdapter(cmd)
            tbl = New DataTable("Dim3")
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 3 invalid or missing...")
            Me.GridDim3.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            da.Dispose()
            cmd.Dispose()
        End Try

        Try
            SSQL = "SELECT dimx4_value, dimx4_type, dimx4_valid FROM dimx4" _
            & " WHERE ((dimx4_type = 'B') OR (dimx4_type = 'D'))" _
            & " AND dimx4_fisyr = @p1" _
            & " ORDER BY CAST(dimx4_value AS INT)"
            cn = New SqlConnection(Me.ConnectionString)
            cmd = New SqlCommand(SSQL, cn)
            cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
            da = New SqlDataAdapter(cmd)
            tbl = New DataTable("Dim4")
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 4 invalid or missing...")
            Me.GridDim4.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            da.Dispose()
            cmd.Dispose()
        End Try

        Try
            SSQL = "SELECT dimx5_value, dimx5_type, dimx5_valid FROM dimx5" _
            & " WHERE ((dimx5_type = 'B') OR (dimx5_type = 'D'))" _
            & " AND dimx5_fisyr = @p1" _
            & " ORDER BY CAST(dimx5_value AS INT)"
            cmd = New SqlCommand(SSQL, cn)
            cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
            da = New SqlDataAdapter(cmd)
            tbl = New DataTable("Dim5")
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 5 invalid or missing...")
            Me.GridDim5.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Try
            SSQL = "SELECT dimx6_value, dimx6_type, dimx6_valid FROM dimx6" _
            & " WHERE ((dimx6_type = 'B') OR (dimx6_type = 'D'))" _
            & " AND dimx6_fisyr = @p1" _
            & " ORDER BY CAST(dimx6_value AS INT)"
            cmd = New SqlCommand(SSQL, cn)
            cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
            da = New SqlDataAdapter(cmd)
            tbl = New DataTable("Dim6")
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 6 invalid or missing...")
            Me.GridDim6.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Try
            SSQL = "SELECT dimx7_value, dimx7_type, dimx7_valid FROM dimx7" _
            & " WHERE ((dimx7_type = 'B') OR (dimx7_type = 'D'))" _
            & " AND dimx7_fisyr = @p1" _
            & " ORDER BY CAST(dimx7_value AS INT)"
            cmd = New SqlCommand(SSQL, cn)
            cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
            da = New SqlDataAdapter(cmd)
            tbl = New DataTable("Dim7")
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 7 invalid or missing...")
            Me.GridDim7.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Try
            SSQL = "SELECT dimx8_value, dimx8_type, dimx8_valid FROM dimx8" _
            & " WHERE ((dimx8_type = 'B') OR (dimx8_type = 'D'))" _
            & " AND dimx8_fisyr = @p1" _
            & " ORDER BY CAST(dimx8_value AS INT)"
            cmd = New SqlCommand(SSQL, cn)
            cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
            da = New SqlDataAdapter(cmd)
            tbl = New DataTable("Dim8")
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 8 invalid or missing...")
            Me.GridDim8.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

        Try
            'the opunit or site code(dim9) added due to state edit checks 
            'starting fiscal yr 2009-2010    05-12-2010
            SSQL = "SELECT dimx9_value, dimx9_type, dimx9_valid FROM dimx9" _
            + " WHERE ((dimx9_type = 'B') OR (dimx9_type = 'D'))" _
            + " AND dimx9_fisyr = @p1" _
            + " ORDER BY CAST(dimx9_value AS INT)"
            cmd = New SqlCommand(SSQL, cn)
            cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
            da = New SqlDataAdapter(cmd)
            tbl = New DataTable("Dim9")
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 9 invalid or missing...")
            Me.griddim9.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            cn.Close()
            da.Dispose()
            cmd.Dispose()
        End Try

    End Sub

    Private Sub GetRevenueDims()
        Dim SSQL As String
        Dim cmd As SqlCommand
        Dim da As SqlDataAdapter
        Dim tbl As DataTable

        SSQL = "SELECT dimr3_value, dimr3_type, dimr3_valid FROM dimr3" _
        & " WHERE ((dimr3_type = 'B') OR (dimr3_type = 'D'))" _
        & " AND dimr3_fisyr = @p1" _
        & " ORDER BY CAST(dimr3_value AS INT)"
        cn = New SqlConnection(Me.ConnectionString)
        cmd = New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
        da = New SqlDataAdapter(cmd)
        tbl = New DataTable("Dim3")
        Try
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 3 invalid or missing...")
            Me.GridDim3.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            da.Dispose()
            cmd.Dispose()
        End Try

        SSQL = "SELECT dimr4_value, dimr4_type, dimr4_valid FROM dimr4" _
        & " WHERE ((dimr4_type = 'B') OR (dimr4_type = 'D'))" _
        & " AND dimr4_fisyr = @p1" _
        & " ORDER BY CAST(dimr4_value AS INT)"
        cn = New SqlConnection(Me.ConnectionString)
        cmd = New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
        da = New SqlDataAdapter(cmd)
        tbl = New DataTable("Dim4")
        Try
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 4 invalid or missing...")
            Me.GridDim4.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            da.Dispose()
            cmd.Dispose()
        End Try

        SSQL = "SELECT dimr5_value, dimr5_type, dimr5_valid FROM dimr5" _
        & " WHERE ((dimr5_type = 'B') OR (dimr5_type = 'D'))" _
        & " AND dimr5_fisyr = @p1" _
        & " ORDER BY CAST(dimr5_value AS INT)"
        cn = New SqlConnection(Me.ConnectionString)
        cmd = New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
        da = New SqlDataAdapter(cmd)
        tbl = New DataTable("Dim5")
        Try
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 5 invalid or missing...")
            Me.GridDim5.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            da.Dispose()
            cmd.Dispose()
        End Try

        SSQL = "SELECT dimr6_value, dimr6_type, dimr6_valid FROM dimr6" _
       & " WHERE ((dimr6_type = 'B') OR (dimr6_type = 'D'))" _
       & " AND dimr6_fisyr = @p1" _
       & " ORDER BY CAST(dimr6_value AS INT)"
        cn = New SqlConnection(Me.ConnectionString)
        cmd = New SqlCommand(SSQL, cn)
        cmd.Parameters.Add("@p1", Me.FiscalYearSelected)
        da = New SqlDataAdapter(cmd)
        tbl = New DataTable("Dim6")
        Try
            da.Fill(tbl)
            If tbl Is Nothing Then Throw New ArgumentException("Dimension table 6 invalid or missing...")
            Me.GridDim6.DataSource = tbl
        Catch ex As Exception
            Throw
        Finally
            da.Dispose()
            cmd.Dispose()
        End Try
    End Sub

#End Region

#Region "  Properties "

    Private Property BalanceForwardAmount() As Double
        Get
            Return _balanceforwardamount
        End Get
        Set(ByVal Value As Double)
            _balanceforwardamount = Value
        End Set
    End Property

    Private Property BalanceForwardCount() As Int32
        Get
            Return _balanceforwardcount
        End Get
        Set(ByVal Value As Int32)
            _balanceforwardcount = Value
        End Set
    End Property

    Private ReadOnly Property BalanceForwardCode() As String
        Get
            'this code does not include fiscal year
            Dim mysite As String = Me.DistrictId.Substring(0, 1)

            If mysite = "C" Then
                Return Me.FiscalYearSelected.ToString.Substring(3, 1) + "608006110900105"
            Else
                Return Me.FiscalYearSelected.ToString.Substring(3, 1) + "608006110900050"
            End If
        End Get
    End Property

    Private Property BankAccountNumber() As String
        Get
            Return _bankaccountnumber
        End Get
        Set(ByVal Value As String)
            Dim index, length As Int32
            Dim s1, s2 As String
            Dim t1, t2 As Int32
            'mask all but the last 4 characters of the bankaccount number;
            t1 = Value.Trim.Length
            If t1 > 4 Then
                t2 = t1 - 4
                For index = 1 To t2
                    s1 &= "* "
                Next
                s2 = s1 & Value.Substring(t1 - 4, 4)
            Else
                s2 = Value
            End If
            _bankaccountnumber = s2
        End Set
    End Property

    Private Property BoldCodeFilePath() As String
        Get
            Return _boldcodefilepath
        End Get
        Set(ByVal Value As String)
            _boldcodefilepath = Value.Trim
        End Set
    End Property

    Private Property ConnectionString() As String
        Get
            Return _connectionstring
        End Get
        Set(ByVal Value As String)
            _connectionstring = Value.Trim
        End Set
    End Property

    Private Property CountyId() As String
        Get
            Return _countyid
        End Get
        Set(ByVal Value As String)
            If Value.Trim.Length <> 2 Then Throw New ArgumentException("County Id invalid or missing...")
            _countyid = Value.Trim
        End Set
    End Property

    Private Property DistrictId() As String
        Get
            Return _districtid
        End Get
        Set(ByVal Value As String)
            If Value.Trim.Length <> 4 Then Throw New ArgumentException("District Id invalid or missing...")
            _districtid = Value.Trim
        End Set
    End Property

    Private Property DocumentName() As String
        Get
            Return _documentname
        End Get
        Set(ByVal Value As String)
            _documentname = Value.Trim
        End Set
    End Property

    Private Property FiscalYear() As Int32
        Get
            Return _fiscalyear
        End Get
        Set(ByVal Value As Int32)
            _fiscalyear = Value
        End Set
    End Property

    Private Property FiscalYearSelected() As Int32
        Get
            Return _fiscalyearselected
        End Get
        Set(ByVal Value As Int32)
            _fiscalyearselected = Value
        End Set
    End Property

    Private Property HasErrors() As Boolean
        Get
            Return _haserrors
        End Get
        Set(ByVal Value As Boolean)
            _haserrors = Value
        End Set
    End Property

    Private Property ReportName() As String
        Get
            Return _reportname
        End Get
        Set(ByVal Value As String)
            _reportname = Value.Trim
        End Set
    End Property

    Private Property SchoolName() As String
        Get
            Return _schoolname
        End Get
        Set(ByVal Value As String)
            _schoolname = Value.Trim
        End Set
    End Property

    Private Property SchoolNumber() As String
        Get
            Return _schoolnumber
        End Get
        Set(ByVal Value As String)
            _schoolnumber = Value.Trim
        End Set
    End Property

    Private Property SchoolAddress1() As String
        Get
            Return _schooladdress1

        End Get
        Set(ByVal Value As String)
            _schooladdress1 = Value.Trim
        End Set
    End Property

    Private Property SchoolAddress2() As String
        Get
            Return _schooladdress2
        End Get
        Set(ByVal Value As String)
            _schooladdress2 = Value.Trim
        End Set
    End Property

    Private Property SchoolCityStateZip() As String
        Get
            Return _schoolcitystatezip
        End Get
        Set(ByVal Value As String)
            _schoolcitystatezip = Value.Trim
        End Set
    End Property

#End Region



End Class
